2025-05-25 12:28:31.579 INFO  c.e.iam.integration.AuthAndRoleTest - Starting AuthAndRoleTest using Java 21.0.7 with PID 20480 (started by descent in /home/descent/Documents/VDT/vdt5-iam-system/iam-service)
2025-05-25 12:28:31.581 DEBUG c.e.iam.integration.AuthAndRoleTest - Running with Spring Boot v3.4.5, Spring v6.2.6
2025-05-25 12:28:31.583 INFO  c.e.iam.integration.AuthAndRoleTest - The following 1 profile is active: "test"
2025-05-25 12:28:32.766 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-05-25 12:28:32.871 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 94 ms. Found 9 JPA repository interfaces.
2025-05-25 12:28:33.851 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 0 (http)
2025-05-25 12:28:33.868 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-25 12:28:33.868 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.40]
2025-05-25 12:28:33.926 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-25 12:28:33.926 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2319 ms
2025-05-25 12:28:34.544 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-25 12:28:34.740 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:testdb user=SA
2025-05-25 12:28:34.756 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-25 12:28:36.134 DEBUG org.hibernate.SQL - 
    set client_min_messages = WARNING
2025-05-25 12:28:36.139 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       drop constraint if exists FK21l4ab5xsq7rxwb7b2efptbmt
2025-05-25 12:28:36.140 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       drop constraint if exists FK4glu0kw16kw6gu23yr5q6vjme
2025-05-25 12:28:36.141 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       drop constraint if exists FK3smj35weuy4b1fj396l5jvt6g
2025-05-25 12:28:36.141 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       drop constraint if exists FKacyhrlymxo934q9c4n441dhwf
2025-05-25 12:28:36.141 DEBUG org.hibernate.SQL - 
    alter table if exists policies 
       drop constraint if exists FKs49d98df3xexcyui98cwpek9p
2025-05-25 12:28:36.142 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       drop constraint if exists FKegdk29eiy7mdtefy5c7eirr6e
2025-05-25 12:28:36.142 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       drop constraint if exists FKn5fotdgk8d1xvo8nav9uv3muc
2025-05-25 12:28:36.142 DEBUG org.hibernate.SQL - 
    alter table if exists tokens 
       drop constraint if exists FK2dylsfo39lgjyqml2tbe0b0ss
2025-05-25 12:28:36.143 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       drop constraint if exists FKh8ciramu9cc9q3qcqiv4ue8a6
2025-05-25 12:28:36.143 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       drop constraint if exists FKhfh9dx7w3ubf1co1vdev94g3f
2025-05-25 12:28:36.144 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       drop constraint if exists FK4gc7xv8r1p0j6ykgn5h4nx934
2025-05-25 12:28:36.144 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       drop constraint if exists FKspv2c7f3cxhd1242nkabx95s5
2025-05-25 12:28:36.145 DEBUG org.hibernate.SQL - 
    alter table if exists users 
       drop constraint if exists FKqpugllwvyv37klq7ft9m8aqxk
2025-05-25 12:28:36.146 DEBUG org.hibernate.SQL - 
    drop table if exists client_applications cascade
2025-05-25 12:28:36.147 DEBUG org.hibernate.SQL - 
    drop table if exists client_scopes cascade
2025-05-25 12:28:36.147 DEBUG org.hibernate.SQL - 
    drop table if exists organizations cascade
2025-05-25 12:28:36.148 DEBUG org.hibernate.SQL - 
    drop table if exists permission_scopes cascade
2025-05-25 12:28:36.148 DEBUG org.hibernate.SQL - 
    drop table if exists permissions cascade
2025-05-25 12:28:36.149 DEBUG org.hibernate.SQL - 
    drop table if exists policies cascade
2025-05-25 12:28:36.149 DEBUG org.hibernate.SQL - 
    drop table if exists resources cascade
2025-05-25 12:28:36.149 DEBUG org.hibernate.SQL - 
    drop table if exists role_permissions cascade
2025-05-25 12:28:36.149 DEBUG org.hibernate.SQL - 
    drop table if exists roles cascade
2025-05-25 12:28:36.150 DEBUG org.hibernate.SQL - 
    drop table if exists scopes cascade
2025-05-25 12:28:36.150 DEBUG org.hibernate.SQL - 
    drop table if exists tokens cascade
2025-05-25 12:28:36.150 DEBUG org.hibernate.SQL - 
    drop table if exists user_roles cascade
2025-05-25 12:28:36.151 DEBUG org.hibernate.SQL - 
    drop table if exists user_scopes cascade
2025-05-25 12:28:36.151 DEBUG org.hibernate.SQL - 
    drop table if exists users cascade
2025-05-25 12:28:36.156 DEBUG org.hibernate.SQL - 
    create table client_applications (
        is_active boolean,
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        client_id varchar(100) not null unique,
        name varchar(100) not null,
        client_secret varchar(255) not null,
        description TEXT,
        redirect_uri varchar(255),
        primary key (id)
    )
2025-05-25 12:28:36.169 DEBUG org.hibernate.SQL - 
    create table client_scopes (
        client_id bigint not null,
        scope_id bigint not null,
        primary key (client_id, scope_id)
    )
2025-05-25 12:28:36.171 DEBUG org.hibernate.SQL - 
    create table organizations (
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        description varchar(1000),
        name varchar(255) not null unique,
        primary key (id)
    )
2025-05-25 12:28:36.173 DEBUG org.hibernate.SQL - 
    create table permission_scopes (
        permission_id bigint not null,
        scope_id bigint not null,
        primary key (permission_id, scope_id)
    )
2025-05-25 12:28:36.174 DEBUG org.hibernate.SQL - 
    create table permissions (
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        name varchar(100) not null unique,
        description TEXT,
        primary key (id)
    )
2025-05-25 12:28:36.176 DEBUG org.hibernate.SQL - 
    create table policies (
        subject_type smallint not null check (subject_type between 0 and 3),
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        resource_id bigint not null,
        subject_id bigint not null,
        updated_at timestamp(6) not null,
        action varchar(255) not null,
        condition_json TEXT,
        effect varchar(255) not null check (effect in ('ALLOW','DENY')),
        primary key (id)
    )
2025-05-25 12:28:36.184 DEBUG org.hibernate.SQL - 
    create table resources (
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        name varchar(100) not null,
        description TEXT,
        http_method varchar(255) not null check (http_method in ('GET','POST','PUT','DELETE','PATCH','HEAD','OPTIONS')),
        path varchar(255) not null,
        primary key (id)
    )
2025-05-25 12:28:36.187 DEBUG org.hibernate.SQL - 
    create table role_permissions (
        permission_id bigint not null,
        role_id bigint not null,
        primary key (permission_id, role_id)
    )
2025-05-25 12:28:36.189 DEBUG org.hibernate.SQL - 
    create table roles (
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        name varchar(50) not null unique,
        description TEXT,
        primary key (id)
    )
2025-05-25 12:28:36.192 DEBUG org.hibernate.SQL - 
    create table scopes (
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        name varchar(100) not null unique,
        description TEXT,
        primary key (id)
    )
2025-05-25 12:28:36.196 DEBUG org.hibernate.SQL - 
    create table tokens (
        expired boolean not null,
        revoked boolean not null,
        created_at timestamp(6) not null,
        expires_at timestamp(6) not null,
        token_id bigint generated by default as identity,
        user_id bigint,
        client_id varchar(255),
        token TEXT not null,
        token_type varchar(255) not null check (token_type in ('ACCESS','REFRESH')),
        primary key (token_id)
    )
2025-05-25 12:28:36.200 DEBUG org.hibernate.SQL - 
    create table user_roles (
        role_id bigint not null,
        user_id bigint not null,
        primary key (role_id, user_id)
    )
2025-05-25 12:28:36.201 DEBUG org.hibernate.SQL - 
    create table user_scopes (
        scope_id bigint not null,
        user_id bigint not null,
        primary key (scope_id, user_id)
    )
2025-05-25 12:28:36.203 DEBUG org.hibernate.SQL - 
    create table users (
        enabled boolean not null,
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        organization_id bigint,
        updated_at timestamp(6) not null,
        username varchar(50) not null unique,
        password varchar(100) not null,
        email varchar(255) not null unique,
        full_name varchar(255),
        primary key (id)
    )
2025-05-25 12:28:36.206 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       add constraint FK21l4ab5xsq7rxwb7b2efptbmt 
       foreign key (scope_id) 
       references scopes
2025-05-25 12:28:36.218 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       add constraint FK4glu0kw16kw6gu23yr5q6vjme 
       foreign key (client_id) 
       references client_applications
2025-05-25 12:28:36.220 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       add constraint FK3smj35weuy4b1fj396l5jvt6g 
       foreign key (scope_id) 
       references scopes
2025-05-25 12:28:36.221 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       add constraint FKacyhrlymxo934q9c4n441dhwf 
       foreign key (permission_id) 
       references permissions
2025-05-25 12:28:36.223 DEBUG org.hibernate.SQL - 
    alter table if exists policies 
       add constraint FKs49d98df3xexcyui98cwpek9p 
       foreign key (resource_id) 
       references resources
2025-05-25 12:28:36.225 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       add constraint FKegdk29eiy7mdtefy5c7eirr6e 
       foreign key (permission_id) 
       references permissions
2025-05-25 12:28:36.227 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       add constraint FKn5fotdgk8d1xvo8nav9uv3muc 
       foreign key (role_id) 
       references roles
2025-05-25 12:28:36.230 DEBUG org.hibernate.SQL - 
    alter table if exists tokens 
       add constraint FK2dylsfo39lgjyqml2tbe0b0ss 
       foreign key (user_id) 
       references users
2025-05-25 12:28:36.232 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       add constraint FKh8ciramu9cc9q3qcqiv4ue8a6 
       foreign key (role_id) 
       references roles
2025-05-25 12:28:36.234 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       add constraint FKhfh9dx7w3ubf1co1vdev94g3f 
       foreign key (user_id) 
       references users
2025-05-25 12:28:36.236 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       add constraint FK4gc7xv8r1p0j6ykgn5h4nx934 
       foreign key (scope_id) 
       references scopes
2025-05-25 12:28:36.237 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       add constraint FKspv2c7f3cxhd1242nkabx95s5 
       foreign key (user_id) 
       references users
2025-05-25 12:28:36.239 DEBUG org.hibernate.SQL - 
    alter table if exists users 
       add constraint FKqpugllwvyv37klq7ft9m8aqxk 
       foreign key (organization_id) 
       references organizations
2025-05-25 12:28:36.937 DEBUG c.e.i.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-05-25 12:28:37.025 INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name customUserDetailsService
2025-05-25 12:28:37.492 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.name,
        r1_0.updated_at 
    from
        roles r1_0 
    where
        r1_0.name=?
2025-05-25 12:28:37.589 DEBUG org.hibernate.SQL - 
    insert 
    into
        roles
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:28:37.626 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0
2025-05-25 12:28:37.639 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.name,
        p1_0.role_id,
        p1_1.id,
        p1_1.created_at,
        p1_1.description,
        p1_1.name,
        p1_1.updated_at,
        r1_0.updated_at 
    from
        roles r1_0 
    left join
        role_permissions p1_0 
            on r1_0.id=p1_0.role_id 
    left join
        permissions p1_1 
            on p1_1.id=p1_0.permission_id 
    where
        r1_0.id=?
2025-05-25 12:28:37.646 DEBUG org.hibernate.SQL - 
    select
        u1_0.role_id,
        u1_1.id,
        u1_1.created_at,
        u1_1.email,
        u1_1.enabled,
        u1_1.full_name,
        u1_1.organization_id,
        u1_1.password,
        u1_1.updated_at,
        u1_1.username 
    from
        user_roles u1_0 
    join
        users u1_1 
            on u1_1.id=u1_0.user_id 
    where
        u1_0.role_id=?
2025-05-25 12:28:37.654 DEBUG org.hibernate.SQL - 
    update
        roles 
    set
        description=?,
        name=?,
        updated_at=? 
    where
        id=?
2025-05-25 12:28:37.658 INFO  c.e.i.s.AdminInitializationService - Updated admin role with 0 permissions
2025-05-25 12:28:37.662 DEBUG org.hibernate.SQL - 
    select
        u1_0.id,
        u1_0.created_at,
        u1_0.email,
        u1_0.enabled,
        u1_0.full_name,
        u1_0.organization_id,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.username=?
2025-05-25 12:28:37.778 DEBUG org.hibernate.SQL - 
    insert 
    into
        users
        (created_at, email, enabled, full_name, organization_id, password, updated_at, username) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?)
2025-05-25 12:28:37.781 DEBUG org.hibernate.SQL - 
    insert 
    into
        user_roles
        (user_id, role_id) 
    values
        (?, ?)
2025-05-25 12:28:37.782 INFO  c.e.i.s.AdminInitializationService - Created admin user with username: admin
2025-05-25 12:28:37.964 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-05-25 12:28:38.104 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:28:38.107 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:28:38.111 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ORGANIZATION_DELETE
2025-05-25 12:28:38.113 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:28:38.115 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:28:38.117 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ORGANIZATION_READ
2025-05-25 12:28:38.119 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:28:38.120 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:28:38.122 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: POLICY_DELETE
2025-05-25 12:28:38.123 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:28:38.125 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:28:38.129 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: SCOPE_CREATE
2025-05-25 12:28:38.131 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:28:38.133 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:28:38.135 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: RESOURCE_UPDATE
2025-05-25 12:28:38.136 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:28:38.138 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:28:38.140 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: USER_READ
2025-05-25 12:28:38.141 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:28:38.143 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:28:38.145 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: USER_DELETE
2025-05-25 12:28:38.147 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:28:38.149 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:28:38.150 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: POLICY_CREATE
2025-05-25 12:28:38.151 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:28:38.153 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:28:38.154 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: SCOPE_UPDATE
2025-05-25 12:28:38.155 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:28:38.156 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:28:38.158 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ORGANIZATION_CREATE
2025-05-25 12:28:38.160 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:28:38.163 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:28:38.165 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: SCOPE_READ
2025-05-25 12:28:38.166 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:28:38.168 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:28:38.169 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ROLE_UPDATE
2025-05-25 12:28:38.171 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:28:38.172 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:28:38.174 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ROLE_CREATE
2025-05-25 12:28:38.175 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:28:38.177 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:28:38.179 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: POLICY_READ
2025-05-25 12:28:38.181 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:28:38.183 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:28:38.185 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:28:38.187 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:28:38.188 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ROLE_READ
2025-05-25 12:28:38.191 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:28:38.193 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:28:38.195 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: CLIENT_CREATE
2025-05-25 12:28:38.198 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:28:38.201 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:28:38.202 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: RESOURCE_READ
2025-05-25 12:28:38.204 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:28:38.207 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:28:38.209 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:28:38.211 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: RESOURCE_DELETE
2025-05-25 12:28:38.212 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:28:38.215 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:28:38.217 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ORGANIZATION_UPDATE
2025-05-25 12:28:38.220 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:28:38.222 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:28:38.224 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: SCOPE_DELETE
2025-05-25 12:28:38.228 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:28:38.232 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:28:38.234 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:28:38.235 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: POLICY_UPDATE
2025-05-25 12:28:38.236 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:28:38.238 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:28:38.239 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ROLE_DELETE
2025-05-25 12:28:38.241 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:28:38.243 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:28:38.244 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: USER_UPDATE
2025-05-25 12:28:38.245 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:28:38.247 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:28:38.248 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: RESOURCE_CREATE
2025-05-25 12:28:38.250 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:28:38.252 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:28:38.569 DEBUG o.s.s.web.DefaultSecurityFilterChain - Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, LogoutFilter, JwtAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, SessionManagementFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-05-25 12:28:38.878 INFO  o.s.b.a.h.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:testdb'
2025-05-25 12:28:39.240 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 33269 (http) with context path '/'
2025-05-25 12:28:39.253 INFO  c.e.iam.integration.AuthAndRoleTest - Started AuthAndRoleTest in 8.176 seconds (process running for 9.305)
2025-05-25 12:28:39.873 DEBUG org.hibernate.SQL - 
    select
        u1_0.id,
        u1_0.created_at,
        u1_0.email,
        u1_0.enabled,
        u1_0.full_name,
        u1_0.organization_id,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0
2025-05-25 12:28:39.884 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.name,
        r1_0.updated_at 
    from
        roles r1_0
2025-05-25 12:28:39.885 DEBUG org.hibernate.SQL - 
    select
        p1_0.role_id,
        p1_1.id,
        p1_1.created_at,
        p1_1.description,
        p1_1.name,
        p1_1.updated_at 
    from
        role_permissions p1_0 
    join
        permissions p1_1 
            on p1_1.id=p1_0.permission_id 
    where
        p1_0.role_id=?
2025-05-25 12:28:39.887 DEBUG org.hibernate.SQL - 
    select
        u1_0.role_id,
        u1_1.id,
        u1_1.created_at,
        u1_1.email,
        u1_1.enabled,
        u1_1.full_name,
        u1_1.organization_id,
        u1_1.password,
        u1_1.updated_at,
        u1_1.username 
    from
        user_roles u1_0 
    join
        users u1_1 
            on u1_1.id=u1_0.user_id 
    where
        u1_0.role_id=?
2025-05-25 12:28:39.892 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0
2025-05-25 12:28:39.902 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:28:39.903 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:28:39.904 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:28:39.905 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:28:39.906 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:28:39.907 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:28:39.909 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:28:39.910 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:28:39.912 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:28:39.913 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:28:39.914 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:28:39.915 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:28:39.915 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:28:39.916 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:28:39.916 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:28:39.917 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:28:39.917 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:28:39.918 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:28:39.918 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:28:39.919 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:28:39.919 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:28:39.920 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:28:39.921 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:28:39.921 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:28:39.922 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:28:39.922 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:28:39.923 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:28:39.924 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:28:39.926 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:28:39.927 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:28:39.930 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:28:39.931 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:28:39.932 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:28:39.933 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:28:39.934 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:28:39.934 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:28:39.935 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:28:39.936 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:28:39.936 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:28:39.937 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:28:39.938 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:28:39.938 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:28:39.939 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:28:39.940 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:28:39.942 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:28:39.943 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:28:39.945 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:28:39.946 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:28:39.950 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.http_method,
        r1_0.name,
        r1_0.path,
        r1_0.updated_at 
    from
        resources r1_0
2025-05-25 12:28:39.954 DEBUG org.hibernate.SQL - 
    delete 
    from
        user_roles 
    where
        user_id=?
2025-05-25 12:28:39.956 DEBUG org.hibernate.SQL - 
    delete 
    from
        user_scopes 
    where
        user_id=?
2025-05-25 12:28:39.959 DEBUG org.hibernate.SQL - 
    delete 
    from
        users 
    where
        id=?
2025-05-25 12:28:39.966 DEBUG org.hibernate.SQL - 
    delete 
    from
        roles 
    where
        id=?
2025-05-25 12:28:39.967 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:28:39.968 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:28:39.969 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:28:39.969 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:28:39.970 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:28:39.971 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:28:39.971 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:28:39.972 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:28:39.973 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:28:39.974 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:28:39.974 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:28:39.975 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:28:39.976 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:28:39.978 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:28:39.979 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:28:39.979 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:28:39.980 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:28:39.980 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:28:39.981 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:28:39.981 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:28:39.982 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:28:39.982 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:28:39.983 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:28:39.983 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:28:39.985 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:28:39.988 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:28:39.991 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:28:39.994 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:28:39.999 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:28:40.001 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:28:40.004 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:28:40.006 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:28:40.009 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:28:40.012 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:28:40.016 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:28:40.018 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:28:40.022 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:28:40.027 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:28:40.032 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:28:40.033 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:28:40.036 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:28:40.037 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:28:40.041 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:28:40.044 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:28:40.047 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:28:40.049 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:28:40.052 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:28:40.053 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:28:40.056 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:28:40.058 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:28:40.064 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:28:40.067 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:28:40.070 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:28:40.072 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:28:40.076 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:28:40.080 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:28:40.083 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:28:40.085 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:28:40.647 DEBUG org.hibernate.SQL - 
    select
        count(*) 
    from
        permissions p1_0
2025-05-25 12:28:40.649 INFO  c.e.iam.integration.AuthAndRoleTest - Permissions created. Total permissions: 17
2025-05-25 12:28:40.651 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.name,
        r1_0.updated_at 
    from
        roles r1_0 
    where
        r1_0.name=?
2025-05-25 12:28:40.655 DEBUG org.hibernate.SQL - 
    insert 
    into
        roles
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:28:40.658 INFO  c.e.iam.integration.AuthAndRoleTest - Permissions role admin 
2025-05-25 12:28:40.663 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.name,
        r1_0.updated_at 
    from
        roles r1_0 
    where
        r1_0.name=?
2025-05-25 12:28:40.665 DEBUG org.hibernate.SQL - 
    insert 
    into
        roles
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:28:40.669 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.name,
        r1_0.updated_at 
    from
        roles r1_0 
    where
        r1_0.name=?
2025-05-25 12:28:40.672 DEBUG org.hibernate.SQL - 
    insert 
    into
        roles
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:28:40.675 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:28:40.676 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:28:40.677 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:28:40.678 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:28:40.678 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:28:40.679 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:28:40.680 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:28:40.681 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:28:40.681 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:28:40.682 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:28:40.682 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:28:40.683 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:28:40.683 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:28:40.684 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:28:40.684 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:28:40.685 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:28:40.685 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:28:40.686 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:28:40.686 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:28:40.687 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:28:40.687 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:28:40.688 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:28:40.688 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:28:40.689 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:28:40.689 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:28:40.805 DEBUG org.hibernate.SQL - 
    insert 
    into
        users
        (created_at, email, enabled, full_name, organization_id, password, updated_at, username) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?)
2025-05-25 12:28:40.923 DEBUG org.hibernate.SQL - 
    insert 
    into
        users
        (created_at, email, enabled, full_name, organization_id, password, updated_at, username) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?)
2025-05-25 12:28:41.053 DEBUG org.hibernate.SQL - 
    insert 
    into
        users
        (created_at, email, enabled, full_name, organization_id, password, updated_at, username) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?)
2025-05-25 12:28:41.056 DEBUG org.hibernate.SQL - 
    insert 
    into
        user_roles
        (user_id, role_id) 
    values
        (?, ?)
2025-05-25 12:28:41.058 DEBUG org.hibernate.SQL - 
    insert 
    into
        user_roles
        (user_id, role_id) 
    values
        (?, ?)
2025-05-25 12:28:41.059 DEBUG org.hibernate.SQL - 
    insert 
    into
        user_roles
        (user_id, role_id) 
    values
        (?, ?)
2025-05-25 12:28:41.334 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-05-25 12:28:41.335 INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-05-25 12:28:41.336 INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-05-25 12:28:41.369 DEBUG o.s.security.web.FilterChainProxy - Securing POST /auth/login
2025-05-25 12:28:41.380 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-05-25 12:28:41.382 DEBUG o.s.security.web.FilterChainProxy - Secured POST /auth/login
2025-05-25 12:28:41.562 DEBUG org.hibernate.SQL - 
    select
        u1_0.id,
        u1_0.created_at,
        u1_0.email,
        u1_0.enabled,
        u1_0.full_name,
        u1_0.organization_id,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.username=?
2025-05-25 12:28:41.565 DEBUG org.hibernate.SQL - 
    select
        r1_0.user_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        user_roles r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.user_id=?
2025-05-25 12:28:41.566 INFO  c.example.iam.security.UserPrincipal - user roles: [ROLE_ADMIN]
2025-05-25 12:28:41.567 DEBUG org.hibernate.SQL - 
    select
        p1_0.role_id,
        p1_1.id,
        p1_1.created_at,
        p1_1.description,
        p1_1.name,
        p1_1.updated_at 
    from
        role_permissions p1_0 
    join
        permissions p1_1 
            on p1_1.id=p1_0.permission_id 
    where
        p1_0.role_id=?
2025-05-25 12:28:41.568 INFO  c.example.iam.security.UserPrincipal - user permissions: []
2025-05-25 12:28:41.659 DEBUG o.s.s.a.d.DaoAuthenticationProvider - Authenticated user
2025-05-25 12:28:41.694 DEBUG org.hibernate.SQL - 
    insert 
    into
        tokens
        (client_id, created_at, expired, expires_at, revoked, token, token_type, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?)
2025-05-25 12:28:41.703 DEBUG org.hibernate.SQL - 
    insert 
    into
        tokens
        (client_id, created_at, expired, expires_at, revoked, token, token_type, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?)
2025-05-25 12:28:41.751 DEBUG o.s.security.web.FilterChainProxy - Securing POST /auth/login
2025-05-25 12:28:41.752 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-05-25 12:28:41.752 DEBUG o.s.security.web.FilterChainProxy - Secured POST /auth/login
2025-05-25 12:28:41.755 DEBUG org.hibernate.SQL - 
    select
        u1_0.id,
        u1_0.created_at,
        u1_0.email,
        u1_0.enabled,
        u1_0.full_name,
        u1_0.organization_id,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.username=?
2025-05-25 12:28:41.761 DEBUG org.hibernate.SQL - 
    select
        ca1_0.id,
        ca1_0.is_active,
        ca1_0.client_id,
        ca1_0.client_secret,
        ca1_0.created_at,
        ca1_0.description,
        ca1_0.name,
        ca1_0.redirect_uri,
        ca1_0.updated_at 
    from
        client_applications ca1_0 
    where
        ca1_0.client_id=?
2025-05-25 12:28:41.855 DEBUG o.s.s.a.d.DaoAuthenticationProvider - Failed to find user 'manager'
2025-05-25 12:28:41.862 ERROR c.e.i.e.GlobalExceptionHandler - Invalid credentials: Bad credentials
2025-05-25 12:28:41.872 DEBUG o.s.security.web.FilterChainProxy - Securing POST /auth/login
2025-05-25 12:28:41.873 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-05-25 12:28:41.873 DEBUG o.s.security.web.FilterChainProxy - Secured POST /auth/login
2025-05-25 12:28:41.877 DEBUG org.hibernate.SQL - 
    select
        u1_0.id,
        u1_0.created_at,
        u1_0.email,
        u1_0.enabled,
        u1_0.full_name,
        u1_0.organization_id,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.username=?
2025-05-25 12:28:41.879 DEBUG org.hibernate.SQL - 
    select
        ca1_0.id,
        ca1_0.is_active,
        ca1_0.client_id,
        ca1_0.client_secret,
        ca1_0.created_at,
        ca1_0.description,
        ca1_0.name,
        ca1_0.redirect_uri,
        ca1_0.updated_at 
    from
        client_applications ca1_0 
    where
        ca1_0.client_id=?
2025-05-25 12:28:41.985 DEBUG o.s.s.a.d.DaoAuthenticationProvider - Failed to find user 'user'
2025-05-25 12:28:41.987 ERROR c.e.i.e.GlobalExceptionHandler - Invalid credentials: Bad credentials
2025-05-25 12:28:41.996 INFO  c.e.iam.integration.AuthAndRoleTest - Testing /users endpoint with admin token: eyJhbGciOiJIUzI1NiJ9.eyJ0eXBlIjoidXNlciIsInVzZXJuYW1lIjoiYWRtaW4iLCJzdWIiOiJhZG1pbiIsImlhdCI6MTc0ODE2NTMyMSwiZXhwIjoxNzQ4MTY4OTIxfQ.S8P1yrAlJ-L4m-aoWbSI9xQYYxpOA4hWrY5g5OsTj6M
2025-05-25 12:28:42.001 DEBUG o.s.security.web.FilterChainProxy - Securing GET /users
2025-05-25 12:28:42.004 DEBUG org.hibernate.SQL - 
    select
        t1_0.token_id,
        t1_0.client_id,
        t1_0.created_at,
        t1_0.expired,
        t1_0.expires_at,
        t1_0.revoked,
        t1_0.token,
        t1_0.token_type,
        t1_0.user_id 
    from
        tokens t1_0 
    where
        t1_0.token=?
2025-05-25 12:28:42.036 DEBUG org.hibernate.SQL - 
    select
        u1_0.id,
        u1_0.created_at,
        u1_0.email,
        u1_0.enabled,
        u1_0.full_name,
        u1_0.organization_id,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.username=?
2025-05-25 12:28:42.038 DEBUG org.hibernate.SQL - 
    select
        r1_0.user_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        user_roles r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.user_id=?
2025-05-25 12:28:42.039 INFO  c.example.iam.security.UserPrincipal - user roles: [ROLE_ADMIN]
2025-05-25 12:28:42.040 DEBUG org.hibernate.SQL - 
    select
        p1_0.role_id,
        p1_1.id,
        p1_1.created_at,
        p1_1.description,
        p1_1.name,
        p1_1.updated_at 
    from
        role_permissions p1_0 
    join
        permissions p1_1 
            on p1_1.id=p1_0.permission_id 
    where
        p1_0.role_id=?
2025-05-25 12:28:42.041 INFO  c.example.iam.security.UserPrincipal - user permissions: []
2025-05-25 12:28:42.044 INFO  c.e.i.s.JwtAuthenticationFilter - username 1: admin
2025-05-25 12:28:42.044 INFO  c.e.i.s.JwtAuthenticationFilter - Required permission 1: []
2025-05-25 12:28:42.045 DEBUG o.s.security.web.FilterChainProxy - Secured GET /users
2025-05-25 12:28:42.053 INFO  c.e.i.s.aspect.PermissionCheckAspect - Required permission: USER_READ
2025-05-25 12:28:42.054 INFO  c.e.i.s.aspect.PermissionCheckAspect - User permissions: []
2025-05-25 12:28:42.055 ERROR c.e.i.e.GlobalExceptionHandler - Access denied: User does not have required permission: USER_READ
2025-05-25 12:28:42.060 INFO  c.e.iam.integration.AuthAndRoleTest - Raw response from /users: Status=403 FORBIDDEN, Body={"status":403,"error":"Access denied","message":"User does not have required permission: USER_READ"}
2025-05-25 12:28:42.065 DEBUG o.s.security.web.FilterChainProxy - Securing GET /users
2025-05-25 12:28:42.067 DEBUG org.hibernate.SQL - 
    select
        t1_0.token_id,
        t1_0.client_id,
        t1_0.created_at,
        t1_0.expired,
        t1_0.expires_at,
        t1_0.revoked,
        t1_0.token,
        t1_0.token_type,
        t1_0.user_id 
    from
        tokens t1_0 
    where
        t1_0.token=?
2025-05-25 12:28:42.074 DEBUG org.hibernate.SQL - 
    select
        u1_0.id,
        u1_0.created_at,
        u1_0.email,
        u1_0.enabled,
        u1_0.full_name,
        u1_0.organization_id,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.username=?
2025-05-25 12:28:42.076 DEBUG org.hibernate.SQL - 
    select
        r1_0.user_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        user_roles r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.user_id=?
2025-05-25 12:28:42.077 INFO  c.example.iam.security.UserPrincipal - user roles: [ROLE_ADMIN]
2025-05-25 12:28:42.077 DEBUG org.hibernate.SQL - 
    select
        p1_0.role_id,
        p1_1.id,
        p1_1.created_at,
        p1_1.description,
        p1_1.name,
        p1_1.updated_at 
    from
        role_permissions p1_0 
    join
        permissions p1_1 
            on p1_1.id=p1_0.permission_id 
    where
        p1_0.role_id=?
2025-05-25 12:28:42.078 INFO  c.example.iam.security.UserPrincipal - user permissions: []
2025-05-25 12:28:42.079 INFO  c.e.i.s.JwtAuthenticationFilter - username 1: admin
2025-05-25 12:28:42.079 INFO  c.e.i.s.JwtAuthenticationFilter - Required permission 1: []
2025-05-25 12:28:42.079 DEBUG o.s.security.web.FilterChainProxy - Secured GET /users
2025-05-25 12:28:42.080 INFO  c.e.i.s.aspect.PermissionCheckAspect - Required permission: USER_READ
2025-05-25 12:28:42.080 INFO  c.e.i.s.aspect.PermissionCheckAspect - User permissions: []
2025-05-25 12:28:42.080 ERROR c.e.i.e.GlobalExceptionHandler - Access denied: User does not have required permission: USER_READ
2025-05-25 12:28:42.082 INFO  c.e.iam.integration.AuthAndRoleTest - Parsed response: Status=403 FORBIDDEN, Body={status=403, error=Access denied, message=User does not have required permission: USER_READ}
2025-05-25 12:28:42.169 INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-05-25 12:28:42.173 INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-05-25 12:28:42.181 DEBUG org.hibernate.SQL - 
    set client_min_messages = WARNING
2025-05-25 12:28:42.181 ERROR o.h.t.s.i.SchemaDropperImpl$DelayedDropActionImpl - HHH000478: Unsuccessful: 
    set client_min_messages = WARNING
2025-05-25 12:28:42.182 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       drop constraint if exists FK21l4ab5xsq7rxwb7b2efptbmt
2025-05-25 12:28:42.183 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       drop constraint if exists FK4glu0kw16kw6gu23yr5q6vjme
2025-05-25 12:28:42.183 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       drop constraint if exists FK3smj35weuy4b1fj396l5jvt6g
2025-05-25 12:28:42.184 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       drop constraint if exists FKacyhrlymxo934q9c4n441dhwf
2025-05-25 12:28:42.184 DEBUG org.hibernate.SQL - 
    alter table if exists policies 
       drop constraint if exists FKs49d98df3xexcyui98cwpek9p
2025-05-25 12:28:42.184 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       drop constraint if exists FKegdk29eiy7mdtefy5c7eirr6e
2025-05-25 12:28:42.185 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       drop constraint if exists FKn5fotdgk8d1xvo8nav9uv3muc
2025-05-25 12:28:42.185 DEBUG org.hibernate.SQL - 
    alter table if exists tokens 
       drop constraint if exists FK2dylsfo39lgjyqml2tbe0b0ss
2025-05-25 12:28:42.185 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       drop constraint if exists FKh8ciramu9cc9q3qcqiv4ue8a6
2025-05-25 12:28:42.186 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       drop constraint if exists FKhfh9dx7w3ubf1co1vdev94g3f
2025-05-25 12:28:42.186 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       drop constraint if exists FK4gc7xv8r1p0j6ykgn5h4nx934
2025-05-25 12:28:42.186 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       drop constraint if exists FKspv2c7f3cxhd1242nkabx95s5
2025-05-25 12:28:42.187 DEBUG org.hibernate.SQL - 
    alter table if exists users 
       drop constraint if exists FKqpugllwvyv37klq7ft9m8aqxk
2025-05-25 12:28:42.187 DEBUG org.hibernate.SQL - 
    drop table if exists client_applications cascade
2025-05-25 12:28:42.190 DEBUG org.hibernate.SQL - 
    drop table if exists client_scopes cascade
2025-05-25 12:28:42.191 DEBUG org.hibernate.SQL - 
    drop table if exists organizations cascade
2025-05-25 12:28:42.191 DEBUG org.hibernate.SQL - 
    drop table if exists permission_scopes cascade
2025-05-25 12:28:42.192 DEBUG org.hibernate.SQL - 
    drop table if exists permissions cascade
2025-05-25 12:28:42.192 DEBUG org.hibernate.SQL - 
    drop table if exists policies cascade
2025-05-25 12:28:42.193 DEBUG org.hibernate.SQL - 
    drop table if exists resources cascade
2025-05-25 12:28:42.194 DEBUG org.hibernate.SQL - 
    drop table if exists role_permissions cascade
2025-05-25 12:28:42.194 DEBUG org.hibernate.SQL - 
    drop table if exists roles cascade
2025-05-25 12:28:42.194 DEBUG org.hibernate.SQL - 
    drop table if exists scopes cascade
2025-05-25 12:28:42.195 DEBUG org.hibernate.SQL - 
    drop table if exists tokens cascade
2025-05-25 12:28:42.196 DEBUG org.hibernate.SQL - 
    drop table if exists user_roles cascade
2025-05-25 12:28:42.196 DEBUG org.hibernate.SQL - 
    drop table if exists user_scopes cascade
2025-05-25 12:28:42.197 DEBUG org.hibernate.SQL - 
    drop table if exists users cascade
2025-05-25 12:28:42.199 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-25 12:28:42.201 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-25 12:35:04.002 INFO  c.e.iam.integration.AuthAndRoleTest - Starting AuthAndRoleTest using Java 21.0.7 with PID 24877 (started by descent in /home/descent/Documents/VDT/vdt5-iam-system/iam-service)
2025-05-25 12:35:04.003 DEBUG c.e.iam.integration.AuthAndRoleTest - Running with Spring Boot v3.4.5, Spring v6.2.6
2025-05-25 12:35:04.004 INFO  c.e.iam.integration.AuthAndRoleTest - The following 1 profile is active: "test"
2025-05-25 12:35:05.169 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-05-25 12:35:05.301 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 117 ms. Found 9 JPA repository interfaces.
2025-05-25 12:35:06.268 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 0 (http)
2025-05-25 12:35:06.286 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-25 12:35:06.287 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.40]
2025-05-25 12:35:06.348 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-25 12:35:06.348 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2321 ms
2025-05-25 12:35:07.030 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-25 12:35:07.251 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:testdb user=SA
2025-05-25 12:35:07.253 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-25 12:35:08.598 DEBUG org.hibernate.SQL - 
    set client_min_messages = WARNING
2025-05-25 12:35:08.603 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       drop constraint if exists FK21l4ab5xsq7rxwb7b2efptbmt
2025-05-25 12:35:08.604 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       drop constraint if exists FK4glu0kw16kw6gu23yr5q6vjme
2025-05-25 12:35:08.604 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       drop constraint if exists FK3smj35weuy4b1fj396l5jvt6g
2025-05-25 12:35:08.605 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       drop constraint if exists FKacyhrlymxo934q9c4n441dhwf
2025-05-25 12:35:08.605 DEBUG org.hibernate.SQL - 
    alter table if exists policies 
       drop constraint if exists FKs49d98df3xexcyui98cwpek9p
2025-05-25 12:35:08.606 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       drop constraint if exists FKegdk29eiy7mdtefy5c7eirr6e
2025-05-25 12:35:08.607 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       drop constraint if exists FKn5fotdgk8d1xvo8nav9uv3muc
2025-05-25 12:35:08.608 DEBUG org.hibernate.SQL - 
    alter table if exists tokens 
       drop constraint if exists FK2dylsfo39lgjyqml2tbe0b0ss
2025-05-25 12:35:08.608 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       drop constraint if exists FKh8ciramu9cc9q3qcqiv4ue8a6
2025-05-25 12:35:08.609 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       drop constraint if exists FKhfh9dx7w3ubf1co1vdev94g3f
2025-05-25 12:35:08.609 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       drop constraint if exists FK4gc7xv8r1p0j6ykgn5h4nx934
2025-05-25 12:35:08.609 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       drop constraint if exists FKspv2c7f3cxhd1242nkabx95s5
2025-05-25 12:35:08.610 DEBUG org.hibernate.SQL - 
    alter table if exists users 
       drop constraint if exists FKqpugllwvyv37klq7ft9m8aqxk
2025-05-25 12:35:08.610 DEBUG org.hibernate.SQL - 
    drop table if exists client_applications cascade
2025-05-25 12:35:08.611 DEBUG org.hibernate.SQL - 
    drop table if exists client_scopes cascade
2025-05-25 12:35:08.612 DEBUG org.hibernate.SQL - 
    drop table if exists organizations cascade
2025-05-25 12:35:08.612 DEBUG org.hibernate.SQL - 
    drop table if exists permission_scopes cascade
2025-05-25 12:35:08.612 DEBUG org.hibernate.SQL - 
    drop table if exists permissions cascade
2025-05-25 12:35:08.613 DEBUG org.hibernate.SQL - 
    drop table if exists policies cascade
2025-05-25 12:35:08.613 DEBUG org.hibernate.SQL - 
    drop table if exists resources cascade
2025-05-25 12:35:08.613 DEBUG org.hibernate.SQL - 
    drop table if exists role_permissions cascade
2025-05-25 12:35:08.614 DEBUG org.hibernate.SQL - 
    drop table if exists roles cascade
2025-05-25 12:35:08.614 DEBUG org.hibernate.SQL - 
    drop table if exists scopes cascade
2025-05-25 12:35:08.615 DEBUG org.hibernate.SQL - 
    drop table if exists tokens cascade
2025-05-25 12:35:08.615 DEBUG org.hibernate.SQL - 
    drop table if exists user_roles cascade
2025-05-25 12:35:08.615 DEBUG org.hibernate.SQL - 
    drop table if exists user_scopes cascade
2025-05-25 12:35:08.615 DEBUG org.hibernate.SQL - 
    drop table if exists users cascade
2025-05-25 12:35:08.620 DEBUG org.hibernate.SQL - 
    create table client_applications (
        is_active boolean,
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        client_id varchar(100) not null unique,
        name varchar(100) not null,
        client_secret varchar(255) not null,
        description TEXT,
        redirect_uri varchar(255),
        primary key (id)
    )
2025-05-25 12:35:08.630 DEBUG org.hibernate.SQL - 
    create table client_scopes (
        client_id bigint not null,
        scope_id bigint not null,
        primary key (client_id, scope_id)
    )
2025-05-25 12:35:08.632 DEBUG org.hibernate.SQL - 
    create table organizations (
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        description varchar(1000),
        name varchar(255) not null unique,
        primary key (id)
    )
2025-05-25 12:35:08.633 DEBUG org.hibernate.SQL - 
    create table permission_scopes (
        permission_id bigint not null,
        scope_id bigint not null,
        primary key (permission_id, scope_id)
    )
2025-05-25 12:35:08.634 DEBUG org.hibernate.SQL - 
    create table permissions (
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        name varchar(100) not null unique,
        description TEXT,
        primary key (id)
    )
2025-05-25 12:35:08.637 DEBUG org.hibernate.SQL - 
    create table policies (
        subject_type smallint not null check (subject_type between 0 and 3),
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        resource_id bigint not null,
        subject_id bigint not null,
        updated_at timestamp(6) not null,
        action varchar(255) not null,
        condition_json TEXT,
        effect varchar(255) not null check (effect in ('ALLOW','DENY')),
        primary key (id)
    )
2025-05-25 12:35:08.644 DEBUG org.hibernate.SQL - 
    create table resources (
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        name varchar(100) not null,
        description TEXT,
        http_method varchar(255) not null check (http_method in ('GET','POST','PUT','DELETE','PATCH','HEAD','OPTIONS')),
        path varchar(255) not null,
        primary key (id)
    )
2025-05-25 12:35:08.645 DEBUG org.hibernate.SQL - 
    create table role_permissions (
        permission_id bigint not null,
        role_id bigint not null,
        primary key (permission_id, role_id)
    )
2025-05-25 12:35:08.647 DEBUG org.hibernate.SQL - 
    create table roles (
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        name varchar(50) not null unique,
        description TEXT,
        primary key (id)
    )
2025-05-25 12:35:08.650 DEBUG org.hibernate.SQL - 
    create table scopes (
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        name varchar(100) not null unique,
        description TEXT,
        primary key (id)
    )
2025-05-25 12:35:08.652 DEBUG org.hibernate.SQL - 
    create table tokens (
        expired boolean not null,
        revoked boolean not null,
        created_at timestamp(6) not null,
        expires_at timestamp(6) not null,
        token_id bigint generated by default as identity,
        user_id bigint,
        client_id varchar(255),
        token TEXT not null,
        token_type varchar(255) not null check (token_type in ('ACCESS','REFRESH')),
        primary key (token_id)
    )
2025-05-25 12:35:08.653 DEBUG org.hibernate.SQL - 
    create table user_roles (
        role_id bigint not null,
        user_id bigint not null,
        primary key (role_id, user_id)
    )
2025-05-25 12:35:08.655 DEBUG org.hibernate.SQL - 
    create table user_scopes (
        scope_id bigint not null,
        user_id bigint not null,
        primary key (scope_id, user_id)
    )
2025-05-25 12:35:08.656 DEBUG org.hibernate.SQL - 
    create table users (
        enabled boolean not null,
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        organization_id bigint,
        updated_at timestamp(6) not null,
        username varchar(50) not null unique,
        password varchar(100) not null,
        email varchar(255) not null unique,
        full_name varchar(255),
        primary key (id)
    )
2025-05-25 12:35:08.659 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       add constraint FK21l4ab5xsq7rxwb7b2efptbmt 
       foreign key (scope_id) 
       references scopes
2025-05-25 12:35:08.667 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       add constraint FK4glu0kw16kw6gu23yr5q6vjme 
       foreign key (client_id) 
       references client_applications
2025-05-25 12:35:08.669 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       add constraint FK3smj35weuy4b1fj396l5jvt6g 
       foreign key (scope_id) 
       references scopes
2025-05-25 12:35:08.671 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       add constraint FKacyhrlymxo934q9c4n441dhwf 
       foreign key (permission_id) 
       references permissions
2025-05-25 12:35:08.673 DEBUG org.hibernate.SQL - 
    alter table if exists policies 
       add constraint FKs49d98df3xexcyui98cwpek9p 
       foreign key (resource_id) 
       references resources
2025-05-25 12:35:08.676 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       add constraint FKegdk29eiy7mdtefy5c7eirr6e 
       foreign key (permission_id) 
       references permissions
2025-05-25 12:35:08.679 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       add constraint FKn5fotdgk8d1xvo8nav9uv3muc 
       foreign key (role_id) 
       references roles
2025-05-25 12:35:08.681 DEBUG org.hibernate.SQL - 
    alter table if exists tokens 
       add constraint FK2dylsfo39lgjyqml2tbe0b0ss 
       foreign key (user_id) 
       references users
2025-05-25 12:35:08.684 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       add constraint FKh8ciramu9cc9q3qcqiv4ue8a6 
       foreign key (role_id) 
       references roles
2025-05-25 12:35:08.686 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       add constraint FKhfh9dx7w3ubf1co1vdev94g3f 
       foreign key (user_id) 
       references users
2025-05-25 12:35:08.689 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       add constraint FK4gc7xv8r1p0j6ykgn5h4nx934 
       foreign key (scope_id) 
       references scopes
2025-05-25 12:35:08.692 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       add constraint FKspv2c7f3cxhd1242nkabx95s5 
       foreign key (user_id) 
       references users
2025-05-25 12:35:08.695 DEBUG org.hibernate.SQL - 
    alter table if exists users 
       add constraint FKqpugllwvyv37klq7ft9m8aqxk 
       foreign key (organization_id) 
       references organizations
2025-05-25 12:35:09.267 DEBUG c.e.i.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-05-25 12:35:09.353 INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name customUserDetailsService
2025-05-25 12:35:09.825 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.name,
        r1_0.updated_at 
    from
        roles r1_0 
    where
        r1_0.name=?
2025-05-25 12:35:09.961 DEBUG org.hibernate.SQL - 
    insert 
    into
        roles
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:35:10.003 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0
2025-05-25 12:35:10.018 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.name,
        p1_0.role_id,
        p1_1.id,
        p1_1.created_at,
        p1_1.description,
        p1_1.name,
        p1_1.updated_at,
        r1_0.updated_at 
    from
        roles r1_0 
    left join
        role_permissions p1_0 
            on r1_0.id=p1_0.role_id 
    left join
        permissions p1_1 
            on p1_1.id=p1_0.permission_id 
    where
        r1_0.id=?
2025-05-25 12:35:10.031 DEBUG org.hibernate.SQL - 
    select
        u1_0.role_id,
        u1_1.id,
        u1_1.created_at,
        u1_1.email,
        u1_1.enabled,
        u1_1.full_name,
        u1_1.organization_id,
        u1_1.password,
        u1_1.updated_at,
        u1_1.username 
    from
        user_roles u1_0 
    join
        users u1_1 
            on u1_1.id=u1_0.user_id 
    where
        u1_0.role_id=?
2025-05-25 12:35:10.046 DEBUG org.hibernate.SQL - 
    update
        roles 
    set
        description=?,
        name=?,
        updated_at=? 
    where
        id=?
2025-05-25 12:35:10.051 INFO  c.e.i.s.AdminInitializationService - Updated admin role with 0 permissions
2025-05-25 12:35:10.053 DEBUG org.hibernate.SQL - 
    select
        u1_0.id,
        u1_0.created_at,
        u1_0.email,
        u1_0.enabled,
        u1_0.full_name,
        u1_0.organization_id,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.username=?
2025-05-25 12:35:10.182 DEBUG org.hibernate.SQL - 
    insert 
    into
        users
        (created_at, email, enabled, full_name, organization_id, password, updated_at, username) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?)
2025-05-25 12:35:10.185 DEBUG org.hibernate.SQL - 
    insert 
    into
        user_roles
        (user_id, role_id) 
    values
        (?, ?)
2025-05-25 12:35:10.186 INFO  c.e.i.s.AdminInitializationService - Created admin user with username: admin
2025-05-25 12:35:10.365 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-05-25 12:35:10.543 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:35:10.547 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:35:10.549 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ROLE_DELETE
2025-05-25 12:35:10.551 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:35:10.555 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:35:10.557 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ROLE_READ
2025-05-25 12:35:10.560 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:35:10.563 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:35:10.564 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: SCOPE_DELETE
2025-05-25 12:35:10.566 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:35:10.567 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:35:10.569 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: RESOURCE_READ
2025-05-25 12:35:10.572 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:35:10.574 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:35:10.576 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ROLE_CREATE
2025-05-25 12:35:10.578 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:35:10.580 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:35:10.581 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: RESOURCE_DELETE
2025-05-25 12:35:10.583 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:35:10.585 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:35:10.587 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: USER_UPDATE
2025-05-25 12:35:10.590 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:35:10.593 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:35:10.595 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: SCOPE_READ
2025-05-25 12:35:10.597 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:35:10.599 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:35:10.601 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:35:10.605 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ORGANIZATION_CREATE
2025-05-25 12:35:10.608 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:35:10.610 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:35:10.613 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: POLICY_CREATE
2025-05-25 12:35:10.615 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:35:10.617 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:35:10.619 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: POLICY_UPDATE
2025-05-25 12:35:10.621 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:35:10.623 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:35:10.626 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ORGANIZATION_UPDATE
2025-05-25 12:35:10.628 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:35:10.631 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:35:10.632 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: SCOPE_CREATE
2025-05-25 12:35:10.633 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:35:10.635 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:35:10.638 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ORGANIZATION_READ
2025-05-25 12:35:10.640 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:35:10.643 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:35:10.645 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: POLICY_READ
2025-05-25 12:35:10.647 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:35:10.649 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:35:10.650 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:35:10.652 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: USER_DELETE
2025-05-25 12:35:10.654 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:35:10.657 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:35:10.659 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: USER_READ
2025-05-25 12:35:10.661 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:35:10.663 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:35:10.665 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:35:10.667 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: RESOURCE_CREATE
2025-05-25 12:35:10.668 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:35:10.671 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:35:10.673 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ROLE_UPDATE
2025-05-25 12:35:10.675 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:35:10.679 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:35:10.681 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:35:10.682 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: POLICY_DELETE
2025-05-25 12:35:10.684 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:35:10.685 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:35:10.687 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ORGANIZATION_DELETE
2025-05-25 12:35:10.689 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:35:10.692 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:35:10.694 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:35:10.695 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: RESOURCE_UPDATE
2025-05-25 12:35:10.697 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:35:10.699 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:35:10.700 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: SCOPE_UPDATE
2025-05-25 12:35:10.702 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:35:10.705 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:35:10.707 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: CLIENT_CREATE
2025-05-25 12:35:10.708 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:35:11.053 DEBUG o.s.s.web.DefaultSecurityFilterChain - Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, LogoutFilter, JwtAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, SessionManagementFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-05-25 12:35:11.365 INFO  o.s.b.a.h.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:testdb'
2025-05-25 12:35:11.709 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 33809 (http) with context path '/'
2025-05-25 12:35:11.720 INFO  c.e.iam.integration.AuthAndRoleTest - Started AuthAndRoleTest in 8.224 seconds (process running for 9.494)
2025-05-25 12:35:12.311 DEBUG org.hibernate.SQL - 
    select
        u1_0.id,
        u1_0.created_at,
        u1_0.email,
        u1_0.enabled,
        u1_0.full_name,
        u1_0.organization_id,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0
2025-05-25 12:35:12.316 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.name,
        r1_0.updated_at 
    from
        roles r1_0
2025-05-25 12:35:12.317 DEBUG org.hibernate.SQL - 
    select
        p1_0.role_id,
        p1_1.id,
        p1_1.created_at,
        p1_1.description,
        p1_1.name,
        p1_1.updated_at 
    from
        role_permissions p1_0 
    join
        permissions p1_1 
            on p1_1.id=p1_0.permission_id 
    where
        p1_0.role_id=?
2025-05-25 12:35:12.318 DEBUG org.hibernate.SQL - 
    select
        u1_0.role_id,
        u1_1.id,
        u1_1.created_at,
        u1_1.email,
        u1_1.enabled,
        u1_1.full_name,
        u1_1.organization_id,
        u1_1.password,
        u1_1.updated_at,
        u1_1.username 
    from
        user_roles u1_0 
    join
        users u1_1 
            on u1_1.id=u1_0.user_id 
    where
        u1_0.role_id=?
2025-05-25 12:35:12.322 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0
2025-05-25 12:35:12.329 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:35:12.330 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:35:12.331 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:35:12.332 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:35:12.333 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:35:12.333 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:35:12.334 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:35:12.335 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:35:12.337 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:35:12.337 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:35:12.338 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:35:12.339 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:35:12.339 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:35:12.340 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:35:12.340 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:35:12.341 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:35:12.342 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:35:12.342 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:35:12.343 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:35:12.344 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:35:12.345 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:35:12.345 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:35:12.346 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:35:12.347 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:35:12.348 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:35:12.349 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:35:12.350 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:35:12.351 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:35:12.351 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:35:12.352 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:35:12.353 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:35:12.354 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:35:12.355 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:35:12.355 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:35:12.356 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:35:12.357 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:35:12.358 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:35:12.359 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:35:12.360 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:35:12.361 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:35:12.362 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:35:12.364 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:35:12.365 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:35:12.366 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:35:12.367 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:35:12.368 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:35:12.370 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:35:12.371 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:35:12.376 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.http_method,
        r1_0.name,
        r1_0.path,
        r1_0.updated_at 
    from
        resources r1_0
2025-05-25 12:35:12.381 DEBUG org.hibernate.SQL - 
    delete 
    from
        user_roles 
    where
        user_id=?
2025-05-25 12:35:12.384 DEBUG org.hibernate.SQL - 
    delete 
    from
        user_scopes 
    where
        user_id=?
2025-05-25 12:35:12.387 DEBUG org.hibernate.SQL - 
    delete 
    from
        users 
    where
        id=?
2025-05-25 12:35:12.391 DEBUG org.hibernate.SQL - 
    delete 
    from
        roles 
    where
        id=?
2025-05-25 12:35:12.392 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:35:12.393 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:35:12.393 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:35:12.394 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:35:12.395 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:35:12.395 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:35:12.396 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:35:12.396 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:35:12.397 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:35:12.397 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:35:12.398 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:35:12.398 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:35:12.398 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:35:12.399 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:35:12.399 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:35:12.400 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:35:12.400 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:35:12.400 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:35:12.401 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:35:12.402 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:35:12.403 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:35:12.404 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:35:12.404 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:35:12.405 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:35:12.407 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:35:12.409 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:35:12.411 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:35:12.413 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:35:12.415 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:35:12.416 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:35:12.419 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:35:12.420 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:35:12.423 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:35:12.424 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:35:12.427 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:35:12.428 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:35:12.431 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:35:12.433 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:35:12.438 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:35:12.439 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:35:12.443 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:35:12.445 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:35:12.448 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:35:12.449 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:35:12.454 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:35:12.456 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:35:12.461 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:35:12.463 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:35:12.465 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:35:12.466 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:35:12.471 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:35:12.473 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:35:12.478 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:35:12.480 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:35:12.482 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:35:12.483 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:35:12.488 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:35:12.490 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:35:12.837 DEBUG org.hibernate.SQL - 
    select
        count(*) 
    from
        permissions p1_0
2025-05-25 12:35:12.838 INFO  c.e.iam.integration.AuthAndRoleTest - Permissions created. Total permissions: 17
2025-05-25 12:35:12.840 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.name,
        r1_0.updated_at 
    from
        roles r1_0 
    where
        r1_0.name=?
2025-05-25 12:35:12.843 DEBUG org.hibernate.SQL - 
    insert 
    into
        roles
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:35:12.846 INFO  c.e.iam.integration.AuthAndRoleTest - Admin role permissions: [ROLE_UPDATE, USER_READ, SCOPE_CREATE, SCOPE_UPDATE, RESOURCE_UPDATE, ROLE_DELETE, SCOPE_DELETE, RESOURCE_DELETE, RESOURCE_CREATE, ORGANIZATION_UPDATE, POLICY_DELETE, ORGANIZATION_DELETE, ROLE_CREATE, ORGANIZATION_READ, POLICY_READ, ORGANIZATION_CREATE, POLICY_CREATE]
2025-05-25 12:35:12.849 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.name,
        r1_0.updated_at 
    from
        roles r1_0 
    where
        r1_0.name=?
2025-05-25 12:35:12.851 DEBUG org.hibernate.SQL - 
    insert 
    into
        roles
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:35:12.855 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.name,
        r1_0.updated_at 
    from
        roles r1_0 
    where
        r1_0.name=?
2025-05-25 12:35:12.857 DEBUG org.hibernate.SQL - 
    insert 
    into
        roles
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:35:12.859 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:35:12.860 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:35:12.860 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:35:12.861 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:35:12.862 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:35:12.862 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:35:12.863 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:35:12.863 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:35:12.864 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:35:12.864 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:35:12.865 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:35:12.865 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:35:12.866 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:35:12.866 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:35:12.867 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:35:12.867 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:35:12.868 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:35:12.869 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:35:12.869 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:35:12.870 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:35:12.870 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:35:12.871 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:35:12.871 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:35:12.872 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:35:12.872 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:35:12.970 DEBUG org.hibernate.SQL - 
    insert 
    into
        users
        (created_at, email, enabled, full_name, organization_id, password, updated_at, username) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?)
2025-05-25 12:35:13.062 DEBUG org.hibernate.SQL - 
    insert 
    into
        users
        (created_at, email, enabled, full_name, organization_id, password, updated_at, username) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?)
2025-05-25 12:35:13.153 DEBUG org.hibernate.SQL - 
    insert 
    into
        users
        (created_at, email, enabled, full_name, organization_id, password, updated_at, username) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?)
2025-05-25 12:35:13.155 DEBUG org.hibernate.SQL - 
    insert 
    into
        user_roles
        (user_id, role_id) 
    values
        (?, ?)
2025-05-25 12:35:13.155 DEBUG org.hibernate.SQL - 
    insert 
    into
        user_roles
        (user_id, role_id) 
    values
        (?, ?)
2025-05-25 12:35:13.156 DEBUG org.hibernate.SQL - 
    insert 
    into
        user_roles
        (user_id, role_id) 
    values
        (?, ?)
2025-05-25 12:35:13.312 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-05-25 12:35:13.312 INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-05-25 12:35:13.313 INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-05-25 12:35:13.324 DEBUG o.s.security.web.FilterChainProxy - Securing POST /auth/login
2025-05-25 12:35:13.330 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-05-25 12:35:13.331 DEBUG o.s.security.web.FilterChainProxy - Secured POST /auth/login
2025-05-25 12:35:13.465 DEBUG org.hibernate.SQL - 
    select
        u1_0.id,
        u1_0.created_at,
        u1_0.email,
        u1_0.enabled,
        u1_0.full_name,
        u1_0.organization_id,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.username=?
2025-05-25 12:35:13.469 DEBUG org.hibernate.SQL - 
    select
        r1_0.user_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        user_roles r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.user_id=?
2025-05-25 12:35:13.471 INFO  c.example.iam.security.UserPrincipal - user roles: [ROLE_ADMIN]
2025-05-25 12:35:13.471 DEBUG org.hibernate.SQL - 
    select
        p1_0.role_id,
        p1_1.id,
        p1_1.created_at,
        p1_1.description,
        p1_1.name,
        p1_1.updated_at 
    from
        role_permissions p1_0 
    join
        permissions p1_1 
            on p1_1.id=p1_0.permission_id 
    where
        p1_0.role_id=?
2025-05-25 12:35:13.472 INFO  c.example.iam.security.UserPrincipal - user permissions: []
2025-05-25 12:35:13.560 DEBUG o.s.s.a.d.DaoAuthenticationProvider - Authenticated user
2025-05-25 12:35:13.583 DEBUG org.hibernate.SQL - 
    insert 
    into
        tokens
        (client_id, created_at, expired, expires_at, revoked, token, token_type, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?)
2025-05-25 12:35:13.587 DEBUG org.hibernate.SQL - 
    insert 
    into
        tokens
        (client_id, created_at, expired, expires_at, revoked, token, token_type, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?)
2025-05-25 12:35:13.623 DEBUG o.s.security.web.FilterChainProxy - Securing POST /auth/login
2025-05-25 12:35:13.624 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-05-25 12:35:13.624 DEBUG o.s.security.web.FilterChainProxy - Secured POST /auth/login
2025-05-25 12:35:13.629 DEBUG org.hibernate.SQL - 
    select
        u1_0.id,
        u1_0.created_at,
        u1_0.email,
        u1_0.enabled,
        u1_0.full_name,
        u1_0.organization_id,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.username=?
2025-05-25 12:35:13.633 DEBUG org.hibernate.SQL - 
    select
        ca1_0.id,
        ca1_0.is_active,
        ca1_0.client_id,
        ca1_0.client_secret,
        ca1_0.created_at,
        ca1_0.description,
        ca1_0.name,
        ca1_0.redirect_uri,
        ca1_0.updated_at 
    from
        client_applications ca1_0 
    where
        ca1_0.client_id=?
2025-05-25 12:35:13.750 DEBUG o.s.s.a.d.DaoAuthenticationProvider - Failed to find user 'manager'
2025-05-25 12:35:13.758 ERROR c.e.i.e.GlobalExceptionHandler - Invalid credentials: Bad credentials
2025-05-25 12:35:13.774 DEBUG o.s.security.web.FilterChainProxy - Securing POST /auth/login
2025-05-25 12:35:13.774 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-05-25 12:35:13.774 DEBUG o.s.security.web.FilterChainProxy - Secured POST /auth/login
2025-05-25 12:35:13.778 DEBUG org.hibernate.SQL - 
    select
        u1_0.id,
        u1_0.created_at,
        u1_0.email,
        u1_0.enabled,
        u1_0.full_name,
        u1_0.organization_id,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.username=?
2025-05-25 12:35:13.780 DEBUG org.hibernate.SQL - 
    select
        ca1_0.id,
        ca1_0.is_active,
        ca1_0.client_id,
        ca1_0.client_secret,
        ca1_0.created_at,
        ca1_0.description,
        ca1_0.name,
        ca1_0.redirect_uri,
        ca1_0.updated_at 
    from
        client_applications ca1_0 
    where
        ca1_0.client_id=?
2025-05-25 12:35:13.875 DEBUG o.s.s.a.d.DaoAuthenticationProvider - Failed to find user 'user'
2025-05-25 12:35:13.876 ERROR c.e.i.e.GlobalExceptionHandler - Invalid credentials: Bad credentials
2025-05-25 12:35:13.880 INFO  c.e.iam.integration.AuthAndRoleTest - Testing /users endpoint with admin token: eyJhbGciOiJIUzI1NiJ9.eyJ0eXBlIjoidXNlciIsInVzZXJuYW1lIjoiYWRtaW4iLCJzdWIiOiJhZG1pbiIsImlhdCI6MTc0ODE2NTcxMywiZXhwIjoxNzQ4MTY5MzEzfQ.D3lhKRBTwnet_oB4iLRqyXsjmVPc8Gqysg3yEV9gC4Y
2025-05-25 12:35:13.883 DEBUG o.s.security.web.FilterChainProxy - Securing GET /users
2025-05-25 12:35:13.886 DEBUG org.hibernate.SQL - 
    select
        t1_0.token_id,
        t1_0.client_id,
        t1_0.created_at,
        t1_0.expired,
        t1_0.expires_at,
        t1_0.revoked,
        t1_0.token,
        t1_0.token_type,
        t1_0.user_id 
    from
        tokens t1_0 
    where
        t1_0.token=?
2025-05-25 12:35:13.913 DEBUG org.hibernate.SQL - 
    select
        u1_0.id,
        u1_0.created_at,
        u1_0.email,
        u1_0.enabled,
        u1_0.full_name,
        u1_0.organization_id,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.username=?
2025-05-25 12:35:13.915 DEBUG org.hibernate.SQL - 
    select
        r1_0.user_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        user_roles r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.user_id=?
2025-05-25 12:35:13.916 INFO  c.example.iam.security.UserPrincipal - user roles: [ROLE_ADMIN]
2025-05-25 12:35:13.916 DEBUG org.hibernate.SQL - 
    select
        p1_0.role_id,
        p1_1.id,
        p1_1.created_at,
        p1_1.description,
        p1_1.name,
        p1_1.updated_at 
    from
        role_permissions p1_0 
    join
        permissions p1_1 
            on p1_1.id=p1_0.permission_id 
    where
        p1_0.role_id=?
2025-05-25 12:35:13.917 INFO  c.example.iam.security.UserPrincipal - user permissions: []
2025-05-25 12:35:13.919 INFO  c.e.i.s.JwtAuthenticationFilter - username 1: admin
2025-05-25 12:35:13.919 INFO  c.e.i.s.JwtAuthenticationFilter - Required permission 1: []
2025-05-25 12:35:13.919 DEBUG o.s.security.web.FilterChainProxy - Secured GET /users
2025-05-25 12:35:13.929 INFO  c.e.i.s.aspect.PermissionCheckAspect - Required permission: USER_READ
2025-05-25 12:35:13.929 INFO  c.e.i.s.aspect.PermissionCheckAspect - User permissions: []
2025-05-25 12:35:13.930 ERROR c.e.i.e.GlobalExceptionHandler - Access denied: User does not have required permission: USER_READ
2025-05-25 12:35:13.932 INFO  c.e.iam.integration.AuthAndRoleTest - Raw response from /users: Status=403 FORBIDDEN, Body={"status":403,"error":"Access denied","message":"User does not have required permission: USER_READ"}
2025-05-25 12:35:13.938 DEBUG o.s.security.web.FilterChainProxy - Securing GET /users
2025-05-25 12:35:13.940 DEBUG org.hibernate.SQL - 
    select
        t1_0.token_id,
        t1_0.client_id,
        t1_0.created_at,
        t1_0.expired,
        t1_0.expires_at,
        t1_0.revoked,
        t1_0.token,
        t1_0.token_type,
        t1_0.user_id 
    from
        tokens t1_0 
    where
        t1_0.token=?
2025-05-25 12:35:13.946 DEBUG org.hibernate.SQL - 
    select
        u1_0.id,
        u1_0.created_at,
        u1_0.email,
        u1_0.enabled,
        u1_0.full_name,
        u1_0.organization_id,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.username=?
2025-05-25 12:35:13.947 DEBUG org.hibernate.SQL - 
    select
        r1_0.user_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        user_roles r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.user_id=?
2025-05-25 12:35:13.948 INFO  c.example.iam.security.UserPrincipal - user roles: [ROLE_ADMIN]
2025-05-25 12:35:13.948 DEBUG org.hibernate.SQL - 
    select
        p1_0.role_id,
        p1_1.id,
        p1_1.created_at,
        p1_1.description,
        p1_1.name,
        p1_1.updated_at 
    from
        role_permissions p1_0 
    join
        permissions p1_1 
            on p1_1.id=p1_0.permission_id 
    where
        p1_0.role_id=?
2025-05-25 12:35:13.948 INFO  c.example.iam.security.UserPrincipal - user permissions: []
2025-05-25 12:35:13.949 INFO  c.e.i.s.JwtAuthenticationFilter - username 1: admin
2025-05-25 12:35:13.949 INFO  c.e.i.s.JwtAuthenticationFilter - Required permission 1: []
2025-05-25 12:35:13.949 DEBUG o.s.security.web.FilterChainProxy - Secured GET /users
2025-05-25 12:35:13.950 INFO  c.e.i.s.aspect.PermissionCheckAspect - Required permission: USER_READ
2025-05-25 12:35:13.950 INFO  c.e.i.s.aspect.PermissionCheckAspect - User permissions: []
2025-05-25 12:35:13.950 ERROR c.e.i.e.GlobalExceptionHandler - Access denied: User does not have required permission: USER_READ
2025-05-25 12:35:13.952 INFO  c.e.iam.integration.AuthAndRoleTest - Parsed response: Status=403 FORBIDDEN, Body={status=403, error=Access denied, message=User does not have required permission: USER_READ}
2025-05-25 12:35:14.050 INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-05-25 12:35:14.054 INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-05-25 12:35:14.061 DEBUG org.hibernate.SQL - 
    set client_min_messages = WARNING
2025-05-25 12:35:14.062 ERROR o.h.t.s.i.SchemaDropperImpl$DelayedDropActionImpl - HHH000478: Unsuccessful: 
    set client_min_messages = WARNING
2025-05-25 12:35:14.062 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       drop constraint if exists FK21l4ab5xsq7rxwb7b2efptbmt
2025-05-25 12:35:14.063 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       drop constraint if exists FK4glu0kw16kw6gu23yr5q6vjme
2025-05-25 12:35:14.063 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       drop constraint if exists FK3smj35weuy4b1fj396l5jvt6g
2025-05-25 12:35:14.064 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       drop constraint if exists FKacyhrlymxo934q9c4n441dhwf
2025-05-25 12:35:14.064 DEBUG org.hibernate.SQL - 
    alter table if exists policies 
       drop constraint if exists FKs49d98df3xexcyui98cwpek9p
2025-05-25 12:35:14.064 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       drop constraint if exists FKegdk29eiy7mdtefy5c7eirr6e
2025-05-25 12:35:14.065 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       drop constraint if exists FKn5fotdgk8d1xvo8nav9uv3muc
2025-05-25 12:35:14.065 DEBUG org.hibernate.SQL - 
    alter table if exists tokens 
       drop constraint if exists FK2dylsfo39lgjyqml2tbe0b0ss
2025-05-25 12:35:14.065 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       drop constraint if exists FKh8ciramu9cc9q3qcqiv4ue8a6
2025-05-25 12:35:14.066 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       drop constraint if exists FKhfh9dx7w3ubf1co1vdev94g3f
2025-05-25 12:35:14.067 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       drop constraint if exists FK4gc7xv8r1p0j6ykgn5h4nx934
2025-05-25 12:35:14.069 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       drop constraint if exists FKspv2c7f3cxhd1242nkabx95s5
2025-05-25 12:35:14.069 DEBUG org.hibernate.SQL - 
    alter table if exists users 
       drop constraint if exists FKqpugllwvyv37klq7ft9m8aqxk
2025-05-25 12:35:14.070 DEBUG org.hibernate.SQL - 
    drop table if exists client_applications cascade
2025-05-25 12:35:14.071 DEBUG org.hibernate.SQL - 
    drop table if exists client_scopes cascade
2025-05-25 12:35:14.072 DEBUG org.hibernate.SQL - 
    drop table if exists organizations cascade
2025-05-25 12:35:14.073 DEBUG org.hibernate.SQL - 
    drop table if exists permission_scopes cascade
2025-05-25 12:35:14.073 DEBUG org.hibernate.SQL - 
    drop table if exists permissions cascade
2025-05-25 12:35:14.074 DEBUG org.hibernate.SQL - 
    drop table if exists policies cascade
2025-05-25 12:35:14.075 DEBUG org.hibernate.SQL - 
    drop table if exists resources cascade
2025-05-25 12:35:14.076 DEBUG org.hibernate.SQL - 
    drop table if exists role_permissions cascade
2025-05-25 12:35:14.076 DEBUG org.hibernate.SQL - 
    drop table if exists roles cascade
2025-05-25 12:35:14.077 DEBUG org.hibernate.SQL - 
    drop table if exists scopes cascade
2025-05-25 12:35:14.078 DEBUG org.hibernate.SQL - 
    drop table if exists tokens cascade
2025-05-25 12:35:14.078 DEBUG org.hibernate.SQL - 
    drop table if exists user_roles cascade
2025-05-25 12:35:14.079 DEBUG org.hibernate.SQL - 
    drop table if exists user_scopes cascade
2025-05-25 12:35:14.080 DEBUG org.hibernate.SQL - 
    drop table if exists users cascade
2025-05-25 12:35:14.084 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-25 12:35:14.087 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-25 12:38:17.611 INFO  c.e.iam.integration.AuthAndRoleTest - Starting AuthAndRoleTest using Java 21.0.7 with PID 27317 (started by descent in /home/descent/Documents/VDT/vdt5-iam-system/iam-service)
2025-05-25 12:38:17.612 DEBUG c.e.iam.integration.AuthAndRoleTest - Running with Spring Boot v3.4.5, Spring v6.2.6
2025-05-25 12:38:17.613 INFO  c.e.iam.integration.AuthAndRoleTest - The following 1 profile is active: "test"
2025-05-25 12:38:18.591 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-05-25 12:38:18.701 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 99 ms. Found 9 JPA repository interfaces.
2025-05-25 12:38:19.948 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 0 (http)
2025-05-25 12:38:19.968 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-25 12:38:19.968 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.40]
2025-05-25 12:38:20.035 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-25 12:38:20.036 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2404 ms
2025-05-25 12:38:20.782 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-25 12:38:21.082 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:testdb user=SA
2025-05-25 12:38:21.087 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-25 12:38:22.528 DEBUG org.hibernate.SQL - 
    set client_min_messages = WARNING
2025-05-25 12:38:22.535 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       drop constraint if exists FK21l4ab5xsq7rxwb7b2efptbmt
2025-05-25 12:38:22.536 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       drop constraint if exists FK4glu0kw16kw6gu23yr5q6vjme
2025-05-25 12:38:22.537 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       drop constraint if exists FK3smj35weuy4b1fj396l5jvt6g
2025-05-25 12:38:22.537 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       drop constraint if exists FKacyhrlymxo934q9c4n441dhwf
2025-05-25 12:38:22.538 DEBUG org.hibernate.SQL - 
    alter table if exists policies 
       drop constraint if exists FKs49d98df3xexcyui98cwpek9p
2025-05-25 12:38:22.538 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       drop constraint if exists FKegdk29eiy7mdtefy5c7eirr6e
2025-05-25 12:38:22.539 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       drop constraint if exists FKn5fotdgk8d1xvo8nav9uv3muc
2025-05-25 12:38:22.539 DEBUG org.hibernate.SQL - 
    alter table if exists tokens 
       drop constraint if exists FK2dylsfo39lgjyqml2tbe0b0ss
2025-05-25 12:38:22.540 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       drop constraint if exists FKh8ciramu9cc9q3qcqiv4ue8a6
2025-05-25 12:38:22.540 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       drop constraint if exists FKhfh9dx7w3ubf1co1vdev94g3f
2025-05-25 12:38:22.541 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       drop constraint if exists FK4gc7xv8r1p0j6ykgn5h4nx934
2025-05-25 12:38:22.542 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       drop constraint if exists FKspv2c7f3cxhd1242nkabx95s5
2025-05-25 12:38:22.542 DEBUG org.hibernate.SQL - 
    alter table if exists users 
       drop constraint if exists FKqpugllwvyv37klq7ft9m8aqxk
2025-05-25 12:38:22.543 DEBUG org.hibernate.SQL - 
    drop table if exists client_applications cascade
2025-05-25 12:38:22.544 DEBUG org.hibernate.SQL - 
    drop table if exists client_scopes cascade
2025-05-25 12:38:22.544 DEBUG org.hibernate.SQL - 
    drop table if exists organizations cascade
2025-05-25 12:38:22.545 DEBUG org.hibernate.SQL - 
    drop table if exists permission_scopes cascade
2025-05-25 12:38:22.545 DEBUG org.hibernate.SQL - 
    drop table if exists permissions cascade
2025-05-25 12:38:22.545 DEBUG org.hibernate.SQL - 
    drop table if exists policies cascade
2025-05-25 12:38:22.546 DEBUG org.hibernate.SQL - 
    drop table if exists resources cascade
2025-05-25 12:38:22.546 DEBUG org.hibernate.SQL - 
    drop table if exists role_permissions cascade
2025-05-25 12:38:22.546 DEBUG org.hibernate.SQL - 
    drop table if exists roles cascade
2025-05-25 12:38:22.547 DEBUG org.hibernate.SQL - 
    drop table if exists scopes cascade
2025-05-25 12:38:22.547 DEBUG org.hibernate.SQL - 
    drop table if exists tokens cascade
2025-05-25 12:38:22.547 DEBUG org.hibernate.SQL - 
    drop table if exists user_roles cascade
2025-05-25 12:38:22.548 DEBUG org.hibernate.SQL - 
    drop table if exists user_scopes cascade
2025-05-25 12:38:22.548 DEBUG org.hibernate.SQL - 
    drop table if exists users cascade
2025-05-25 12:38:22.556 DEBUG org.hibernate.SQL - 
    create table client_applications (
        is_active boolean,
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        client_id varchar(100) not null unique,
        name varchar(100) not null,
        client_secret varchar(255) not null,
        description TEXT,
        redirect_uri varchar(255),
        primary key (id)
    )
2025-05-25 12:38:22.572 DEBUG org.hibernate.SQL - 
    create table client_scopes (
        client_id bigint not null,
        scope_id bigint not null,
        primary key (client_id, scope_id)
    )
2025-05-25 12:38:22.574 DEBUG org.hibernate.SQL - 
    create table organizations (
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        description varchar(1000),
        name varchar(255) not null unique,
        primary key (id)
    )
2025-05-25 12:38:22.577 DEBUG org.hibernate.SQL - 
    create table permission_scopes (
        permission_id bigint not null,
        scope_id bigint not null,
        primary key (permission_id, scope_id)
    )
2025-05-25 12:38:22.579 DEBUG org.hibernate.SQL - 
    create table permissions (
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        name varchar(100) not null unique,
        description TEXT,
        primary key (id)
    )
2025-05-25 12:38:22.583 DEBUG org.hibernate.SQL - 
    create table policies (
        subject_type smallint not null check (subject_type between 0 and 3),
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        resource_id bigint not null,
        subject_id bigint not null,
        updated_at timestamp(6) not null,
        action varchar(255) not null,
        condition_json TEXT,
        effect varchar(255) not null check (effect in ('ALLOW','DENY')),
        primary key (id)
    )
2025-05-25 12:38:22.595 DEBUG org.hibernate.SQL - 
    create table resources (
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        name varchar(100) not null,
        description TEXT,
        http_method varchar(255) not null check (http_method in ('GET','POST','PUT','DELETE','PATCH','HEAD','OPTIONS')),
        path varchar(255) not null,
        primary key (id)
    )
2025-05-25 12:38:22.597 DEBUG org.hibernate.SQL - 
    create table role_permissions (
        permission_id bigint not null,
        role_id bigint not null,
        primary key (permission_id, role_id)
    )
2025-05-25 12:38:22.599 DEBUG org.hibernate.SQL - 
    create table roles (
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        name varchar(50) not null unique,
        description TEXT,
        primary key (id)
    )
2025-05-25 12:38:22.605 DEBUG org.hibernate.SQL - 
    create table scopes (
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        name varchar(100) not null unique,
        description TEXT,
        primary key (id)
    )
2025-05-25 12:38:22.610 DEBUG org.hibernate.SQL - 
    create table tokens (
        expired boolean not null,
        revoked boolean not null,
        created_at timestamp(6) not null,
        expires_at timestamp(6) not null,
        token_id bigint generated by default as identity,
        user_id bigint,
        client_id varchar(255),
        token TEXT not null,
        token_type varchar(255) not null check (token_type in ('ACCESS','REFRESH')),
        primary key (token_id)
    )
2025-05-25 12:38:22.613 DEBUG org.hibernate.SQL - 
    create table user_roles (
        role_id bigint not null,
        user_id bigint not null,
        primary key (role_id, user_id)
    )
2025-05-25 12:38:22.616 DEBUG org.hibernate.SQL - 
    create table user_scopes (
        scope_id bigint not null,
        user_id bigint not null,
        primary key (scope_id, user_id)
    )
2025-05-25 12:38:22.621 DEBUG org.hibernate.SQL - 
    create table users (
        enabled boolean not null,
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        organization_id bigint,
        updated_at timestamp(6) not null,
        username varchar(50) not null unique,
        password varchar(100) not null,
        email varchar(255) not null unique,
        full_name varchar(255),
        primary key (id)
    )
2025-05-25 12:38:22.625 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       add constraint FK21l4ab5xsq7rxwb7b2efptbmt 
       foreign key (scope_id) 
       references scopes
2025-05-25 12:38:22.642 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       add constraint FK4glu0kw16kw6gu23yr5q6vjme 
       foreign key (client_id) 
       references client_applications
2025-05-25 12:38:22.644 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       add constraint FK3smj35weuy4b1fj396l5jvt6g 
       foreign key (scope_id) 
       references scopes
2025-05-25 12:38:22.646 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       add constraint FKacyhrlymxo934q9c4n441dhwf 
       foreign key (permission_id) 
       references permissions
2025-05-25 12:38:22.650 DEBUG org.hibernate.SQL - 
    alter table if exists policies 
       add constraint FKs49d98df3xexcyui98cwpek9p 
       foreign key (resource_id) 
       references resources
2025-05-25 12:38:22.655 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       add constraint FKegdk29eiy7mdtefy5c7eirr6e 
       foreign key (permission_id) 
       references permissions
2025-05-25 12:38:22.659 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       add constraint FKn5fotdgk8d1xvo8nav9uv3muc 
       foreign key (role_id) 
       references roles
2025-05-25 12:38:22.661 DEBUG org.hibernate.SQL - 
    alter table if exists tokens 
       add constraint FK2dylsfo39lgjyqml2tbe0b0ss 
       foreign key (user_id) 
       references users
2025-05-25 12:38:22.663 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       add constraint FKh8ciramu9cc9q3qcqiv4ue8a6 
       foreign key (role_id) 
       references roles
2025-05-25 12:38:22.668 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       add constraint FKhfh9dx7w3ubf1co1vdev94g3f 
       foreign key (user_id) 
       references users
2025-05-25 12:38:22.671 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       add constraint FK4gc7xv8r1p0j6ykgn5h4nx934 
       foreign key (scope_id) 
       references scopes
2025-05-25 12:38:22.673 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       add constraint FKspv2c7f3cxhd1242nkabx95s5 
       foreign key (user_id) 
       references users
2025-05-25 12:38:22.676 DEBUG org.hibernate.SQL - 
    alter table if exists users 
       add constraint FKqpugllwvyv37klq7ft9m8aqxk 
       foreign key (organization_id) 
       references organizations
2025-05-25 12:38:23.416 DEBUG c.e.i.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-05-25 12:38:23.516 INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name customUserDetailsService
2025-05-25 12:38:24.078 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.name,
        r1_0.updated_at 
    from
        roles r1_0 
    where
        r1_0.name=?
2025-05-25 12:38:24.190 DEBUG org.hibernate.SQL - 
    insert 
    into
        roles
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:38:24.223 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0
2025-05-25 12:38:24.233 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.name,
        p1_0.role_id,
        p1_1.id,
        p1_1.created_at,
        p1_1.description,
        p1_1.name,
        p1_1.updated_at,
        r1_0.updated_at 
    from
        roles r1_0 
    left join
        role_permissions p1_0 
            on r1_0.id=p1_0.role_id 
    left join
        permissions p1_1 
            on p1_1.id=p1_0.permission_id 
    where
        r1_0.id=?
2025-05-25 12:38:24.240 DEBUG org.hibernate.SQL - 
    select
        u1_0.role_id,
        u1_1.id,
        u1_1.created_at,
        u1_1.email,
        u1_1.enabled,
        u1_1.full_name,
        u1_1.organization_id,
        u1_1.password,
        u1_1.updated_at,
        u1_1.username 
    from
        user_roles u1_0 
    join
        users u1_1 
            on u1_1.id=u1_0.user_id 
    where
        u1_0.role_id=?
2025-05-25 12:38:24.249 DEBUG org.hibernate.SQL - 
    update
        roles 
    set
        description=?,
        name=?,
        updated_at=? 
    where
        id=?
2025-05-25 12:38:24.254 INFO  c.e.i.s.AdminInitializationService - Updated admin role with 0 permissions
2025-05-25 12:38:24.256 DEBUG org.hibernate.SQL - 
    select
        u1_0.id,
        u1_0.created_at,
        u1_0.email,
        u1_0.enabled,
        u1_0.full_name,
        u1_0.organization_id,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.username=?
2025-05-25 12:38:24.385 DEBUG org.hibernate.SQL - 
    insert 
    into
        users
        (created_at, email, enabled, full_name, organization_id, password, updated_at, username) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?)
2025-05-25 12:38:24.388 DEBUG org.hibernate.SQL - 
    insert 
    into
        user_roles
        (user_id, role_id) 
    values
        (?, ?)
2025-05-25 12:38:24.390 INFO  c.e.i.s.AdminInitializationService - Created admin user with username: admin
2025-05-25 12:38:24.541 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-05-25 12:38:24.709 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:38:24.713 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:38:24.717 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ORGANIZATION_UPDATE
2025-05-25 12:38:24.720 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:38:24.722 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:38:24.725 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ROLE_READ
2025-05-25 12:38:24.726 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:38:24.728 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:38:24.731 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: USER_DELETE
2025-05-25 12:38:24.733 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:38:24.738 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:38:24.741 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: POLICY_UPDATE
2025-05-25 12:38:24.742 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:38:24.744 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:38:24.747 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: USER_UPDATE
2025-05-25 12:38:24.750 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:38:24.754 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:38:24.755 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: USER_READ
2025-05-25 12:38:24.757 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:38:24.758 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:38:24.759 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: RESOURCE_READ
2025-05-25 12:38:24.761 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:38:24.762 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:38:24.764 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: SCOPE_CREATE
2025-05-25 12:38:24.767 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:38:24.770 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:38:24.773 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ORGANIZATION_READ
2025-05-25 12:38:24.775 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:38:24.777 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:38:24.779 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: POLICY_CREATE
2025-05-25 12:38:24.783 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:38:24.785 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:38:24.788 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ORGANIZATION_CREATE
2025-05-25 12:38:24.791 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:38:24.792 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:38:24.794 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: POLICY_READ
2025-05-25 12:38:24.796 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:38:24.799 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:38:24.802 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: CLIENT_CREATE
2025-05-25 12:38:24.804 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:38:24.807 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:38:24.809 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ROLE_CREATE
2025-05-25 12:38:24.810 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:38:24.813 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:38:24.816 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: RESOURCE_DELETE
2025-05-25 12:38:24.819 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:38:24.821 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:38:24.822 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: SCOPE_DELETE
2025-05-25 12:38:24.824 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:38:24.826 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:38:24.827 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:38:24.829 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ROLE_DELETE
2025-05-25 12:38:24.831 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:38:24.834 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:38:24.836 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: SCOPE_READ
2025-05-25 12:38:24.837 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:38:24.839 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:38:24.841 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: RESOURCE_UPDATE
2025-05-25 12:38:24.842 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:38:24.843 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:38:24.845 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: SCOPE_UPDATE
2025-05-25 12:38:24.848 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:38:24.850 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:38:24.852 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ROLE_UPDATE
2025-05-25 12:38:24.855 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:38:24.857 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:38:24.860 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:38:24.861 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:38:24.863 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: RESOURCE_CREATE
2025-05-25 12:38:24.864 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:38:24.867 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:38:24.868 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:38:24.870 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ORGANIZATION_DELETE
2025-05-25 12:38:24.872 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:38:24.875 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:38:24.876 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:38:24.878 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: POLICY_DELETE
2025-05-25 12:38:24.880 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:38:25.187 DEBUG o.s.s.web.DefaultSecurityFilterChain - Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, LogoutFilter, JwtAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, SessionManagementFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-05-25 12:38:25.598 INFO  o.s.b.a.h.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:testdb'
2025-05-25 12:38:25.919 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 42223 (http) with context path '/'
2025-05-25 12:38:25.936 INFO  c.e.iam.integration.AuthAndRoleTest - Started AuthAndRoleTest in 8.876 seconds (process running for 10.151)
2025-05-25 12:38:26.492 DEBUG org.hibernate.SQL - 
    select
        u1_0.id,
        u1_0.created_at,
        u1_0.email,
        u1_0.enabled,
        u1_0.full_name,
        u1_0.organization_id,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0
2025-05-25 12:38:26.501 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.name,
        r1_0.updated_at 
    from
        roles r1_0
2025-05-25 12:38:26.503 DEBUG org.hibernate.SQL - 
    select
        p1_0.role_id,
        p1_1.id,
        p1_1.created_at,
        p1_1.description,
        p1_1.name,
        p1_1.updated_at 
    from
        role_permissions p1_0 
    join
        permissions p1_1 
            on p1_1.id=p1_0.permission_id 
    where
        p1_0.role_id=?
2025-05-25 12:38:26.505 DEBUG org.hibernate.SQL - 
    select
        u1_0.role_id,
        u1_1.id,
        u1_1.created_at,
        u1_1.email,
        u1_1.enabled,
        u1_1.full_name,
        u1_1.organization_id,
        u1_1.password,
        u1_1.updated_at,
        u1_1.username 
    from
        user_roles u1_0 
    join
        users u1_1 
            on u1_1.id=u1_0.user_id 
    where
        u1_0.role_id=?
2025-05-25 12:38:26.509 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0
2025-05-25 12:38:26.517 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:38:26.519 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:38:26.520 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:38:26.521 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:38:26.522 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:38:26.522 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:38:26.523 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:38:26.523 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:38:26.524 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:38:26.525 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:38:26.525 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:38:26.526 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:38:26.526 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:38:26.527 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:38:26.527 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:38:26.528 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:38:26.528 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:38:26.529 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:38:26.530 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:38:26.531 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:38:26.532 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:38:26.532 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:38:26.533 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:38:26.534 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:38:26.535 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:38:26.535 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:38:26.536 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:38:26.537 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:38:26.538 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:38:26.539 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:38:26.540 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:38:26.541 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:38:26.542 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:38:26.542 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:38:26.543 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:38:26.544 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:38:26.546 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:38:26.547 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:38:26.547 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:38:26.548 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:38:26.548 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:38:26.549 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:38:26.549 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:38:26.550 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:38:26.551 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:38:26.552 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:38:26.554 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:38:26.554 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:38:26.557 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.http_method,
        r1_0.name,
        r1_0.path,
        r1_0.updated_at 
    from
        resources r1_0
2025-05-25 12:38:26.560 DEBUG org.hibernate.SQL - 
    delete 
    from
        user_roles 
    where
        user_id=?
2025-05-25 12:38:26.562 DEBUG org.hibernate.SQL - 
    delete 
    from
        user_scopes 
    where
        user_id=?
2025-05-25 12:38:26.563 DEBUG org.hibernate.SQL - 
    delete 
    from
        users 
    where
        id=?
2025-05-25 12:38:26.566 DEBUG org.hibernate.SQL - 
    delete 
    from
        roles 
    where
        id=?
2025-05-25 12:38:26.567 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:38:26.568 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:38:26.569 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:38:26.569 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:38:26.570 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:38:26.571 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:38:26.571 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:38:26.573 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:38:26.574 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:38:26.574 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:38:26.575 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:38:26.575 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:38:26.576 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:38:26.577 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:38:26.577 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:38:26.578 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:38:26.579 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:38:26.580 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:38:26.580 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:38:26.581 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:38:26.581 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:38:26.582 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:38:26.582 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:38:26.583 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:38:26.585 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:38:26.588 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:38:26.591 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:38:26.593 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:38:26.597 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:38:26.600 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:38:26.604 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:38:26.607 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:38:26.612 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:38:26.617 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:38:26.622 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:38:26.624 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:38:26.628 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:38:26.631 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:38:26.637 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:38:26.638 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:38:26.642 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:38:26.643 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:38:26.648 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:38:26.650 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:38:26.654 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:38:26.656 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:38:26.659 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:38:26.660 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:38:26.663 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:38:26.665 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:38:26.669 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:38:26.671 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:38:26.674 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:38:26.676 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:38:26.680 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:38:26.682 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:38:26.685 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:38:26.687 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:38:27.115 DEBUG org.hibernate.SQL - 
    select
        count(*) 
    from
        permissions p1_0
2025-05-25 12:38:27.116 INFO  c.e.iam.integration.AuthAndRoleTest - Permissions created. Total permissions: 17
2025-05-25 12:38:27.119 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.name,
        r1_0.updated_at 
    from
        roles r1_0 
    where
        r1_0.name=?
2025-05-25 12:38:27.122 DEBUG org.hibernate.SQL - 
    insert 
    into
        roles
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:38:27.124 INFO  c.e.iam.integration.AuthAndRoleTest - Admin role permissions: [ROLE_UPDATE, USER_READ, SCOPE_CREATE, SCOPE_UPDATE, RESOURCE_UPDATE, ROLE_DELETE, SCOPE_DELETE, RESOURCE_DELETE, RESOURCE_CREATE, ORGANIZATION_UPDATE, POLICY_DELETE, ORGANIZATION_DELETE, ROLE_CREATE, ORGANIZATION_READ, POLICY_READ, ORGANIZATION_CREATE, POLICY_CREATE]
2025-05-25 12:38:27.127 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.name,
        r1_0.updated_at 
    from
        roles r1_0 
    where
        r1_0.name=?
2025-05-25 12:38:27.129 DEBUG org.hibernate.SQL - 
    insert 
    into
        roles
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:38:27.132 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.name,
        r1_0.updated_at 
    from
        roles r1_0 
    where
        r1_0.name=?
2025-05-25 12:38:27.133 DEBUG org.hibernate.SQL - 
    insert 
    into
        roles
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:38:27.135 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:38:27.136 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:38:27.136 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:38:27.137 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:38:27.137 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:38:27.138 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:38:27.138 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:38:27.139 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:38:27.139 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:38:27.139 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:38:27.140 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:38:27.140 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:38:27.141 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:38:27.141 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:38:27.141 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:38:27.142 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:38:27.142 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:38:27.143 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:38:27.143 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:38:27.143 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:38:27.144 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:38:27.144 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:38:27.145 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:38:27.146 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:38:27.146 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:38:27.252 DEBUG org.hibernate.SQL - 
    insert 
    into
        users
        (created_at, email, enabled, full_name, organization_id, password, updated_at, username) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?)
2025-05-25 12:38:27.349 DEBUG org.hibernate.SQL - 
    insert 
    into
        users
        (created_at, email, enabled, full_name, organization_id, password, updated_at, username) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?)
2025-05-25 12:38:27.441 DEBUG org.hibernate.SQL - 
    insert 
    into
        users
        (created_at, email, enabled, full_name, organization_id, password, updated_at, username) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?)
2025-05-25 12:38:27.443 DEBUG org.hibernate.SQL - 
    insert 
    into
        user_roles
        (user_id, role_id) 
    values
        (?, ?)
2025-05-25 12:38:27.444 DEBUG org.hibernate.SQL - 
    insert 
    into
        user_roles
        (user_id, role_id) 
    values
        (?, ?)
2025-05-25 12:38:27.444 DEBUG org.hibernate.SQL - 
    insert 
    into
        user_roles
        (user_id, role_id) 
    values
        (?, ?)
2025-05-25 12:38:27.602 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-05-25 12:38:27.602 INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-05-25 12:38:27.603 INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-05-25 12:38:27.617 DEBUG o.s.security.web.FilterChainProxy - Securing POST /auth/login
2025-05-25 12:38:27.621 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-05-25 12:38:27.622 DEBUG o.s.security.web.FilterChainProxy - Secured POST /auth/login
2025-05-25 12:38:27.764 DEBUG org.hibernate.SQL - 
    select
        u1_0.id,
        u1_0.created_at,
        u1_0.email,
        u1_0.enabled,
        u1_0.full_name,
        u1_0.organization_id,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.username=?
2025-05-25 12:38:27.767 DEBUG org.hibernate.SQL - 
    select
        r1_0.user_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        user_roles r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.user_id=?
2025-05-25 12:38:27.768 INFO  c.example.iam.security.UserPrincipal - user roles: [ROLE_ADMIN]
2025-05-25 12:38:27.769 DEBUG org.hibernate.SQL - 
    select
        p1_0.role_id,
        p1_1.id,
        p1_1.created_at,
        p1_1.description,
        p1_1.name,
        p1_1.updated_at 
    from
        role_permissions p1_0 
    join
        permissions p1_1 
            on p1_1.id=p1_0.permission_id 
    where
        p1_0.role_id=?
2025-05-25 12:38:27.771 INFO  c.example.iam.security.UserPrincipal - Permissions for role ROLE_ADMIN: []
2025-05-25 12:38:27.772 INFO  c.example.iam.security.UserPrincipal - Final user permissions: []
2025-05-25 12:38:27.864 DEBUG o.s.s.a.d.DaoAuthenticationProvider - Authenticated user
2025-05-25 12:38:27.891 DEBUG org.hibernate.SQL - 
    insert 
    into
        tokens
        (client_id, created_at, expired, expires_at, revoked, token, token_type, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?)
2025-05-25 12:38:27.896 DEBUG org.hibernate.SQL - 
    insert 
    into
        tokens
        (client_id, created_at, expired, expires_at, revoked, token, token_type, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?)
2025-05-25 12:38:27.941 DEBUG o.s.security.web.FilterChainProxy - Securing POST /auth/login
2025-05-25 12:38:27.941 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-05-25 12:38:27.942 DEBUG o.s.security.web.FilterChainProxy - Secured POST /auth/login
2025-05-25 12:38:27.946 DEBUG org.hibernate.SQL - 
    select
        u1_0.id,
        u1_0.created_at,
        u1_0.email,
        u1_0.enabled,
        u1_0.full_name,
        u1_0.organization_id,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.username=?
2025-05-25 12:38:27.949 DEBUG org.hibernate.SQL - 
    select
        ca1_0.id,
        ca1_0.is_active,
        ca1_0.client_id,
        ca1_0.client_secret,
        ca1_0.created_at,
        ca1_0.description,
        ca1_0.name,
        ca1_0.redirect_uri,
        ca1_0.updated_at 
    from
        client_applications ca1_0 
    where
        ca1_0.client_id=?
2025-05-25 12:38:28.044 DEBUG o.s.s.a.d.DaoAuthenticationProvider - Failed to find user 'manager'
2025-05-25 12:38:28.050 ERROR c.e.i.e.GlobalExceptionHandler - Invalid credentials: Bad credentials
2025-05-25 12:38:28.061 DEBUG o.s.security.web.FilterChainProxy - Securing POST /auth/login
2025-05-25 12:38:28.062 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-05-25 12:38:28.062 DEBUG o.s.security.web.FilterChainProxy - Secured POST /auth/login
2025-05-25 12:38:28.065 DEBUG org.hibernate.SQL - 
    select
        u1_0.id,
        u1_0.created_at,
        u1_0.email,
        u1_0.enabled,
        u1_0.full_name,
        u1_0.organization_id,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.username=?
2025-05-25 12:38:28.068 DEBUG org.hibernate.SQL - 
    select
        ca1_0.id,
        ca1_0.is_active,
        ca1_0.client_id,
        ca1_0.client_secret,
        ca1_0.created_at,
        ca1_0.description,
        ca1_0.name,
        ca1_0.redirect_uri,
        ca1_0.updated_at 
    from
        client_applications ca1_0 
    where
        ca1_0.client_id=?
2025-05-25 12:38:28.158 DEBUG o.s.s.a.d.DaoAuthenticationProvider - Failed to find user 'user'
2025-05-25 12:38:28.160 ERROR c.e.i.e.GlobalExceptionHandler - Invalid credentials: Bad credentials
2025-05-25 12:38:28.165 INFO  c.e.iam.integration.AuthAndRoleTest - Testing /users endpoint with admin token: eyJhbGciOiJIUzI1NiJ9.eyJ0eXBlIjoidXNlciIsInVzZXJuYW1lIjoiYWRtaW4iLCJzdWIiOiJhZG1pbiIsImlhdCI6MTc0ODE2NTkwNywiZXhwIjoxNzQ4MTY5NTA3fQ.rLb-Gc3JWxea6qhXdrO1qGfTLHzfjpEjuWsLOnSUOnE
2025-05-25 12:38:28.168 DEBUG o.s.security.web.FilterChainProxy - Securing GET /users
2025-05-25 12:38:28.170 DEBUG org.hibernate.SQL - 
    select
        t1_0.token_id,
        t1_0.client_id,
        t1_0.created_at,
        t1_0.expired,
        t1_0.expires_at,
        t1_0.revoked,
        t1_0.token,
        t1_0.token_type,
        t1_0.user_id 
    from
        tokens t1_0 
    where
        t1_0.token=?
2025-05-25 12:38:28.196 DEBUG org.hibernate.SQL - 
    select
        u1_0.id,
        u1_0.created_at,
        u1_0.email,
        u1_0.enabled,
        u1_0.full_name,
        u1_0.organization_id,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.username=?
2025-05-25 12:38:28.199 DEBUG org.hibernate.SQL - 
    select
        r1_0.user_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        user_roles r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.user_id=?
2025-05-25 12:38:28.201 INFO  c.example.iam.security.UserPrincipal - user roles: [ROLE_ADMIN]
2025-05-25 12:38:28.201 DEBUG org.hibernate.SQL - 
    select
        p1_0.role_id,
        p1_1.id,
        p1_1.created_at,
        p1_1.description,
        p1_1.name,
        p1_1.updated_at 
    from
        role_permissions p1_0 
    join
        permissions p1_1 
            on p1_1.id=p1_0.permission_id 
    where
        p1_0.role_id=?
2025-05-25 12:38:28.203 INFO  c.example.iam.security.UserPrincipal - Permissions for role ROLE_ADMIN: []
2025-05-25 12:38:28.203 INFO  c.example.iam.security.UserPrincipal - Final user permissions: []
2025-05-25 12:38:28.205 INFO  c.e.i.s.JwtAuthenticationFilter - username 1: admin
2025-05-25 12:38:28.205 INFO  c.e.i.s.JwtAuthenticationFilter - Required permission 1: []
2025-05-25 12:38:28.206 DEBUG o.s.security.web.FilterChainProxy - Secured GET /users
2025-05-25 12:38:28.217 INFO  c.e.i.s.aspect.PermissionCheckAspect - Required permission: USER_READ
2025-05-25 12:38:28.217 INFO  c.e.i.s.aspect.PermissionCheckAspect - User permissions: []
2025-05-25 12:38:28.218 ERROR c.e.i.e.GlobalExceptionHandler - Access denied: User does not have required permission: USER_READ
2025-05-25 12:38:28.221 INFO  c.e.iam.integration.AuthAndRoleTest - Raw response from /users: Status=403 FORBIDDEN, Body={"status":403,"error":"Access denied","message":"User does not have required permission: USER_READ"}
2025-05-25 12:38:28.224 DEBUG o.s.security.web.FilterChainProxy - Securing GET /users
2025-05-25 12:38:28.225 DEBUG org.hibernate.SQL - 
    select
        t1_0.token_id,
        t1_0.client_id,
        t1_0.created_at,
        t1_0.expired,
        t1_0.expires_at,
        t1_0.revoked,
        t1_0.token,
        t1_0.token_type,
        t1_0.user_id 
    from
        tokens t1_0 
    where
        t1_0.token=?
2025-05-25 12:38:28.239 DEBUG org.hibernate.SQL - 
    select
        u1_0.id,
        u1_0.created_at,
        u1_0.email,
        u1_0.enabled,
        u1_0.full_name,
        u1_0.organization_id,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.username=?
2025-05-25 12:38:28.240 DEBUG org.hibernate.SQL - 
    select
        r1_0.user_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        user_roles r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.user_id=?
2025-05-25 12:38:28.241 INFO  c.example.iam.security.UserPrincipal - user roles: [ROLE_ADMIN]
2025-05-25 12:38:28.241 DEBUG org.hibernate.SQL - 
    select
        p1_0.role_id,
        p1_1.id,
        p1_1.created_at,
        p1_1.description,
        p1_1.name,
        p1_1.updated_at 
    from
        role_permissions p1_0 
    join
        permissions p1_1 
            on p1_1.id=p1_0.permission_id 
    where
        p1_0.role_id=?
2025-05-25 12:38:28.241 INFO  c.example.iam.security.UserPrincipal - Permissions for role ROLE_ADMIN: []
2025-05-25 12:38:28.241 INFO  c.example.iam.security.UserPrincipal - Final user permissions: []
2025-05-25 12:38:28.241 INFO  c.e.i.s.JwtAuthenticationFilter - username 1: admin
2025-05-25 12:38:28.241 INFO  c.e.i.s.JwtAuthenticationFilter - Required permission 1: []
2025-05-25 12:38:28.242 DEBUG o.s.security.web.FilterChainProxy - Secured GET /users
2025-05-25 12:38:28.242 INFO  c.e.i.s.aspect.PermissionCheckAspect - Required permission: USER_READ
2025-05-25 12:38:28.242 INFO  c.e.i.s.aspect.PermissionCheckAspect - User permissions: []
2025-05-25 12:38:28.243 ERROR c.e.i.e.GlobalExceptionHandler - Access denied: User does not have required permission: USER_READ
2025-05-25 12:38:28.246 INFO  c.e.iam.integration.AuthAndRoleTest - Parsed response: Status=403 FORBIDDEN, Body={status=403, error=Access denied, message=User does not have required permission: USER_READ}
2025-05-25 12:38:28.355 INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-05-25 12:38:28.359 INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-05-25 12:38:28.369 DEBUG org.hibernate.SQL - 
    set client_min_messages = WARNING
2025-05-25 12:38:28.370 ERROR o.h.t.s.i.SchemaDropperImpl$DelayedDropActionImpl - HHH000478: Unsuccessful: 
    set client_min_messages = WARNING
2025-05-25 12:38:28.370 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       drop constraint if exists FK21l4ab5xsq7rxwb7b2efptbmt
2025-05-25 12:38:28.371 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       drop constraint if exists FK4glu0kw16kw6gu23yr5q6vjme
2025-05-25 12:38:28.371 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       drop constraint if exists FK3smj35weuy4b1fj396l5jvt6g
2025-05-25 12:38:28.372 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       drop constraint if exists FKacyhrlymxo934q9c4n441dhwf
2025-05-25 12:38:28.372 DEBUG org.hibernate.SQL - 
    alter table if exists policies 
       drop constraint if exists FKs49d98df3xexcyui98cwpek9p
2025-05-25 12:38:28.372 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       drop constraint if exists FKegdk29eiy7mdtefy5c7eirr6e
2025-05-25 12:38:28.373 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       drop constraint if exists FKn5fotdgk8d1xvo8nav9uv3muc
2025-05-25 12:38:28.374 DEBUG org.hibernate.SQL - 
    alter table if exists tokens 
       drop constraint if exists FK2dylsfo39lgjyqml2tbe0b0ss
2025-05-25 12:38:28.374 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       drop constraint if exists FKh8ciramu9cc9q3qcqiv4ue8a6
2025-05-25 12:38:28.375 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       drop constraint if exists FKhfh9dx7w3ubf1co1vdev94g3f
2025-05-25 12:38:28.375 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       drop constraint if exists FK4gc7xv8r1p0j6ykgn5h4nx934
2025-05-25 12:38:28.375 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       drop constraint if exists FKspv2c7f3cxhd1242nkabx95s5
2025-05-25 12:38:28.376 DEBUG org.hibernate.SQL - 
    alter table if exists users 
       drop constraint if exists FKqpugllwvyv37klq7ft9m8aqxk
2025-05-25 12:38:28.377 DEBUG org.hibernate.SQL - 
    drop table if exists client_applications cascade
2025-05-25 12:38:28.380 DEBUG org.hibernate.SQL - 
    drop table if exists client_scopes cascade
2025-05-25 12:38:28.381 DEBUG org.hibernate.SQL - 
    drop table if exists organizations cascade
2025-05-25 12:38:28.382 DEBUG org.hibernate.SQL - 
    drop table if exists permission_scopes cascade
2025-05-25 12:38:28.383 DEBUG org.hibernate.SQL - 
    drop table if exists permissions cascade
2025-05-25 12:38:28.384 DEBUG org.hibernate.SQL - 
    drop table if exists policies cascade
2025-05-25 12:38:28.385 DEBUG org.hibernate.SQL - 
    drop table if exists resources cascade
2025-05-25 12:38:28.386 DEBUG org.hibernate.SQL - 
    drop table if exists role_permissions cascade
2025-05-25 12:38:28.387 DEBUG org.hibernate.SQL - 
    drop table if exists roles cascade
2025-05-25 12:38:28.387 DEBUG org.hibernate.SQL - 
    drop table if exists scopes cascade
2025-05-25 12:38:28.387 DEBUG org.hibernate.SQL - 
    drop table if exists tokens cascade
2025-05-25 12:38:28.388 DEBUG org.hibernate.SQL - 
    drop table if exists user_roles cascade
2025-05-25 12:38:28.388 DEBUG org.hibernate.SQL - 
    drop table if exists user_scopes cascade
2025-05-25 12:38:28.389 DEBUG org.hibernate.SQL - 
    drop table if exists users cascade
2025-05-25 12:38:28.391 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-25 12:38:28.393 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-25 12:39:28.719 INFO  c.e.iam.integration.AuthAndRoleTest - Starting AuthAndRoleTest using Java 21.0.7 with PID 28252 (started by descent in /home/descent/Documents/VDT/vdt5-iam-system/iam-service)
2025-05-25 12:39:28.720 DEBUG c.e.iam.integration.AuthAndRoleTest - Running with Spring Boot v3.4.5, Spring v6.2.6
2025-05-25 12:39:28.721 INFO  c.e.iam.integration.AuthAndRoleTest - The following 1 profile is active: "test"
2025-05-25 12:39:29.805 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-05-25 12:39:29.921 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 101 ms. Found 9 JPA repository interfaces.
2025-05-25 12:39:30.920 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 0 (http)
2025-05-25 12:39:30.936 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-25 12:39:30.936 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.40]
2025-05-25 12:39:30.991 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-25 12:39:30.992 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2251 ms
2025-05-25 12:39:31.628 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-25 12:39:31.842 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:testdb user=SA
2025-05-25 12:39:31.844 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-25 12:39:33.160 DEBUG org.hibernate.SQL - 
    set client_min_messages = WARNING
2025-05-25 12:39:33.165 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       drop constraint if exists FK21l4ab5xsq7rxwb7b2efptbmt
2025-05-25 12:39:33.166 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       drop constraint if exists FK4glu0kw16kw6gu23yr5q6vjme
2025-05-25 12:39:33.166 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       drop constraint if exists FK3smj35weuy4b1fj396l5jvt6g
2025-05-25 12:39:33.167 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       drop constraint if exists FKacyhrlymxo934q9c4n441dhwf
2025-05-25 12:39:33.167 DEBUG org.hibernate.SQL - 
    alter table if exists policies 
       drop constraint if exists FKs49d98df3xexcyui98cwpek9p
2025-05-25 12:39:33.168 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       drop constraint if exists FKegdk29eiy7mdtefy5c7eirr6e
2025-05-25 12:39:33.168 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       drop constraint if exists FKn5fotdgk8d1xvo8nav9uv3muc
2025-05-25 12:39:33.168 DEBUG org.hibernate.SQL - 
    alter table if exists tokens 
       drop constraint if exists FK2dylsfo39lgjyqml2tbe0b0ss
2025-05-25 12:39:33.169 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       drop constraint if exists FKh8ciramu9cc9q3qcqiv4ue8a6
2025-05-25 12:39:33.169 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       drop constraint if exists FKhfh9dx7w3ubf1co1vdev94g3f
2025-05-25 12:39:33.170 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       drop constraint if exists FK4gc7xv8r1p0j6ykgn5h4nx934
2025-05-25 12:39:33.170 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       drop constraint if exists FKspv2c7f3cxhd1242nkabx95s5
2025-05-25 12:39:33.170 DEBUG org.hibernate.SQL - 
    alter table if exists users 
       drop constraint if exists FKqpugllwvyv37klq7ft9m8aqxk
2025-05-25 12:39:33.171 DEBUG org.hibernate.SQL - 
    drop table if exists client_applications cascade
2025-05-25 12:39:33.171 DEBUG org.hibernate.SQL - 
    drop table if exists client_scopes cascade
2025-05-25 12:39:33.172 DEBUG org.hibernate.SQL - 
    drop table if exists organizations cascade
2025-05-25 12:39:33.172 DEBUG org.hibernate.SQL - 
    drop table if exists permission_scopes cascade
2025-05-25 12:39:33.172 DEBUG org.hibernate.SQL - 
    drop table if exists permissions cascade
2025-05-25 12:39:33.173 DEBUG org.hibernate.SQL - 
    drop table if exists policies cascade
2025-05-25 12:39:33.173 DEBUG org.hibernate.SQL - 
    drop table if exists resources cascade
2025-05-25 12:39:33.174 DEBUG org.hibernate.SQL - 
    drop table if exists role_permissions cascade
2025-05-25 12:39:33.174 DEBUG org.hibernate.SQL - 
    drop table if exists roles cascade
2025-05-25 12:39:33.175 DEBUG org.hibernate.SQL - 
    drop table if exists scopes cascade
2025-05-25 12:39:33.175 DEBUG org.hibernate.SQL - 
    drop table if exists tokens cascade
2025-05-25 12:39:33.176 DEBUG org.hibernate.SQL - 
    drop table if exists user_roles cascade
2025-05-25 12:39:33.176 DEBUG org.hibernate.SQL - 
    drop table if exists user_scopes cascade
2025-05-25 12:39:33.176 DEBUG org.hibernate.SQL - 
    drop table if exists users cascade
2025-05-25 12:39:33.182 DEBUG org.hibernate.SQL - 
    create table client_applications (
        is_active boolean,
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        client_id varchar(100) not null unique,
        name varchar(100) not null,
        client_secret varchar(255) not null,
        description TEXT,
        redirect_uri varchar(255),
        primary key (id)
    )
2025-05-25 12:39:33.197 DEBUG org.hibernate.SQL - 
    create table client_scopes (
        client_id bigint not null,
        scope_id bigint not null,
        primary key (client_id, scope_id)
    )
2025-05-25 12:39:33.198 DEBUG org.hibernate.SQL - 
    create table organizations (
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        description varchar(1000),
        name varchar(255) not null unique,
        primary key (id)
    )
2025-05-25 12:39:33.200 DEBUG org.hibernate.SQL - 
    create table permission_scopes (
        permission_id bigint not null,
        scope_id bigint not null,
        primary key (permission_id, scope_id)
    )
2025-05-25 12:39:33.202 DEBUG org.hibernate.SQL - 
    create table permissions (
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        name varchar(100) not null unique,
        description TEXT,
        primary key (id)
    )
2025-05-25 12:39:33.207 DEBUG org.hibernate.SQL - 
    create table policies (
        subject_type smallint not null check (subject_type between 0 and 3),
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        resource_id bigint not null,
        subject_id bigint not null,
        updated_at timestamp(6) not null,
        action varchar(255) not null,
        condition_json TEXT,
        effect varchar(255) not null check (effect in ('ALLOW','DENY')),
        primary key (id)
    )
2025-05-25 12:39:33.215 DEBUG org.hibernate.SQL - 
    create table resources (
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        name varchar(100) not null,
        description TEXT,
        http_method varchar(255) not null check (http_method in ('GET','POST','PUT','DELETE','PATCH','HEAD','OPTIONS')),
        path varchar(255) not null,
        primary key (id)
    )
2025-05-25 12:39:33.217 DEBUG org.hibernate.SQL - 
    create table role_permissions (
        permission_id bigint not null,
        role_id bigint not null,
        primary key (permission_id, role_id)
    )
2025-05-25 12:39:33.218 DEBUG org.hibernate.SQL - 
    create table roles (
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        name varchar(50) not null unique,
        description TEXT,
        primary key (id)
    )
2025-05-25 12:39:33.225 DEBUG org.hibernate.SQL - 
    create table scopes (
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        name varchar(100) not null unique,
        description TEXT,
        primary key (id)
    )
2025-05-25 12:39:33.228 DEBUG org.hibernate.SQL - 
    create table tokens (
        expired boolean not null,
        revoked boolean not null,
        created_at timestamp(6) not null,
        expires_at timestamp(6) not null,
        token_id bigint generated by default as identity,
        user_id bigint,
        client_id varchar(255),
        token TEXT not null,
        token_type varchar(255) not null check (token_type in ('ACCESS','REFRESH')),
        primary key (token_id)
    )
2025-05-25 12:39:33.230 DEBUG org.hibernate.SQL - 
    create table user_roles (
        role_id bigint not null,
        user_id bigint not null,
        primary key (role_id, user_id)
    )
2025-05-25 12:39:33.232 DEBUG org.hibernate.SQL - 
    create table user_scopes (
        scope_id bigint not null,
        user_id bigint not null,
        primary key (scope_id, user_id)
    )
2025-05-25 12:39:33.233 DEBUG org.hibernate.SQL - 
    create table users (
        enabled boolean not null,
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        organization_id bigint,
        updated_at timestamp(6) not null,
        username varchar(50) not null unique,
        password varchar(100) not null,
        email varchar(255) not null unique,
        full_name varchar(255),
        primary key (id)
    )
2025-05-25 12:39:33.236 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       add constraint FK21l4ab5xsq7rxwb7b2efptbmt 
       foreign key (scope_id) 
       references scopes
2025-05-25 12:39:33.251 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       add constraint FK4glu0kw16kw6gu23yr5q6vjme 
       foreign key (client_id) 
       references client_applications
2025-05-25 12:39:33.256 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       add constraint FK3smj35weuy4b1fj396l5jvt6g 
       foreign key (scope_id) 
       references scopes
2025-05-25 12:39:33.258 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       add constraint FKacyhrlymxo934q9c4n441dhwf 
       foreign key (permission_id) 
       references permissions
2025-05-25 12:39:33.260 DEBUG org.hibernate.SQL - 
    alter table if exists policies 
       add constraint FKs49d98df3xexcyui98cwpek9p 
       foreign key (resource_id) 
       references resources
2025-05-25 12:39:33.262 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       add constraint FKegdk29eiy7mdtefy5c7eirr6e 
       foreign key (permission_id) 
       references permissions
2025-05-25 12:39:33.264 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       add constraint FKn5fotdgk8d1xvo8nav9uv3muc 
       foreign key (role_id) 
       references roles
2025-05-25 12:39:33.266 DEBUG org.hibernate.SQL - 
    alter table if exists tokens 
       add constraint FK2dylsfo39lgjyqml2tbe0b0ss 
       foreign key (user_id) 
       references users
2025-05-25 12:39:33.268 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       add constraint FKh8ciramu9cc9q3qcqiv4ue8a6 
       foreign key (role_id) 
       references roles
2025-05-25 12:39:33.270 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       add constraint FKhfh9dx7w3ubf1co1vdev94g3f 
       foreign key (user_id) 
       references users
2025-05-25 12:39:33.271 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       add constraint FK4gc7xv8r1p0j6ykgn5h4nx934 
       foreign key (scope_id) 
       references scopes
2025-05-25 12:39:33.273 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       add constraint FKspv2c7f3cxhd1242nkabx95s5 
       foreign key (user_id) 
       references users
2025-05-25 12:39:33.275 DEBUG org.hibernate.SQL - 
    alter table if exists users 
       add constraint FKqpugllwvyv37klq7ft9m8aqxk 
       foreign key (organization_id) 
       references organizations
2025-05-25 12:39:33.834 DEBUG c.e.i.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-05-25 12:39:33.889 INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name customUserDetailsService
2025-05-25 12:39:34.354 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.name,
        r1_0.updated_at 
    from
        roles r1_0 
    where
        r1_0.name=?
2025-05-25 12:39:34.464 DEBUG org.hibernate.SQL - 
    insert 
    into
        roles
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:39:34.502 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0
2025-05-25 12:39:34.515 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.name,
        p1_0.role_id,
        p1_1.id,
        p1_1.created_at,
        p1_1.description,
        p1_1.name,
        p1_1.updated_at,
        r1_0.updated_at 
    from
        roles r1_0 
    left join
        role_permissions p1_0 
            on r1_0.id=p1_0.role_id 
    left join
        permissions p1_1 
            on p1_1.id=p1_0.permission_id 
    where
        r1_0.id=?
2025-05-25 12:39:34.526 DEBUG org.hibernate.SQL - 
    select
        u1_0.role_id,
        u1_1.id,
        u1_1.created_at,
        u1_1.email,
        u1_1.enabled,
        u1_1.full_name,
        u1_1.organization_id,
        u1_1.password,
        u1_1.updated_at,
        u1_1.username 
    from
        user_roles u1_0 
    join
        users u1_1 
            on u1_1.id=u1_0.user_id 
    where
        u1_0.role_id=?
2025-05-25 12:39:34.536 DEBUG org.hibernate.SQL - 
    update
        roles 
    set
        description=?,
        name=?,
        updated_at=? 
    where
        id=?
2025-05-25 12:39:34.542 INFO  c.e.i.s.AdminInitializationService - Updated admin role with 0 permissions
2025-05-25 12:39:34.545 DEBUG org.hibernate.SQL - 
    select
        u1_0.id,
        u1_0.created_at,
        u1_0.email,
        u1_0.enabled,
        u1_0.full_name,
        u1_0.organization_id,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.username=?
2025-05-25 12:39:34.674 DEBUG org.hibernate.SQL - 
    insert 
    into
        users
        (created_at, email, enabled, full_name, organization_id, password, updated_at, username) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?)
2025-05-25 12:39:34.678 DEBUG org.hibernate.SQL - 
    insert 
    into
        user_roles
        (user_id, role_id) 
    values
        (?, ?)
2025-05-25 12:39:34.680 INFO  c.e.i.s.AdminInitializationService - Created admin user with username: admin
2025-05-25 12:39:34.829 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-05-25 12:39:34.988 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:39:34.991 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:39:34.996 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: POLICY_UPDATE
2025-05-25 12:39:34.998 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:39:35.003 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:39:35.006 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ROLE_DELETE
2025-05-25 12:39:35.009 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:39:35.012 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:39:35.013 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ORGANIZATION_UPDATE
2025-05-25 12:39:35.015 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:39:35.020 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:39:35.022 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: RESOURCE_DELETE
2025-05-25 12:39:35.025 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:39:35.028 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:39:35.030 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: RESOURCE_CREATE
2025-05-25 12:39:35.032 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:39:35.035 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:39:35.039 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ROLE_READ
2025-05-25 12:39:35.043 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:39:35.046 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:39:35.048 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: SCOPE_DELETE
2025-05-25 12:39:35.052 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:39:35.055 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:39:35.058 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ORGANIZATION_READ
2025-05-25 12:39:35.060 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:39:35.062 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:39:35.063 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: POLICY_READ
2025-05-25 12:39:35.065 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:39:35.066 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:39:35.068 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: SCOPE_READ
2025-05-25 12:39:35.070 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:39:35.073 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:39:35.075 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: CLIENT_CREATE
2025-05-25 12:39:35.076 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:39:35.078 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:39:35.080 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: USER_READ
2025-05-25 12:39:35.081 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:39:35.083 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:39:35.086 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ROLE_UPDATE
2025-05-25 12:39:35.088 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:39:35.091 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:39:35.093 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ORGANIZATION_CREATE
2025-05-25 12:39:35.095 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:39:35.097 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:39:35.099 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: SCOPE_UPDATE
2025-05-25 12:39:35.101 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:39:35.104 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:39:35.106 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: POLICY_CREATE
2025-05-25 12:39:35.108 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:39:35.109 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:39:35.111 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: RESOURCE_UPDATE
2025-05-25 12:39:35.113 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:39:35.118 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:39:35.123 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:39:35.124 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: USER_DELETE
2025-05-25 12:39:35.126 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:39:35.128 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:39:35.130 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:39:35.131 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: SCOPE_CREATE
2025-05-25 12:39:35.133 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:39:35.135 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:39:35.138 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ROLE_CREATE
2025-05-25 12:39:35.140 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:39:35.142 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:39:35.144 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: POLICY_DELETE
2025-05-25 12:39:35.145 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:39:35.146 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:39:35.148 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: RESOURCE_READ
2025-05-25 12:39:35.149 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:39:35.152 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:39:35.154 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ORGANIZATION_DELETE
2025-05-25 12:39:35.156 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:39:35.160 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:39:35.161 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:39:35.163 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: USER_UPDATE
2025-05-25 12:39:35.164 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:39:35.167 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:39:35.170 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:39:35.480 DEBUG o.s.s.web.DefaultSecurityFilterChain - Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, LogoutFilter, JwtAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, SessionManagementFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-05-25 12:39:35.828 INFO  o.s.b.a.h.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:testdb'
2025-05-25 12:39:36.148 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 39641 (http) with context path '/'
2025-05-25 12:39:36.164 INFO  c.e.iam.integration.AuthAndRoleTest - Started AuthAndRoleTest in 7.932 seconds (process running for 9.015)
2025-05-25 12:39:36.765 DEBUG org.hibernate.SQL - 
    select
        u1_0.id,
        u1_0.created_at,
        u1_0.email,
        u1_0.enabled,
        u1_0.full_name,
        u1_0.organization_id,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0
2025-05-25 12:39:36.772 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.name,
        r1_0.updated_at 
    from
        roles r1_0
2025-05-25 12:39:36.773 DEBUG org.hibernate.SQL - 
    select
        p1_0.role_id,
        p1_1.id,
        p1_1.created_at,
        p1_1.description,
        p1_1.name,
        p1_1.updated_at 
    from
        role_permissions p1_0 
    join
        permissions p1_1 
            on p1_1.id=p1_0.permission_id 
    where
        p1_0.role_id=?
2025-05-25 12:39:36.775 DEBUG org.hibernate.SQL - 
    select
        u1_0.role_id,
        u1_1.id,
        u1_1.created_at,
        u1_1.email,
        u1_1.enabled,
        u1_1.full_name,
        u1_1.organization_id,
        u1_1.password,
        u1_1.updated_at,
        u1_1.username 
    from
        user_roles u1_0 
    join
        users u1_1 
            on u1_1.id=u1_0.user_id 
    where
        u1_0.role_id=?
2025-05-25 12:39:36.778 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0
2025-05-25 12:39:36.786 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:39:36.788 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:39:36.789 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:39:36.789 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:39:36.790 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:39:36.791 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:39:36.792 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:39:36.793 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:39:36.794 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:39:36.795 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:39:36.796 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:39:36.796 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:39:36.797 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:39:36.797 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:39:36.798 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:39:36.799 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:39:36.800 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:39:36.800 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:39:36.801 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:39:36.802 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:39:36.802 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:39:36.803 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:39:36.804 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:39:36.804 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:39:36.805 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:39:36.805 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:39:36.806 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:39:36.807 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:39:36.807 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:39:36.808 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:39:36.809 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:39:36.810 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:39:36.811 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:39:36.812 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:39:36.813 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:39:36.814 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:39:36.814 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:39:36.815 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:39:36.817 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:39:36.818 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:39:36.819 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:39:36.820 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:39:36.821 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:39:36.822 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:39:36.823 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:39:36.823 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:39:36.824 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:39:36.824 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:39:36.830 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.http_method,
        r1_0.name,
        r1_0.path,
        r1_0.updated_at 
    from
        resources r1_0
2025-05-25 12:39:36.837 DEBUG org.hibernate.SQL - 
    delete 
    from
        user_roles 
    where
        user_id=?
2025-05-25 12:39:36.841 DEBUG org.hibernate.SQL - 
    delete 
    from
        user_scopes 
    where
        user_id=?
2025-05-25 12:39:36.843 DEBUG org.hibernate.SQL - 
    delete 
    from
        users 
    where
        id=?
2025-05-25 12:39:36.846 DEBUG org.hibernate.SQL - 
    delete 
    from
        roles 
    where
        id=?
2025-05-25 12:39:36.847 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:39:36.847 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:39:36.847 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:39:36.848 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:39:36.849 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:39:36.851 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:39:36.852 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:39:36.853 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:39:36.854 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:39:36.854 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:39:36.855 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:39:36.855 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:39:36.856 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:39:36.857 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:39:36.857 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:39:36.858 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:39:36.858 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:39:36.859 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:39:36.859 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:39:36.859 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:39:36.860 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:39:36.860 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:39:36.861 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:39:36.861 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:39:36.863 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:39:36.866 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:39:36.868 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:39:36.870 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:39:36.873 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:39:36.874 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:39:36.876 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:39:36.877 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:39:36.879 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:39:36.881 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:39:36.886 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:39:36.887 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:39:36.890 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:39:36.892 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:39:36.894 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:39:36.895 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:39:36.897 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:39:36.898 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:39:36.901 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:39:36.902 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:39:36.905 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:39:36.906 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:39:36.909 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:39:36.910 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:39:36.913 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:39:36.915 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:39:36.919 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:39:36.920 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:39:36.923 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:39:36.924 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:39:36.928 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:39:36.929 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:39:36.931 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:39:36.933 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:39:37.374 DEBUG org.hibernate.SQL - 
    select
        count(*) 
    from
        permissions p1_0
2025-05-25 12:39:37.376 INFO  c.e.iam.integration.AuthAndRoleTest - Permissions created. Total permissions: 17
2025-05-25 12:39:37.378 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.name,
        r1_0.updated_at 
    from
        roles r1_0 
    where
        r1_0.name=?
2025-05-25 12:39:37.381 DEBUG org.hibernate.SQL - 
    insert 
    into
        roles
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:39:37.384 INFO  c.e.iam.integration.AuthAndRoleTest - Admin role permissions: [ROLE_UPDATE, USER_READ, SCOPE_CREATE, SCOPE_UPDATE, RESOURCE_UPDATE, ROLE_DELETE, SCOPE_DELETE, RESOURCE_DELETE, RESOURCE_CREATE, ORGANIZATION_UPDATE, POLICY_DELETE, ORGANIZATION_DELETE, ROLE_CREATE, ORGANIZATION_READ, POLICY_READ, ORGANIZATION_CREATE, POLICY_CREATE]
2025-05-25 12:39:37.387 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.name,
        r1_0.updated_at 
    from
        roles r1_0 
    where
        r1_0.name=?
2025-05-25 12:39:37.388 DEBUG org.hibernate.SQL - 
    insert 
    into
        roles
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:39:37.392 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.name,
        r1_0.updated_at 
    from
        roles r1_0 
    where
        r1_0.name=?
2025-05-25 12:39:37.394 DEBUG org.hibernate.SQL - 
    insert 
    into
        roles
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:39:37.396 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:39:37.396 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:39:37.397 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:39:37.397 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:39:37.397 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:39:37.398 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:39:37.398 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:39:37.398 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:39:37.399 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:39:37.399 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:39:37.400 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:39:37.400 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:39:37.401 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:39:37.401 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:39:37.402 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:39:37.402 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:39:37.403 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:39:37.403 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:39:37.404 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:39:37.404 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:39:37.405 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:39:37.405 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:39:37.406 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:39:37.406 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:39:37.407 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:39:37.495 DEBUG org.hibernate.SQL - 
    insert 
    into
        users
        (created_at, email, enabled, full_name, organization_id, password, updated_at, username) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?)
2025-05-25 12:39:37.587 DEBUG org.hibernate.SQL - 
    insert 
    into
        users
        (created_at, email, enabled, full_name, organization_id, password, updated_at, username) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?)
2025-05-25 12:39:37.679 DEBUG org.hibernate.SQL - 
    insert 
    into
        users
        (created_at, email, enabled, full_name, organization_id, password, updated_at, username) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?)
2025-05-25 12:39:37.681 DEBUG org.hibernate.SQL - 
    insert 
    into
        user_roles
        (user_id, role_id) 
    values
        (?, ?)
2025-05-25 12:39:37.683 DEBUG org.hibernate.SQL - 
    insert 
    into
        user_roles
        (user_id, role_id) 
    values
        (?, ?)
2025-05-25 12:39:37.683 DEBUG org.hibernate.SQL - 
    insert 
    into
        user_roles
        (user_id, role_id) 
    values
        (?, ?)
2025-05-25 12:39:37.861 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-05-25 12:39:37.862 INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-05-25 12:39:37.863 INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-05-25 12:39:37.875 DEBUG o.s.security.web.FilterChainProxy - Securing POST /auth/login
2025-05-25 12:39:37.880 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-05-25 12:39:37.881 DEBUG o.s.security.web.FilterChainProxy - Secured POST /auth/login
2025-05-25 12:39:38.024 DEBUG org.hibernate.SQL - 
    select
        u1_0.id,
        u1_0.created_at,
        u1_0.email,
        u1_0.enabled,
        u1_0.full_name,
        u1_0.organization_id,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.username=?
2025-05-25 12:39:38.028 DEBUG org.hibernate.SQL - 
    select
        r1_0.user_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        user_roles r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.user_id=?
2025-05-25 12:39:38.030 INFO  c.example.iam.security.UserPrincipal - user roles: [ROLE_ADMIN]
2025-05-25 12:39:38.030 INFO  c.example.iam.security.UserPrincipal - Role before loading permissions: ROLE_ADMIN
2025-05-25 12:39:38.032 DEBUG org.hibernate.SQL - 
    select
        p1_0.role_id,
        p1_1.id,
        p1_1.created_at,
        p1_1.description,
        p1_1.name,
        p1_1.updated_at 
    from
        role_permissions p1_0 
    join
        permissions p1_1 
            on p1_1.id=p1_0.permission_id 
    where
        p1_0.role_id=?
2025-05-25 12:39:38.033 INFO  c.example.iam.security.UserPrincipal - Permissions size before loading: 0
2025-05-25 12:39:38.033 INFO  c.example.iam.security.UserPrincipal - Permissions size after loading: 0
2025-05-25 12:39:38.034 INFO  c.example.iam.security.UserPrincipal - Permissions for role ROLE_ADMIN: []
2025-05-25 12:39:38.035 INFO  c.example.iam.security.UserPrincipal - Final user permissions: []
2025-05-25 12:39:38.122 DEBUG o.s.s.a.d.DaoAuthenticationProvider - Authenticated user
2025-05-25 12:39:38.153 DEBUG org.hibernate.SQL - 
    insert 
    into
        tokens
        (client_id, created_at, expired, expires_at, revoked, token, token_type, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?)
2025-05-25 12:39:38.157 DEBUG org.hibernate.SQL - 
    insert 
    into
        tokens
        (client_id, created_at, expired, expires_at, revoked, token, token_type, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?)
2025-05-25 12:39:38.195 DEBUG o.s.security.web.FilterChainProxy - Securing POST /auth/login
2025-05-25 12:39:38.195 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-05-25 12:39:38.195 DEBUG o.s.security.web.FilterChainProxy - Secured POST /auth/login
2025-05-25 12:39:38.198 DEBUG org.hibernate.SQL - 
    select
        u1_0.id,
        u1_0.created_at,
        u1_0.email,
        u1_0.enabled,
        u1_0.full_name,
        u1_0.organization_id,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.username=?
2025-05-25 12:39:38.200 DEBUG org.hibernate.SQL - 
    select
        ca1_0.id,
        ca1_0.is_active,
        ca1_0.client_id,
        ca1_0.client_secret,
        ca1_0.created_at,
        ca1_0.description,
        ca1_0.name,
        ca1_0.redirect_uri,
        ca1_0.updated_at 
    from
        client_applications ca1_0 
    where
        ca1_0.client_id=?
2025-05-25 12:39:38.291 DEBUG o.s.s.a.d.DaoAuthenticationProvider - Failed to find user 'manager'
2025-05-25 12:39:38.295 ERROR c.e.i.e.GlobalExceptionHandler - Invalid credentials: Bad credentials
2025-05-25 12:39:38.314 DEBUG o.s.security.web.FilterChainProxy - Securing POST /auth/login
2025-05-25 12:39:38.316 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-05-25 12:39:38.317 DEBUG o.s.security.web.FilterChainProxy - Secured POST /auth/login
2025-05-25 12:39:38.323 DEBUG org.hibernate.SQL - 
    select
        u1_0.id,
        u1_0.created_at,
        u1_0.email,
        u1_0.enabled,
        u1_0.full_name,
        u1_0.organization_id,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.username=?
2025-05-25 12:39:38.325 DEBUG org.hibernate.SQL - 
    select
        ca1_0.id,
        ca1_0.is_active,
        ca1_0.client_id,
        ca1_0.client_secret,
        ca1_0.created_at,
        ca1_0.description,
        ca1_0.name,
        ca1_0.redirect_uri,
        ca1_0.updated_at 
    from
        client_applications ca1_0 
    where
        ca1_0.client_id=?
2025-05-25 12:39:38.426 DEBUG o.s.s.a.d.DaoAuthenticationProvider - Failed to find user 'user'
2025-05-25 12:39:38.428 ERROR c.e.i.e.GlobalExceptionHandler - Invalid credentials: Bad credentials
2025-05-25 12:39:38.434 INFO  c.e.iam.integration.AuthAndRoleTest - Testing /users endpoint with admin token: eyJhbGciOiJIUzI1NiJ9.eyJ0eXBlIjoidXNlciIsInVzZXJuYW1lIjoiYWRtaW4iLCJzdWIiOiJhZG1pbiIsImlhdCI6MTc0ODE2NTk3OCwiZXhwIjoxNzQ4MTY5NTc4fQ.kgOYZSsUb4o4-MbOj8uIh8HqwdP1F9CN0kexZIMXr60
2025-05-25 12:39:38.438 DEBUG o.s.security.web.FilterChainProxy - Securing GET /users
2025-05-25 12:39:38.441 DEBUG org.hibernate.SQL - 
    select
        t1_0.token_id,
        t1_0.client_id,
        t1_0.created_at,
        t1_0.expired,
        t1_0.expires_at,
        t1_0.revoked,
        t1_0.token,
        t1_0.token_type,
        t1_0.user_id 
    from
        tokens t1_0 
    where
        t1_0.token=?
2025-05-25 12:39:38.470 DEBUG org.hibernate.SQL - 
    select
        u1_0.id,
        u1_0.created_at,
        u1_0.email,
        u1_0.enabled,
        u1_0.full_name,
        u1_0.organization_id,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.username=?
2025-05-25 12:39:38.473 DEBUG org.hibernate.SQL - 
    select
        r1_0.user_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        user_roles r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.user_id=?
2025-05-25 12:39:38.474 INFO  c.example.iam.security.UserPrincipal - user roles: [ROLE_ADMIN]
2025-05-25 12:39:38.474 INFO  c.example.iam.security.UserPrincipal - Role before loading permissions: ROLE_ADMIN
2025-05-25 12:39:38.474 DEBUG org.hibernate.SQL - 
    select
        p1_0.role_id,
        p1_1.id,
        p1_1.created_at,
        p1_1.description,
        p1_1.name,
        p1_1.updated_at 
    from
        role_permissions p1_0 
    join
        permissions p1_1 
            on p1_1.id=p1_0.permission_id 
    where
        p1_0.role_id=?
2025-05-25 12:39:38.475 INFO  c.example.iam.security.UserPrincipal - Permissions size before loading: 0
2025-05-25 12:39:38.475 INFO  c.example.iam.security.UserPrincipal - Permissions size after loading: 0
2025-05-25 12:39:38.475 INFO  c.example.iam.security.UserPrincipal - Permissions for role ROLE_ADMIN: []
2025-05-25 12:39:38.475 INFO  c.example.iam.security.UserPrincipal - Final user permissions: []
2025-05-25 12:39:38.477 INFO  c.e.i.s.JwtAuthenticationFilter - username 1: admin
2025-05-25 12:39:38.477 INFO  c.e.i.s.JwtAuthenticationFilter - Required permission 1: []
2025-05-25 12:39:38.477 DEBUG o.s.security.web.FilterChainProxy - Secured GET /users
2025-05-25 12:39:38.484 INFO  c.e.i.s.aspect.PermissionCheckAspect - Required permission: USER_READ
2025-05-25 12:39:38.484 INFO  c.e.i.s.aspect.PermissionCheckAspect - User permissions: []
2025-05-25 12:39:38.485 ERROR c.e.i.e.GlobalExceptionHandler - Access denied: User does not have required permission: USER_READ
2025-05-25 12:39:38.487 INFO  c.e.iam.integration.AuthAndRoleTest - Raw response from /users: Status=403 FORBIDDEN, Body={"status":403,"error":"Access denied","message":"User does not have required permission: USER_READ"}
2025-05-25 12:39:38.492 DEBUG o.s.security.web.FilterChainProxy - Securing GET /users
2025-05-25 12:39:38.494 DEBUG org.hibernate.SQL - 
    select
        t1_0.token_id,
        t1_0.client_id,
        t1_0.created_at,
        t1_0.expired,
        t1_0.expires_at,
        t1_0.revoked,
        t1_0.token,
        t1_0.token_type,
        t1_0.user_id 
    from
        tokens t1_0 
    where
        t1_0.token=?
2025-05-25 12:39:38.504 DEBUG org.hibernate.SQL - 
    select
        u1_0.id,
        u1_0.created_at,
        u1_0.email,
        u1_0.enabled,
        u1_0.full_name,
        u1_0.organization_id,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.username=?
2025-05-25 12:39:38.505 DEBUG org.hibernate.SQL - 
    select
        r1_0.user_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        user_roles r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.user_id=?
2025-05-25 12:39:38.506 INFO  c.example.iam.security.UserPrincipal - user roles: [ROLE_ADMIN]
2025-05-25 12:39:38.506 INFO  c.example.iam.security.UserPrincipal - Role before loading permissions: ROLE_ADMIN
2025-05-25 12:39:38.506 DEBUG org.hibernate.SQL - 
    select
        p1_0.role_id,
        p1_1.id,
        p1_1.created_at,
        p1_1.description,
        p1_1.name,
        p1_1.updated_at 
    from
        role_permissions p1_0 
    join
        permissions p1_1 
            on p1_1.id=p1_0.permission_id 
    where
        p1_0.role_id=?
2025-05-25 12:39:38.506 INFO  c.example.iam.security.UserPrincipal - Permissions size before loading: 0
2025-05-25 12:39:38.507 INFO  c.example.iam.security.UserPrincipal - Permissions size after loading: 0
2025-05-25 12:39:38.507 INFO  c.example.iam.security.UserPrincipal - Permissions for role ROLE_ADMIN: []
2025-05-25 12:39:38.507 INFO  c.example.iam.security.UserPrincipal - Final user permissions: []
2025-05-25 12:39:38.508 INFO  c.e.i.s.JwtAuthenticationFilter - username 1: admin
2025-05-25 12:39:38.508 INFO  c.e.i.s.JwtAuthenticationFilter - Required permission 1: []
2025-05-25 12:39:38.508 DEBUG o.s.security.web.FilterChainProxy - Secured GET /users
2025-05-25 12:39:38.508 INFO  c.e.i.s.aspect.PermissionCheckAspect - Required permission: USER_READ
2025-05-25 12:39:38.509 INFO  c.e.i.s.aspect.PermissionCheckAspect - User permissions: []
2025-05-25 12:39:38.509 ERROR c.e.i.e.GlobalExceptionHandler - Access denied: User does not have required permission: USER_READ
2025-05-25 12:39:38.511 INFO  c.e.iam.integration.AuthAndRoleTest - Parsed response: Status=403 FORBIDDEN, Body={status=403, error=Access denied, message=User does not have required permission: USER_READ}
2025-05-25 12:39:38.619 INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-05-25 12:39:38.623 INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-05-25 12:39:38.633 DEBUG org.hibernate.SQL - 
    set client_min_messages = WARNING
2025-05-25 12:39:38.634 ERROR o.h.t.s.i.SchemaDropperImpl$DelayedDropActionImpl - HHH000478: Unsuccessful: 
    set client_min_messages = WARNING
2025-05-25 12:39:38.634 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       drop constraint if exists FK21l4ab5xsq7rxwb7b2efptbmt
2025-05-25 12:39:38.636 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       drop constraint if exists FK4glu0kw16kw6gu23yr5q6vjme
2025-05-25 12:39:38.636 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       drop constraint if exists FK3smj35weuy4b1fj396l5jvt6g
2025-05-25 12:39:38.637 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       drop constraint if exists FKacyhrlymxo934q9c4n441dhwf
2025-05-25 12:39:38.637 DEBUG org.hibernate.SQL - 
    alter table if exists policies 
       drop constraint if exists FKs49d98df3xexcyui98cwpek9p
2025-05-25 12:39:38.638 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       drop constraint if exists FKegdk29eiy7mdtefy5c7eirr6e
2025-05-25 12:39:38.638 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       drop constraint if exists FKn5fotdgk8d1xvo8nav9uv3muc
2025-05-25 12:39:38.639 DEBUG org.hibernate.SQL - 
    alter table if exists tokens 
       drop constraint if exists FK2dylsfo39lgjyqml2tbe0b0ss
2025-05-25 12:39:38.639 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       drop constraint if exists FKh8ciramu9cc9q3qcqiv4ue8a6
2025-05-25 12:39:38.639 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       drop constraint if exists FKhfh9dx7w3ubf1co1vdev94g3f
2025-05-25 12:39:38.640 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       drop constraint if exists FK4gc7xv8r1p0j6ykgn5h4nx934
2025-05-25 12:39:38.640 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       drop constraint if exists FKspv2c7f3cxhd1242nkabx95s5
2025-05-25 12:39:38.640 DEBUG org.hibernate.SQL - 
    alter table if exists users 
       drop constraint if exists FKqpugllwvyv37klq7ft9m8aqxk
2025-05-25 12:39:38.641 DEBUG org.hibernate.SQL - 
    drop table if exists client_applications cascade
2025-05-25 12:39:38.642 DEBUG org.hibernate.SQL - 
    drop table if exists client_scopes cascade
2025-05-25 12:39:38.643 DEBUG org.hibernate.SQL - 
    drop table if exists organizations cascade
2025-05-25 12:39:38.643 DEBUG org.hibernate.SQL - 
    drop table if exists permission_scopes cascade
2025-05-25 12:39:38.644 DEBUG org.hibernate.SQL - 
    drop table if exists permissions cascade
2025-05-25 12:39:38.645 DEBUG org.hibernate.SQL - 
    drop table if exists policies cascade
2025-05-25 12:39:38.645 DEBUG org.hibernate.SQL - 
    drop table if exists resources cascade
2025-05-25 12:39:38.646 DEBUG org.hibernate.SQL - 
    drop table if exists role_permissions cascade
2025-05-25 12:39:38.646 DEBUG org.hibernate.SQL - 
    drop table if exists roles cascade
2025-05-25 12:39:38.647 DEBUG org.hibernate.SQL - 
    drop table if exists scopes cascade
2025-05-25 12:39:38.649 DEBUG org.hibernate.SQL - 
    drop table if exists tokens cascade
2025-05-25 12:39:38.650 DEBUG org.hibernate.SQL - 
    drop table if exists user_roles cascade
2025-05-25 12:39:38.650 DEBUG org.hibernate.SQL - 
    drop table if exists user_scopes cascade
2025-05-25 12:39:38.651 DEBUG org.hibernate.SQL - 
    drop table if exists users cascade
2025-05-25 12:39:38.655 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-25 12:39:38.658 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-25 12:40:56.625 INFO  c.e.iam.IamServiceApplicationTests - Starting IamServiceApplicationTests using Java 21.0.7 with PID 29452 (started by descent in /home/descent/Documents/VDT/vdt5-iam-system/iam-service)
2025-05-25 12:40:56.626 DEBUG c.e.iam.IamServiceApplicationTests - Running with Spring Boot v3.4.5, Spring v6.2.6
2025-05-25 12:40:56.629 INFO  c.e.iam.IamServiceApplicationTests - No active profile set, falling back to 1 default profile: "default"
2025-05-25 12:40:58.081 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-05-25 12:40:58.229 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 133 ms. Found 9 JPA repository interfaces.
2025-05-25 12:40:59.617 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-25 12:41:00.136 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@6d5d1204
2025-05-25 12:41:00.138 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-25 12:41:03.516 INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name customUserDetailsService
2025-05-25 12:41:04.491 INFO  c.e.i.s.AdminInitializationService - Updated admin role with 30 permissions
2025-05-25 12:41:04.699 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-05-25 12:41:06.211 INFO  c.e.iam.IamServiceApplicationTests - Started IamServiceApplicationTests in 10.199 seconds (process running for 14.316)
2025-05-25 12:41:06.225 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-25 12:41:06.238 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-25 12:41:14.645 INFO  c.e.iam.integration.AuthAndRoleTest - Starting AuthAndRoleTest using Java 21.0.7 with PID 29914 (started by descent in /home/descent/Documents/VDT/vdt5-iam-system/iam-service)
2025-05-25 12:41:14.647 DEBUG c.e.iam.integration.AuthAndRoleTest - Running with Spring Boot v3.4.5, Spring v6.2.6
2025-05-25 12:41:14.649 INFO  c.e.iam.integration.AuthAndRoleTest - The following 1 profile is active: "test"
2025-05-25 12:41:16.086 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-05-25 12:41:16.222 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 120 ms. Found 9 JPA repository interfaces.
2025-05-25 12:41:17.637 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 0 (http)
2025-05-25 12:41:17.666 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-25 12:41:17.667 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.40]
2025-05-25 12:41:17.762 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-25 12:41:17.763 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 3083 ms
2025-05-25 12:41:18.588 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-25 12:41:18.858 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:testdb user=SA
2025-05-25 12:41:18.863 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-25 12:41:20.767 DEBUG org.hibernate.SQL - 
    set client_min_messages = WARNING
2025-05-25 12:41:20.774 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       drop constraint if exists FK21l4ab5xsq7rxwb7b2efptbmt
2025-05-25 12:41:20.775 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       drop constraint if exists FK4glu0kw16kw6gu23yr5q6vjme
2025-05-25 12:41:20.777 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       drop constraint if exists FK3smj35weuy4b1fj396l5jvt6g
2025-05-25 12:41:20.778 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       drop constraint if exists FKacyhrlymxo934q9c4n441dhwf
2025-05-25 12:41:20.779 DEBUG org.hibernate.SQL - 
    alter table if exists policies 
       drop constraint if exists FKs49d98df3xexcyui98cwpek9p
2025-05-25 12:41:20.780 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       drop constraint if exists FKegdk29eiy7mdtefy5c7eirr6e
2025-05-25 12:41:20.781 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       drop constraint if exists FKn5fotdgk8d1xvo8nav9uv3muc
2025-05-25 12:41:20.782 DEBUG org.hibernate.SQL - 
    alter table if exists tokens 
       drop constraint if exists FK2dylsfo39lgjyqml2tbe0b0ss
2025-05-25 12:41:20.782 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       drop constraint if exists FKh8ciramu9cc9q3qcqiv4ue8a6
2025-05-25 12:41:20.783 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       drop constraint if exists FKhfh9dx7w3ubf1co1vdev94g3f
2025-05-25 12:41:20.784 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       drop constraint if exists FK4gc7xv8r1p0j6ykgn5h4nx934
2025-05-25 12:41:20.785 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       drop constraint if exists FKspv2c7f3cxhd1242nkabx95s5
2025-05-25 12:41:20.785 DEBUG org.hibernate.SQL - 
    alter table if exists users 
       drop constraint if exists FKqpugllwvyv37klq7ft9m8aqxk
2025-05-25 12:41:20.786 DEBUG org.hibernate.SQL - 
    drop table if exists client_applications cascade
2025-05-25 12:41:20.787 DEBUG org.hibernate.SQL - 
    drop table if exists client_scopes cascade
2025-05-25 12:41:20.787 DEBUG org.hibernate.SQL - 
    drop table if exists organizations cascade
2025-05-25 12:41:20.788 DEBUG org.hibernate.SQL - 
    drop table if exists permission_scopes cascade
2025-05-25 12:41:20.788 DEBUG org.hibernate.SQL - 
    drop table if exists permissions cascade
2025-05-25 12:41:20.788 DEBUG org.hibernate.SQL - 
    drop table if exists policies cascade
2025-05-25 12:41:20.789 DEBUG org.hibernate.SQL - 
    drop table if exists resources cascade
2025-05-25 12:41:20.790 DEBUG org.hibernate.SQL - 
    drop table if exists role_permissions cascade
2025-05-25 12:41:20.792 DEBUG org.hibernate.SQL - 
    drop table if exists roles cascade
2025-05-25 12:41:20.793 DEBUG org.hibernate.SQL - 
    drop table if exists scopes cascade
2025-05-25 12:41:20.794 DEBUG org.hibernate.SQL - 
    drop table if exists tokens cascade
2025-05-25 12:41:20.794 DEBUG org.hibernate.SQL - 
    drop table if exists user_roles cascade
2025-05-25 12:41:20.795 DEBUG org.hibernate.SQL - 
    drop table if exists user_scopes cascade
2025-05-25 12:41:20.796 DEBUG org.hibernate.SQL - 
    drop table if exists users cascade
2025-05-25 12:41:20.804 DEBUG org.hibernate.SQL - 
    create table client_applications (
        is_active boolean,
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        client_id varchar(100) not null unique,
        name varchar(100) not null,
        client_secret varchar(255) not null,
        description TEXT,
        redirect_uri varchar(255),
        primary key (id)
    )
2025-05-25 12:41:20.820 DEBUG org.hibernate.SQL - 
    create table client_scopes (
        client_id bigint not null,
        scope_id bigint not null,
        primary key (client_id, scope_id)
    )
2025-05-25 12:41:20.821 DEBUG org.hibernate.SQL - 
    create table organizations (
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        description varchar(1000),
        name varchar(255) not null unique,
        primary key (id)
    )
2025-05-25 12:41:20.827 DEBUG org.hibernate.SQL - 
    create table permission_scopes (
        permission_id bigint not null,
        scope_id bigint not null,
        primary key (permission_id, scope_id)
    )
2025-05-25 12:41:20.830 DEBUG org.hibernate.SQL - 
    create table permissions (
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        name varchar(100) not null unique,
        description TEXT,
        primary key (id)
    )
2025-05-25 12:41:20.833 DEBUG org.hibernate.SQL - 
    create table policies (
        subject_type smallint not null check (subject_type between 0 and 3),
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        resource_id bigint not null,
        subject_id bigint not null,
        updated_at timestamp(6) not null,
        action varchar(255) not null,
        condition_json TEXT,
        effect varchar(255) not null check (effect in ('ALLOW','DENY')),
        primary key (id)
    )
2025-05-25 12:41:20.841 DEBUG org.hibernate.SQL - 
    create table resources (
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        name varchar(100) not null,
        description TEXT,
        http_method varchar(255) not null check (http_method in ('GET','POST','PUT','DELETE','PATCH','HEAD','OPTIONS')),
        path varchar(255) not null,
        primary key (id)
    )
2025-05-25 12:41:20.845 DEBUG org.hibernate.SQL - 
    create table role_permissions (
        permission_id bigint not null,
        role_id bigint not null,
        primary key (permission_id, role_id)
    )
2025-05-25 12:41:20.849 DEBUG org.hibernate.SQL - 
    create table roles (
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        name varchar(50) not null unique,
        description TEXT,
        primary key (id)
    )
2025-05-25 12:41:20.854 DEBUG org.hibernate.SQL - 
    create table scopes (
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        name varchar(100) not null unique,
        description TEXT,
        primary key (id)
    )
2025-05-25 12:41:20.860 DEBUG org.hibernate.SQL - 
    create table tokens (
        expired boolean not null,
        revoked boolean not null,
        created_at timestamp(6) not null,
        expires_at timestamp(6) not null,
        token_id bigint generated by default as identity,
        user_id bigint,
        client_id varchar(255),
        token TEXT not null,
        token_type varchar(255) not null check (token_type in ('ACCESS','REFRESH')),
        primary key (token_id)
    )
2025-05-25 12:41:20.864 DEBUG org.hibernate.SQL - 
    create table user_roles (
        role_id bigint not null,
        user_id bigint not null,
        primary key (role_id, user_id)
    )
2025-05-25 12:41:20.866 DEBUG org.hibernate.SQL - 
    create table user_scopes (
        scope_id bigint not null,
        user_id bigint not null,
        primary key (scope_id, user_id)
    )
2025-05-25 12:41:20.869 DEBUG org.hibernate.SQL - 
    create table users (
        enabled boolean not null,
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        organization_id bigint,
        updated_at timestamp(6) not null,
        username varchar(50) not null unique,
        password varchar(100) not null,
        email varchar(255) not null unique,
        full_name varchar(255),
        primary key (id)
    )
2025-05-25 12:41:20.873 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       add constraint FK21l4ab5xsq7rxwb7b2efptbmt 
       foreign key (scope_id) 
       references scopes
2025-05-25 12:41:20.888 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       add constraint FK4glu0kw16kw6gu23yr5q6vjme 
       foreign key (client_id) 
       references client_applications
2025-05-25 12:41:20.894 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       add constraint FK3smj35weuy4b1fj396l5jvt6g 
       foreign key (scope_id) 
       references scopes
2025-05-25 12:41:20.898 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       add constraint FKacyhrlymxo934q9c4n441dhwf 
       foreign key (permission_id) 
       references permissions
2025-05-25 12:41:20.902 DEBUG org.hibernate.SQL - 
    alter table if exists policies 
       add constraint FKs49d98df3xexcyui98cwpek9p 
       foreign key (resource_id) 
       references resources
2025-05-25 12:41:20.910 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       add constraint FKegdk29eiy7mdtefy5c7eirr6e 
       foreign key (permission_id) 
       references permissions
2025-05-25 12:41:20.913 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       add constraint FKn5fotdgk8d1xvo8nav9uv3muc 
       foreign key (role_id) 
       references roles
2025-05-25 12:41:20.916 DEBUG org.hibernate.SQL - 
    alter table if exists tokens 
       add constraint FK2dylsfo39lgjyqml2tbe0b0ss 
       foreign key (user_id) 
       references users
2025-05-25 12:41:20.921 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       add constraint FKh8ciramu9cc9q3qcqiv4ue8a6 
       foreign key (role_id) 
       references roles
2025-05-25 12:41:20.926 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       add constraint FKhfh9dx7w3ubf1co1vdev94g3f 
       foreign key (user_id) 
       references users
2025-05-25 12:41:20.929 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       add constraint FK4gc7xv8r1p0j6ykgn5h4nx934 
       foreign key (scope_id) 
       references scopes
2025-05-25 12:41:20.932 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       add constraint FKspv2c7f3cxhd1242nkabx95s5 
       foreign key (user_id) 
       references users
2025-05-25 12:41:20.938 DEBUG org.hibernate.SQL - 
    alter table if exists users 
       add constraint FKqpugllwvyv37klq7ft9m8aqxk 
       foreign key (organization_id) 
       references organizations
2025-05-25 12:41:21.692 DEBUG c.e.i.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-05-25 12:41:21.769 INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name customUserDetailsService
2025-05-25 12:41:22.365 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.name,
        r1_0.updated_at 
    from
        roles r1_0 
    where
        r1_0.name=?
2025-05-25 12:41:22.532 DEBUG org.hibernate.SQL - 
    insert 
    into
        roles
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:41:22.580 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0
2025-05-25 12:41:22.599 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.name,
        p1_0.role_id,
        p1_1.id,
        p1_1.created_at,
        p1_1.description,
        p1_1.name,
        p1_1.updated_at,
        r1_0.updated_at 
    from
        roles r1_0 
    left join
        role_permissions p1_0 
            on r1_0.id=p1_0.role_id 
    left join
        permissions p1_1 
            on p1_1.id=p1_0.permission_id 
    where
        r1_0.id=?
2025-05-25 12:41:22.611 DEBUG org.hibernate.SQL - 
    select
        u1_0.role_id,
        u1_1.id,
        u1_1.created_at,
        u1_1.email,
        u1_1.enabled,
        u1_1.full_name,
        u1_1.organization_id,
        u1_1.password,
        u1_1.updated_at,
        u1_1.username 
    from
        user_roles u1_0 
    join
        users u1_1 
            on u1_1.id=u1_0.user_id 
    where
        u1_0.role_id=?
2025-05-25 12:41:22.625 DEBUG org.hibernate.SQL - 
    update
        roles 
    set
        description=?,
        name=?,
        updated_at=? 
    where
        id=?
2025-05-25 12:41:22.632 INFO  c.e.i.s.AdminInitializationService - Updated admin role with 0 permissions
2025-05-25 12:41:22.634 DEBUG org.hibernate.SQL - 
    select
        u1_0.id,
        u1_0.created_at,
        u1_0.email,
        u1_0.enabled,
        u1_0.full_name,
        u1_0.organization_id,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.username=?
2025-05-25 12:41:22.779 DEBUG org.hibernate.SQL - 
    insert 
    into
        users
        (created_at, email, enabled, full_name, organization_id, password, updated_at, username) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?)
2025-05-25 12:41:22.784 DEBUG org.hibernate.SQL - 
    insert 
    into
        user_roles
        (user_id, role_id) 
    values
        (?, ?)
2025-05-25 12:41:22.786 INFO  c.e.i.s.AdminInitializationService - Created admin user with username: admin
2025-05-25 12:41:23.015 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-05-25 12:41:23.203 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:41:23.209 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:41:23.212 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: POLICY_READ
2025-05-25 12:41:23.215 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:41:23.217 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:41:23.219 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ORGANIZATION_READ
2025-05-25 12:41:23.223 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:41:23.225 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:41:23.227 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: SCOPE_CREATE
2025-05-25 12:41:23.230 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:41:23.232 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:41:23.234 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ORGANIZATION_UPDATE
2025-05-25 12:41:23.235 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:41:23.238 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:41:23.241 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: POLICY_UPDATE
2025-05-25 12:41:23.243 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:41:23.246 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:41:23.248 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: POLICY_CREATE
2025-05-25 12:41:23.251 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:41:23.254 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:41:23.258 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ORGANIZATION_CREATE
2025-05-25 12:41:23.261 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:41:23.264 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:41:23.266 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: RESOURCE_READ
2025-05-25 12:41:23.267 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:41:23.269 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:41:23.271 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: SCOPE_READ
2025-05-25 12:41:23.274 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:41:23.276 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:41:23.279 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: USER_UPDATE
2025-05-25 12:41:23.282 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:41:23.284 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:41:23.286 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: RESOURCE_DELETE
2025-05-25 12:41:23.289 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:41:23.293 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:41:23.295 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ROLE_CREATE
2025-05-25 12:41:23.298 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:41:23.301 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:41:23.305 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:41:23.308 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: SCOPE_DELETE
2025-05-25 12:41:23.310 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:41:23.312 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:41:23.315 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ROLE_READ
2025-05-25 12:41:23.317 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:41:23.319 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:41:23.322 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ROLE_DELETE
2025-05-25 12:41:23.325 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:41:23.327 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:41:23.329 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: USER_READ
2025-05-25 12:41:23.332 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:41:23.334 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:41:23.336 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: CLIENT_CREATE
2025-05-25 12:41:23.339 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:41:23.342 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:41:23.345 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: SCOPE_UPDATE
2025-05-25 12:41:23.348 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:41:23.351 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:41:23.355 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: RESOURCE_UPDATE
2025-05-25 12:41:23.358 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:41:23.362 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:41:23.365 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:41:23.368 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ORGANIZATION_DELETE
2025-05-25 12:41:23.370 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:41:23.373 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:41:23.375 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: POLICY_DELETE
2025-05-25 12:41:23.377 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:41:23.380 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:41:23.382 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:41:23.384 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ROLE_UPDATE
2025-05-25 12:41:23.386 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:41:23.392 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:41:23.394 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: RESOURCE_CREATE
2025-05-25 12:41:23.397 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:41:23.399 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:41:23.402 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:41:23.404 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:41:23.407 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: USER_DELETE
2025-05-25 12:41:23.409 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:41:23.769 DEBUG o.s.s.web.DefaultSecurityFilterChain - Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, LogoutFilter, JwtAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, SessionManagementFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-05-25 12:41:24.129 INFO  o.s.b.a.h.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:testdb'
2025-05-25 12:41:24.608 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 35045 (http) with context path '/'
2025-05-25 12:41:24.626 INFO  c.e.iam.integration.AuthAndRoleTest - Started AuthAndRoleTest in 10.644 seconds (process running for 12.192)
2025-05-25 12:41:25.300 DEBUG org.hibernate.SQL - 
    select
        u1_0.id,
        u1_0.created_at,
        u1_0.email,
        u1_0.enabled,
        u1_0.full_name,
        u1_0.organization_id,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0
2025-05-25 12:41:25.310 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.name,
        r1_0.updated_at 
    from
        roles r1_0
2025-05-25 12:41:25.312 DEBUG org.hibernate.SQL - 
    select
        p1_0.role_id,
        p1_1.id,
        p1_1.created_at,
        p1_1.description,
        p1_1.name,
        p1_1.updated_at 
    from
        role_permissions p1_0 
    join
        permissions p1_1 
            on p1_1.id=p1_0.permission_id 
    where
        p1_0.role_id=?
2025-05-25 12:41:25.314 DEBUG org.hibernate.SQL - 
    select
        u1_0.role_id,
        u1_1.id,
        u1_1.created_at,
        u1_1.email,
        u1_1.enabled,
        u1_1.full_name,
        u1_1.organization_id,
        u1_1.password,
        u1_1.updated_at,
        u1_1.username 
    from
        user_roles u1_0 
    join
        users u1_1 
            on u1_1.id=u1_0.user_id 
    where
        u1_0.role_id=?
2025-05-25 12:41:25.319 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0
2025-05-25 12:41:25.331 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:41:25.333 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:41:25.335 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:41:25.336 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:41:25.338 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:41:25.340 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:41:25.342 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:41:25.344 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:41:25.345 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:41:25.346 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:41:25.347 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:41:25.348 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:41:25.349 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:41:25.350 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:41:25.352 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:41:25.355 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:41:25.357 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:41:25.358 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:41:25.359 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:41:25.359 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:41:25.360 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:41:25.361 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:41:25.362 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:41:25.363 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:41:25.364 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:41:25.365 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:41:25.366 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:41:25.367 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:41:25.369 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:41:25.370 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:41:25.371 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:41:25.373 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:41:25.375 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:41:25.376 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:41:25.377 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:41:25.378 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:41:25.379 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:41:25.379 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:41:25.380 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:41:25.381 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:41:25.381 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:41:25.382 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:41:25.383 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:41:25.384 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:41:25.385 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:41:25.388 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:41:25.390 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:41:25.391 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:41:25.397 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.http_method,
        r1_0.name,
        r1_0.path,
        r1_0.updated_at 
    from
        resources r1_0
2025-05-25 12:41:25.402 DEBUG org.hibernate.SQL - 
    delete 
    from
        user_roles 
    where
        user_id=?
2025-05-25 12:41:25.407 DEBUG org.hibernate.SQL - 
    delete 
    from
        user_scopes 
    where
        user_id=?
2025-05-25 12:41:25.410 DEBUG org.hibernate.SQL - 
    delete 
    from
        users 
    where
        id=?
2025-05-25 12:41:25.415 DEBUG org.hibernate.SQL - 
    delete 
    from
        roles 
    where
        id=?
2025-05-25 12:41:25.416 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:41:25.417 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:41:25.418 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:41:25.419 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:41:25.421 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:41:25.422 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:41:25.424 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:41:25.425 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:41:25.426 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:41:25.426 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:41:25.427 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:41:25.428 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:41:25.428 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:41:25.429 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:41:25.429 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:41:25.430 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:41:25.431 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:41:25.431 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:41:25.432 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:41:25.433 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:41:25.433 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:41:25.434 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:41:25.434 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:41:25.436 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:41:25.442 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:41:25.446 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:41:25.450 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:41:25.454 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:41:25.459 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:41:25.461 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:41:25.464 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:41:25.466 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:41:25.470 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:41:25.474 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:41:25.478 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:41:25.479 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:41:25.483 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:41:25.485 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:41:25.491 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:41:25.492 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:41:25.495 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:41:25.497 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:41:25.500 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:41:25.501 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:41:25.507 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:41:25.509 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:41:25.512 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:41:25.514 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:41:25.518 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:41:25.522 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:41:25.526 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:41:25.528 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:41:25.531 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:41:25.533 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:41:25.536 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:41:25.539 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:41:25.543 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:41:25.545 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:41:25.948 DEBUG org.hibernate.SQL - 
    select
        count(*) 
    from
        permissions p1_0
2025-05-25 12:41:25.950 INFO  c.e.iam.integration.AuthAndRoleTest - Permissions created. Total permissions: 17
2025-05-25 12:41:25.955 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.name,
        r1_0.updated_at 
    from
        roles r1_0 
    where
        r1_0.name=?
2025-05-25 12:41:25.962 DEBUG org.hibernate.SQL - 
    insert 
    into
        roles
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:41:25.966 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:41:25.966 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:41:25.967 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:41:25.967 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:41:25.967 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:41:25.968 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:41:25.969 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:41:25.970 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:41:25.970 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:41:25.971 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:41:25.972 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:41:25.973 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:41:25.975 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:41:25.976 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:41:25.977 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:41:25.977 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:41:25.978 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:41:25.981 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.name,
        r1_0.updated_at 
    from
        roles r1_0 
    where
        r1_0.id=?
2025-05-25 12:41:25.983 DEBUG org.hibernate.SQL - 
    select
        p1_0.role_id,
        p1_1.id,
        p1_1.created_at,
        p1_1.description,
        p1_1.name,
        p1_1.updated_at 
    from
        role_permissions p1_0 
    join
        permissions p1_1 
            on p1_1.id=p1_0.permission_id 
    where
        p1_0.role_id=?
2025-05-25 12:41:25.993 INFO  c.e.iam.integration.AuthAndRoleTest - Admin role after save - Permissions size: 17
2025-05-25 12:41:25.994 INFO  c.e.iam.integration.AuthAndRoleTest - Admin role permissions: [ROLE_UPDATE, USER_READ, SCOPE_CREATE, SCOPE_UPDATE, RESOURCE_UPDATE, ROLE_DELETE, SCOPE_DELETE, RESOURCE_DELETE, RESOURCE_CREATE, ORGANIZATION_UPDATE, POLICY_DELETE, ORGANIZATION_DELETE, ROLE_CREATE, ORGANIZATION_READ, POLICY_READ, ORGANIZATION_CREATE, POLICY_CREATE]
2025-05-25 12:41:25.997 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.name,
        r1_0.updated_at 
    from
        roles r1_0 
    where
        r1_0.name=?
2025-05-25 12:41:25.999 DEBUG org.hibernate.SQL - 
    insert 
    into
        roles
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:41:26.134 INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-05-25 12:41:26.141 INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-05-25 12:41:26.149 DEBUG org.hibernate.SQL - 
    set client_min_messages = WARNING
2025-05-25 12:41:26.151 ERROR o.h.t.s.i.SchemaDropperImpl$DelayedDropActionImpl - HHH000478: Unsuccessful: 
    set client_min_messages = WARNING
2025-05-25 12:41:26.152 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       drop constraint if exists FK21l4ab5xsq7rxwb7b2efptbmt
2025-05-25 12:41:26.154 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       drop constraint if exists FK4glu0kw16kw6gu23yr5q6vjme
2025-05-25 12:41:26.154 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       drop constraint if exists FK3smj35weuy4b1fj396l5jvt6g
2025-05-25 12:41:26.155 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       drop constraint if exists FKacyhrlymxo934q9c4n441dhwf
2025-05-25 12:41:26.157 DEBUG org.hibernate.SQL - 
    alter table if exists policies 
       drop constraint if exists FKs49d98df3xexcyui98cwpek9p
2025-05-25 12:41:26.158 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       drop constraint if exists FKegdk29eiy7mdtefy5c7eirr6e
2025-05-25 12:41:26.158 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       drop constraint if exists FKn5fotdgk8d1xvo8nav9uv3muc
2025-05-25 12:41:26.159 DEBUG org.hibernate.SQL - 
    alter table if exists tokens 
       drop constraint if exists FK2dylsfo39lgjyqml2tbe0b0ss
2025-05-25 12:41:26.160 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       drop constraint if exists FKh8ciramu9cc9q3qcqiv4ue8a6
2025-05-25 12:41:26.160 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       drop constraint if exists FKhfh9dx7w3ubf1co1vdev94g3f
2025-05-25 12:41:26.161 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       drop constraint if exists FK4gc7xv8r1p0j6ykgn5h4nx934
2025-05-25 12:41:26.162 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       drop constraint if exists FKspv2c7f3cxhd1242nkabx95s5
2025-05-25 12:41:26.162 DEBUG org.hibernate.SQL - 
    alter table if exists users 
       drop constraint if exists FKqpugllwvyv37klq7ft9m8aqxk
2025-05-25 12:41:26.163 DEBUG org.hibernate.SQL - 
    drop table if exists client_applications cascade
2025-05-25 12:41:26.167 DEBUG org.hibernate.SQL - 
    drop table if exists client_scopes cascade
2025-05-25 12:41:26.169 DEBUG org.hibernate.SQL - 
    drop table if exists organizations cascade
2025-05-25 12:41:26.170 DEBUG org.hibernate.SQL - 
    drop table if exists permission_scopes cascade
2025-05-25 12:41:26.171 DEBUG org.hibernate.SQL - 
    drop table if exists permissions cascade
2025-05-25 12:41:26.174 DEBUG org.hibernate.SQL - 
    drop table if exists policies cascade
2025-05-25 12:41:26.175 DEBUG org.hibernate.SQL - 
    drop table if exists resources cascade
2025-05-25 12:41:26.176 DEBUG org.hibernate.SQL - 
    drop table if exists role_permissions cascade
2025-05-25 12:41:26.177 DEBUG org.hibernate.SQL - 
    drop table if exists roles cascade
2025-05-25 12:41:26.179 DEBUG org.hibernate.SQL - 
    drop table if exists scopes cascade
2025-05-25 12:41:26.180 DEBUG org.hibernate.SQL - 
    drop table if exists tokens cascade
2025-05-25 12:41:26.180 DEBUG org.hibernate.SQL - 
    drop table if exists user_roles cascade
2025-05-25 12:41:26.181 DEBUG org.hibernate.SQL - 
    drop table if exists user_scopes cascade
2025-05-25 12:41:26.182 DEBUG org.hibernate.SQL - 
    drop table if exists users cascade
2025-05-25 12:41:26.189 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-25 12:41:26.192 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-25 12:43:03.667 INFO  c.e.iam.integration.AuthAndRoleTest - Starting AuthAndRoleTest using Java 21.0.7 with PID 31331 (started by descent in /home/descent/Documents/VDT/vdt5-iam-system/iam-service)
2025-05-25 12:43:03.669 DEBUG c.e.iam.integration.AuthAndRoleTest - Running with Spring Boot v3.4.5, Spring v6.2.6
2025-05-25 12:43:03.671 INFO  c.e.iam.integration.AuthAndRoleTest - The following 1 profile is active: "test"
2025-05-25 12:43:04.710 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-05-25 12:43:04.819 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 98 ms. Found 9 JPA repository interfaces.
2025-05-25 12:43:05.805 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 0 (http)
2025-05-25 12:43:05.822 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-25 12:43:05.822 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.40]
2025-05-25 12:43:05.879 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-25 12:43:05.880 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2184 ms
2025-05-25 12:43:06.475 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-25 12:43:06.687 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:testdb user=SA
2025-05-25 12:43:06.704 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-25 12:43:07.963 DEBUG org.hibernate.SQL - 
    set client_min_messages = WARNING
2025-05-25 12:43:07.968 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       drop constraint if exists FK21l4ab5xsq7rxwb7b2efptbmt
2025-05-25 12:43:07.969 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       drop constraint if exists FK4glu0kw16kw6gu23yr5q6vjme
2025-05-25 12:43:07.969 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       drop constraint if exists FK3smj35weuy4b1fj396l5jvt6g
2025-05-25 12:43:07.969 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       drop constraint if exists FKacyhrlymxo934q9c4n441dhwf
2025-05-25 12:43:07.970 DEBUG org.hibernate.SQL - 
    alter table if exists policies 
       drop constraint if exists FKs49d98df3xexcyui98cwpek9p
2025-05-25 12:43:07.970 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       drop constraint if exists FKegdk29eiy7mdtefy5c7eirr6e
2025-05-25 12:43:07.971 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       drop constraint if exists FKn5fotdgk8d1xvo8nav9uv3muc
2025-05-25 12:43:07.971 DEBUG org.hibernate.SQL - 
    alter table if exists tokens 
       drop constraint if exists FK2dylsfo39lgjyqml2tbe0b0ss
2025-05-25 12:43:07.971 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       drop constraint if exists FKh8ciramu9cc9q3qcqiv4ue8a6
2025-05-25 12:43:07.972 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       drop constraint if exists FKhfh9dx7w3ubf1co1vdev94g3f
2025-05-25 12:43:07.972 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       drop constraint if exists FK4gc7xv8r1p0j6ykgn5h4nx934
2025-05-25 12:43:07.973 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       drop constraint if exists FKspv2c7f3cxhd1242nkabx95s5
2025-05-25 12:43:07.973 DEBUG org.hibernate.SQL - 
    alter table if exists users 
       drop constraint if exists FKqpugllwvyv37klq7ft9m8aqxk
2025-05-25 12:43:07.974 DEBUG org.hibernate.SQL - 
    drop table if exists client_applications cascade
2025-05-25 12:43:07.974 DEBUG org.hibernate.SQL - 
    drop table if exists client_scopes cascade
2025-05-25 12:43:07.975 DEBUG org.hibernate.SQL - 
    drop table if exists organizations cascade
2025-05-25 12:43:07.975 DEBUG org.hibernate.SQL - 
    drop table if exists permission_scopes cascade
2025-05-25 12:43:07.976 DEBUG org.hibernate.SQL - 
    drop table if exists permissions cascade
2025-05-25 12:43:07.976 DEBUG org.hibernate.SQL - 
    drop table if exists policies cascade
2025-05-25 12:43:07.977 DEBUG org.hibernate.SQL - 
    drop table if exists resources cascade
2025-05-25 12:43:07.978 DEBUG org.hibernate.SQL - 
    drop table if exists role_permissions cascade
2025-05-25 12:43:07.978 DEBUG org.hibernate.SQL - 
    drop table if exists roles cascade
2025-05-25 12:43:07.979 DEBUG org.hibernate.SQL - 
    drop table if exists scopes cascade
2025-05-25 12:43:07.980 DEBUG org.hibernate.SQL - 
    drop table if exists tokens cascade
2025-05-25 12:43:07.980 DEBUG org.hibernate.SQL - 
    drop table if exists user_roles cascade
2025-05-25 12:43:07.980 DEBUG org.hibernate.SQL - 
    drop table if exists user_scopes cascade
2025-05-25 12:43:07.981 DEBUG org.hibernate.SQL - 
    drop table if exists users cascade
2025-05-25 12:43:07.989 DEBUG org.hibernate.SQL - 
    create table client_applications (
        is_active boolean,
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        client_id varchar(100) not null unique,
        name varchar(100) not null,
        client_secret varchar(255) not null,
        description TEXT,
        redirect_uri varchar(255),
        primary key (id)
    )
2025-05-25 12:43:08.002 DEBUG org.hibernate.SQL - 
    create table client_scopes (
        client_id bigint not null,
        scope_id bigint not null,
        primary key (client_id, scope_id)
    )
2025-05-25 12:43:08.005 DEBUG org.hibernate.SQL - 
    create table organizations (
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        description varchar(1000),
        name varchar(255) not null unique,
        primary key (id)
    )
2025-05-25 12:43:08.008 DEBUG org.hibernate.SQL - 
    create table permission_scopes (
        permission_id bigint not null,
        scope_id bigint not null,
        primary key (permission_id, scope_id)
    )
2025-05-25 12:43:08.010 DEBUG org.hibernate.SQL - 
    create table permissions (
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        name varchar(100) not null unique,
        description TEXT,
        primary key (id)
    )
2025-05-25 12:43:08.012 DEBUG org.hibernate.SQL - 
    create table policies (
        subject_type smallint not null check (subject_type between 0 and 3),
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        resource_id bigint not null,
        subject_id bigint not null,
        updated_at timestamp(6) not null,
        action varchar(255) not null,
        condition_json TEXT,
        effect varchar(255) not null check (effect in ('ALLOW','DENY')),
        primary key (id)
    )
2025-05-25 12:43:08.019 DEBUG org.hibernate.SQL - 
    create table resources (
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        name varchar(100) not null,
        description TEXT,
        http_method varchar(255) not null check (http_method in ('GET','POST','PUT','DELETE','PATCH','HEAD','OPTIONS')),
        path varchar(255) not null,
        primary key (id)
    )
2025-05-25 12:43:08.023 DEBUG org.hibernate.SQL - 
    create table role_permissions (
        permission_id bigint not null,
        role_id bigint not null,
        primary key (permission_id, role_id)
    )
2025-05-25 12:43:08.025 DEBUG org.hibernate.SQL - 
    create table roles (
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        name varchar(50) not null unique,
        description TEXT,
        primary key (id)
    )
2025-05-25 12:43:08.030 DEBUG org.hibernate.SQL - 
    create table scopes (
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        name varchar(100) not null unique,
        description TEXT,
        primary key (id)
    )
2025-05-25 12:43:08.031 DEBUG org.hibernate.SQL - 
    create table tokens (
        expired boolean not null,
        revoked boolean not null,
        created_at timestamp(6) not null,
        expires_at timestamp(6) not null,
        token_id bigint generated by default as identity,
        user_id bigint,
        client_id varchar(255),
        token TEXT not null,
        token_type varchar(255) not null check (token_type in ('ACCESS','REFRESH')),
        primary key (token_id)
    )
2025-05-25 12:43:08.033 DEBUG org.hibernate.SQL - 
    create table user_roles (
        role_id bigint not null,
        user_id bigint not null,
        primary key (role_id, user_id)
    )
2025-05-25 12:43:08.034 DEBUG org.hibernate.SQL - 
    create table user_scopes (
        scope_id bigint not null,
        user_id bigint not null,
        primary key (scope_id, user_id)
    )
2025-05-25 12:43:08.035 DEBUG org.hibernate.SQL - 
    create table users (
        enabled boolean not null,
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        organization_id bigint,
        updated_at timestamp(6) not null,
        username varchar(50) not null unique,
        password varchar(100) not null,
        email varchar(255) not null unique,
        full_name varchar(255),
        primary key (id)
    )
2025-05-25 12:43:08.037 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       add constraint FK21l4ab5xsq7rxwb7b2efptbmt 
       foreign key (scope_id) 
       references scopes
2025-05-25 12:43:08.050 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       add constraint FK4glu0kw16kw6gu23yr5q6vjme 
       foreign key (client_id) 
       references client_applications
2025-05-25 12:43:08.052 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       add constraint FK3smj35weuy4b1fj396l5jvt6g 
       foreign key (scope_id) 
       references scopes
2025-05-25 12:43:08.054 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       add constraint FKacyhrlymxo934q9c4n441dhwf 
       foreign key (permission_id) 
       references permissions
2025-05-25 12:43:08.058 DEBUG org.hibernate.SQL - 
    alter table if exists policies 
       add constraint FKs49d98df3xexcyui98cwpek9p 
       foreign key (resource_id) 
       references resources
2025-05-25 12:43:08.060 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       add constraint FKegdk29eiy7mdtefy5c7eirr6e 
       foreign key (permission_id) 
       references permissions
2025-05-25 12:43:08.063 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       add constraint FKn5fotdgk8d1xvo8nav9uv3muc 
       foreign key (role_id) 
       references roles
2025-05-25 12:43:08.065 DEBUG org.hibernate.SQL - 
    alter table if exists tokens 
       add constraint FK2dylsfo39lgjyqml2tbe0b0ss 
       foreign key (user_id) 
       references users
2025-05-25 12:43:08.067 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       add constraint FKh8ciramu9cc9q3qcqiv4ue8a6 
       foreign key (role_id) 
       references roles
2025-05-25 12:43:08.069 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       add constraint FKhfh9dx7w3ubf1co1vdev94g3f 
       foreign key (user_id) 
       references users
2025-05-25 12:43:08.070 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       add constraint FK4gc7xv8r1p0j6ykgn5h4nx934 
       foreign key (scope_id) 
       references scopes
2025-05-25 12:43:08.073 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       add constraint FKspv2c7f3cxhd1242nkabx95s5 
       foreign key (user_id) 
       references users
2025-05-25 12:43:08.075 DEBUG org.hibernate.SQL - 
    alter table if exists users 
       add constraint FKqpugllwvyv37klq7ft9m8aqxk 
       foreign key (organization_id) 
       references organizations
2025-05-25 12:43:08.598 DEBUG c.e.i.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-05-25 12:43:08.658 INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name customUserDetailsService
2025-05-25 12:43:09.083 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.name,
        r1_0.updated_at 
    from
        roles r1_0 
    where
        r1_0.name=?
2025-05-25 12:43:09.198 DEBUG org.hibernate.SQL - 
    insert 
    into
        roles
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:43:09.247 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0
2025-05-25 12:43:09.260 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.name,
        p1_0.role_id,
        p1_1.id,
        p1_1.created_at,
        p1_1.description,
        p1_1.name,
        p1_1.updated_at,
        r1_0.updated_at 
    from
        roles r1_0 
    left join
        role_permissions p1_0 
            on r1_0.id=p1_0.role_id 
    left join
        permissions p1_1 
            on p1_1.id=p1_0.permission_id 
    where
        r1_0.id=?
2025-05-25 12:43:09.267 DEBUG org.hibernate.SQL - 
    select
        u1_0.role_id,
        u1_1.id,
        u1_1.created_at,
        u1_1.email,
        u1_1.enabled,
        u1_1.full_name,
        u1_1.organization_id,
        u1_1.password,
        u1_1.updated_at,
        u1_1.username 
    from
        user_roles u1_0 
    join
        users u1_1 
            on u1_1.id=u1_0.user_id 
    where
        u1_0.role_id=?
2025-05-25 12:43:09.277 DEBUG org.hibernate.SQL - 
    update
        roles 
    set
        description=?,
        name=?,
        updated_at=? 
    where
        id=?
2025-05-25 12:43:09.282 INFO  c.e.i.s.AdminInitializationService - Updated admin role with 0 permissions
2025-05-25 12:43:09.285 DEBUG org.hibernate.SQL - 
    select
        u1_0.id,
        u1_0.created_at,
        u1_0.email,
        u1_0.enabled,
        u1_0.full_name,
        u1_0.organization_id,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.username=?
2025-05-25 12:43:09.416 DEBUG org.hibernate.SQL - 
    insert 
    into
        users
        (created_at, email, enabled, full_name, organization_id, password, updated_at, username) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?)
2025-05-25 12:43:09.419 DEBUG org.hibernate.SQL - 
    insert 
    into
        user_roles
        (user_id, role_id) 
    values
        (?, ?)
2025-05-25 12:43:09.422 INFO  c.e.i.s.AdminInitializationService - Created admin user with username: admin
2025-05-25 12:43:09.557 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-05-25 12:43:09.693 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:43:09.698 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:43:09.700 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: POLICY_READ
2025-05-25 12:43:09.702 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:43:09.703 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:43:09.705 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ORGANIZATION_READ
2025-05-25 12:43:09.708 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:43:09.710 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:43:09.711 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: SCOPE_CREATE
2025-05-25 12:43:09.713 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:43:09.715 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:43:09.717 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ORGANIZATION_UPDATE
2025-05-25 12:43:09.719 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:43:09.722 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:43:09.724 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: POLICY_UPDATE
2025-05-25 12:43:09.725 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:43:09.727 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:43:09.729 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: POLICY_CREATE
2025-05-25 12:43:09.730 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:43:09.732 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:43:09.734 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ORGANIZATION_CREATE
2025-05-25 12:43:09.735 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:43:09.737 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:43:09.739 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: RESOURCE_READ
2025-05-25 12:43:09.741 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:43:09.743 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:43:09.744 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: SCOPE_READ
2025-05-25 12:43:09.746 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:43:09.748 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:43:09.750 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: USER_UPDATE
2025-05-25 12:43:09.751 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:43:09.754 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:43:09.756 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: RESOURCE_DELETE
2025-05-25 12:43:09.758 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:43:09.760 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:43:09.761 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ROLE_CREATE
2025-05-25 12:43:09.762 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:43:09.765 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:43:09.767 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:43:09.768 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: SCOPE_DELETE
2025-05-25 12:43:09.770 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:43:09.772 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:43:09.774 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ROLE_READ
2025-05-25 12:43:09.775 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:43:09.777 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:43:09.778 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ROLE_DELETE
2025-05-25 12:43:09.780 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:43:09.781 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:43:09.783 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: USER_READ
2025-05-25 12:43:09.785 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:43:09.788 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:43:09.791 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: CLIENT_CREATE
2025-05-25 12:43:09.793 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:43:09.795 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:43:09.797 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: SCOPE_UPDATE
2025-05-25 12:43:09.798 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:43:09.800 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:43:09.801 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: RESOURCE_UPDATE
2025-05-25 12:43:09.803 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:43:09.806 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:43:09.807 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:43:09.809 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ORGANIZATION_DELETE
2025-05-25 12:43:09.811 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:43:09.812 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:43:09.814 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: POLICY_DELETE
2025-05-25 12:43:09.816 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:43:09.819 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:43:09.822 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:43:09.824 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ROLE_UPDATE
2025-05-25 12:43:09.826 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:43:09.827 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:43:09.829 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: RESOURCE_CREATE
2025-05-25 12:43:09.830 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:43:09.832 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:43:09.834 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:43:09.836 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:43:09.838 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: USER_DELETE
2025-05-25 12:43:09.840 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:43:10.149 DEBUG o.s.s.web.DefaultSecurityFilterChain - Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, LogoutFilter, JwtAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, SessionManagementFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-05-25 12:43:10.467 INFO  o.s.b.a.h.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:testdb'
2025-05-25 12:43:10.789 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 33037 (http) with context path '/'
2025-05-25 12:43:10.799 INFO  c.e.iam.integration.AuthAndRoleTest - Started AuthAndRoleTest in 7.705 seconds (process running for 8.877)
2025-05-25 12:43:11.328 DEBUG org.hibernate.SQL - 
    select
        u1_0.id,
        u1_0.created_at,
        u1_0.email,
        u1_0.enabled,
        u1_0.full_name,
        u1_0.organization_id,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0
2025-05-25 12:43:11.334 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.name,
        r1_0.updated_at 
    from
        roles r1_0
2025-05-25 12:43:11.335 DEBUG org.hibernate.SQL - 
    select
        p1_0.role_id,
        p1_1.id,
        p1_1.created_at,
        p1_1.description,
        p1_1.name,
        p1_1.updated_at 
    from
        role_permissions p1_0 
    join
        permissions p1_1 
            on p1_1.id=p1_0.permission_id 
    where
        p1_0.role_id=?
2025-05-25 12:43:11.337 DEBUG org.hibernate.SQL - 
    select
        u1_0.role_id,
        u1_1.id,
        u1_1.created_at,
        u1_1.email,
        u1_1.enabled,
        u1_1.full_name,
        u1_1.organization_id,
        u1_1.password,
        u1_1.updated_at,
        u1_1.username 
    from
        user_roles u1_0 
    join
        users u1_1 
            on u1_1.id=u1_0.user_id 
    where
        u1_0.role_id=?
2025-05-25 12:43:11.340 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0
2025-05-25 12:43:11.347 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:43:11.348 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:43:11.349 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:43:11.350 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:43:11.351 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:43:11.352 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:43:11.353 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:43:11.354 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:43:11.355 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:43:11.356 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:43:11.357 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:43:11.357 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:43:11.358 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:43:11.358 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:43:11.359 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:43:11.360 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:43:11.360 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:43:11.361 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:43:11.362 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:43:11.362 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:43:11.363 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:43:11.363 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:43:11.364 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:43:11.364 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:43:11.365 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:43:11.365 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:43:11.366 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:43:11.366 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:43:11.367 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:43:11.367 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:43:11.368 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:43:11.368 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:43:11.369 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:43:11.370 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:43:11.370 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:43:11.371 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:43:11.371 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:43:11.372 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:43:11.372 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:43:11.373 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:43:11.373 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:43:11.374 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:43:11.374 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:43:11.375 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:43:11.375 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:43:11.376 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:43:11.376 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:43:11.377 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:43:11.379 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.http_method,
        r1_0.name,
        r1_0.path,
        r1_0.updated_at 
    from
        resources r1_0
2025-05-25 12:43:11.382 DEBUG org.hibernate.SQL - 
    delete 
    from
        user_roles 
    where
        user_id=?
2025-05-25 12:43:11.384 DEBUG org.hibernate.SQL - 
    delete 
    from
        user_scopes 
    where
        user_id=?
2025-05-25 12:43:11.387 DEBUG org.hibernate.SQL - 
    delete 
    from
        users 
    where
        id=?
2025-05-25 12:43:11.390 DEBUG org.hibernate.SQL - 
    delete 
    from
        roles 
    where
        id=?
2025-05-25 12:43:11.391 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:43:11.392 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:43:11.393 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:43:11.393 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:43:11.394 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:43:11.394 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:43:11.395 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:43:11.395 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:43:11.396 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:43:11.396 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:43:11.397 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:43:11.397 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:43:11.398 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:43:11.398 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:43:11.398 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:43:11.399 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:43:11.399 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:43:11.400 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:43:11.400 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:43:11.401 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:43:11.402 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:43:11.402 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:43:11.403 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:43:11.403 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:43:11.407 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:43:11.409 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:43:11.411 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:43:11.412 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:43:11.415 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:43:11.417 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:43:11.423 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:43:11.425 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:43:11.428 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:43:11.430 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:43:11.433 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:43:11.436 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:43:11.440 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:43:11.443 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:43:11.447 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:43:11.448 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:43:11.451 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:43:11.455 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:43:11.459 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:43:11.461 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:43:11.465 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:43:11.466 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:43:11.471 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:43:11.474 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:43:11.478 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:43:11.479 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:43:11.482 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:43:11.484 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:43:11.489 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:43:11.491 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:43:11.494 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:43:11.495 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:43:11.498 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:43:11.498 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:43:11.955 DEBUG org.hibernate.SQL - 
    select
        count(*) 
    from
        permissions p1_0
2025-05-25 12:43:11.957 INFO  c.e.iam.integration.AuthAndRoleTest - Permissions created. Total permissions: 17
2025-05-25 12:43:11.959 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.name,
        r1_0.updated_at 
    from
        roles r1_0 
    where
        r1_0.name=?
2025-05-25 12:43:11.961 DEBUG org.hibernate.SQL - 
    insert 
    into
        roles
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:43:12.067 INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-05-25 12:43:12.073 INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-05-25 12:43:12.084 DEBUG org.hibernate.SQL - 
    set client_min_messages = WARNING
2025-05-25 12:43:12.086 ERROR o.h.t.s.i.SchemaDropperImpl$DelayedDropActionImpl - HHH000478: Unsuccessful: 
    set client_min_messages = WARNING
2025-05-25 12:43:12.086 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       drop constraint if exists FK21l4ab5xsq7rxwb7b2efptbmt
2025-05-25 12:43:12.089 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       drop constraint if exists FK4glu0kw16kw6gu23yr5q6vjme
2025-05-25 12:43:12.090 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       drop constraint if exists FK3smj35weuy4b1fj396l5jvt6g
2025-05-25 12:43:12.091 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       drop constraint if exists FKacyhrlymxo934q9c4n441dhwf
2025-05-25 12:43:12.092 DEBUG org.hibernate.SQL - 
    alter table if exists policies 
       drop constraint if exists FKs49d98df3xexcyui98cwpek9p
2025-05-25 12:43:12.093 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       drop constraint if exists FKegdk29eiy7mdtefy5c7eirr6e
2025-05-25 12:43:12.093 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       drop constraint if exists FKn5fotdgk8d1xvo8nav9uv3muc
2025-05-25 12:43:12.094 DEBUG org.hibernate.SQL - 
    alter table if exists tokens 
       drop constraint if exists FK2dylsfo39lgjyqml2tbe0b0ss
2025-05-25 12:43:12.095 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       drop constraint if exists FKh8ciramu9cc9q3qcqiv4ue8a6
2025-05-25 12:43:12.096 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       drop constraint if exists FKhfh9dx7w3ubf1co1vdev94g3f
2025-05-25 12:43:12.096 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       drop constraint if exists FK4gc7xv8r1p0j6ykgn5h4nx934
2025-05-25 12:43:12.096 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       drop constraint if exists FKspv2c7f3cxhd1242nkabx95s5
2025-05-25 12:43:12.097 DEBUG org.hibernate.SQL - 
    alter table if exists users 
       drop constraint if exists FKqpugllwvyv37klq7ft9m8aqxk
2025-05-25 12:43:12.097 DEBUG org.hibernate.SQL - 
    drop table if exists client_applications cascade
2025-05-25 12:43:12.099 DEBUG org.hibernate.SQL - 
    drop table if exists client_scopes cascade
2025-05-25 12:43:12.100 DEBUG org.hibernate.SQL - 
    drop table if exists organizations cascade
2025-05-25 12:43:12.101 DEBUG org.hibernate.SQL - 
    drop table if exists permission_scopes cascade
2025-05-25 12:43:12.102 DEBUG org.hibernate.SQL - 
    drop table if exists permissions cascade
2025-05-25 12:43:12.103 DEBUG org.hibernate.SQL - 
    drop table if exists policies cascade
2025-05-25 12:43:12.104 DEBUG org.hibernate.SQL - 
    drop table if exists resources cascade
2025-05-25 12:43:12.105 DEBUG org.hibernate.SQL - 
    drop table if exists role_permissions cascade
2025-05-25 12:43:12.106 DEBUG org.hibernate.SQL - 
    drop table if exists roles cascade
2025-05-25 12:43:12.107 DEBUG org.hibernate.SQL - 
    drop table if exists scopes cascade
2025-05-25 12:43:12.109 DEBUG org.hibernate.SQL - 
    drop table if exists tokens cascade
2025-05-25 12:43:12.110 DEBUG org.hibernate.SQL - 
    drop table if exists user_roles cascade
2025-05-25 12:43:12.110 DEBUG org.hibernate.SQL - 
    drop table if exists user_scopes cascade
2025-05-25 12:43:12.110 DEBUG org.hibernate.SQL - 
    drop table if exists users cascade
2025-05-25 12:43:12.113 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-25 12:43:12.115 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-25 12:44:21.937 INFO  c.e.iam.integration.AuthAndRoleTest - Starting AuthAndRoleTest using Java 21.0.7 with PID 32594 (started by descent in /home/descent/Documents/VDT/vdt5-iam-system/iam-service)
2025-05-25 12:44:21.939 DEBUG c.e.iam.integration.AuthAndRoleTest - Running with Spring Boot v3.4.5, Spring v6.2.6
2025-05-25 12:44:21.940 INFO  c.e.iam.integration.AuthAndRoleTest - The following 1 profile is active: "test"
2025-05-25 12:44:22.987 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-05-25 12:44:23.098 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 101 ms. Found 9 JPA repository interfaces.
2025-05-25 12:44:24.061 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 0 (http)
2025-05-25 12:44:24.080 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-25 12:44:24.081 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.40]
2025-05-25 12:44:24.156 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-25 12:44:24.156 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2194 ms
2025-05-25 12:44:24.772 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-25 12:44:24.975 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:testdb user=SA
2025-05-25 12:44:24.977 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-25 12:44:26.311 DEBUG org.hibernate.SQL - 
    set client_min_messages = WARNING
2025-05-25 12:44:26.318 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       drop constraint if exists FK21l4ab5xsq7rxwb7b2efptbmt
2025-05-25 12:44:26.319 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       drop constraint if exists FK4glu0kw16kw6gu23yr5q6vjme
2025-05-25 12:44:26.319 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       drop constraint if exists FK3smj35weuy4b1fj396l5jvt6g
2025-05-25 12:44:26.319 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       drop constraint if exists FKacyhrlymxo934q9c4n441dhwf
2025-05-25 12:44:26.320 DEBUG org.hibernate.SQL - 
    alter table if exists policies 
       drop constraint if exists FKs49d98df3xexcyui98cwpek9p
2025-05-25 12:44:26.320 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       drop constraint if exists FKegdk29eiy7mdtefy5c7eirr6e
2025-05-25 12:44:26.320 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       drop constraint if exists FKn5fotdgk8d1xvo8nav9uv3muc
2025-05-25 12:44:26.321 DEBUG org.hibernate.SQL - 
    alter table if exists tokens 
       drop constraint if exists FK2dylsfo39lgjyqml2tbe0b0ss
2025-05-25 12:44:26.321 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       drop constraint if exists FKh8ciramu9cc9q3qcqiv4ue8a6
2025-05-25 12:44:26.322 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       drop constraint if exists FKhfh9dx7w3ubf1co1vdev94g3f
2025-05-25 12:44:26.322 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       drop constraint if exists FK4gc7xv8r1p0j6ykgn5h4nx934
2025-05-25 12:44:26.322 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       drop constraint if exists FKspv2c7f3cxhd1242nkabx95s5
2025-05-25 12:44:26.323 DEBUG org.hibernate.SQL - 
    alter table if exists users 
       drop constraint if exists FKqpugllwvyv37klq7ft9m8aqxk
2025-05-25 12:44:26.324 DEBUG org.hibernate.SQL - 
    drop table if exists client_applications cascade
2025-05-25 12:44:26.325 DEBUG org.hibernate.SQL - 
    drop table if exists client_scopes cascade
2025-05-25 12:44:26.325 DEBUG org.hibernate.SQL - 
    drop table if exists organizations cascade
2025-05-25 12:44:26.325 DEBUG org.hibernate.SQL - 
    drop table if exists permission_scopes cascade
2025-05-25 12:44:26.326 DEBUG org.hibernate.SQL - 
    drop table if exists permissions cascade
2025-05-25 12:44:26.326 DEBUG org.hibernate.SQL - 
    drop table if exists policies cascade
2025-05-25 12:44:26.327 DEBUG org.hibernate.SQL - 
    drop table if exists resources cascade
2025-05-25 12:44:26.327 DEBUG org.hibernate.SQL - 
    drop table if exists role_permissions cascade
2025-05-25 12:44:26.327 DEBUG org.hibernate.SQL - 
    drop table if exists roles cascade
2025-05-25 12:44:26.328 DEBUG org.hibernate.SQL - 
    drop table if exists scopes cascade
2025-05-25 12:44:26.328 DEBUG org.hibernate.SQL - 
    drop table if exists tokens cascade
2025-05-25 12:44:26.329 DEBUG org.hibernate.SQL - 
    drop table if exists user_roles cascade
2025-05-25 12:44:26.329 DEBUG org.hibernate.SQL - 
    drop table if exists user_scopes cascade
2025-05-25 12:44:26.329 DEBUG org.hibernate.SQL - 
    drop table if exists users cascade
2025-05-25 12:44:26.335 DEBUG org.hibernate.SQL - 
    create table client_applications (
        is_active boolean,
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        client_id varchar(100) not null unique,
        name varchar(100) not null,
        client_secret varchar(255) not null,
        description TEXT,
        redirect_uri varchar(255),
        primary key (id)
    )
2025-05-25 12:44:26.345 DEBUG org.hibernate.SQL - 
    create table client_scopes (
        client_id bigint not null,
        scope_id bigint not null,
        primary key (client_id, scope_id)
    )
2025-05-25 12:44:26.347 DEBUG org.hibernate.SQL - 
    create table organizations (
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        description varchar(1000),
        name varchar(255) not null unique,
        primary key (id)
    )
2025-05-25 12:44:26.350 DEBUG org.hibernate.SQL - 
    create table permission_scopes (
        permission_id bigint not null,
        scope_id bigint not null,
        primary key (permission_id, scope_id)
    )
2025-05-25 12:44:26.351 DEBUG org.hibernate.SQL - 
    create table permissions (
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        name varchar(100) not null unique,
        description TEXT,
        primary key (id)
    )
2025-05-25 12:44:26.353 DEBUG org.hibernate.SQL - 
    create table policies (
        subject_type smallint not null check (subject_type between 0 and 3),
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        resource_id bigint not null,
        subject_id bigint not null,
        updated_at timestamp(6) not null,
        action varchar(255) not null,
        condition_json TEXT,
        effect varchar(255) not null check (effect in ('ALLOW','DENY')),
        primary key (id)
    )
2025-05-25 12:44:26.358 DEBUG org.hibernate.SQL - 
    create table resources (
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        name varchar(100) not null,
        description TEXT,
        http_method varchar(255) not null check (http_method in ('GET','POST','PUT','DELETE','PATCH','HEAD','OPTIONS')),
        path varchar(255) not null,
        primary key (id)
    )
2025-05-25 12:44:26.360 DEBUG org.hibernate.SQL - 
    create table role_permissions (
        permission_id bigint not null,
        role_id bigint not null,
        primary key (permission_id, role_id)
    )
2025-05-25 12:44:26.361 DEBUG org.hibernate.SQL - 
    create table roles (
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        name varchar(50) not null unique,
        description TEXT,
        primary key (id)
    )
2025-05-25 12:44:26.363 DEBUG org.hibernate.SQL - 
    create table scopes (
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        name varchar(100) not null unique,
        description TEXT,
        primary key (id)
    )
2025-05-25 12:44:26.366 DEBUG org.hibernate.SQL - 
    create table tokens (
        expired boolean not null,
        revoked boolean not null,
        created_at timestamp(6) not null,
        expires_at timestamp(6) not null,
        token_id bigint generated by default as identity,
        user_id bigint,
        client_id varchar(255),
        token TEXT not null,
        token_type varchar(255) not null check (token_type in ('ACCESS','REFRESH')),
        primary key (token_id)
    )
2025-05-25 12:44:26.368 DEBUG org.hibernate.SQL - 
    create table user_roles (
        role_id bigint not null,
        user_id bigint not null,
        primary key (role_id, user_id)
    )
2025-05-25 12:44:26.370 DEBUG org.hibernate.SQL - 
    create table user_scopes (
        scope_id bigint not null,
        user_id bigint not null,
        primary key (scope_id, user_id)
    )
2025-05-25 12:44:26.372 DEBUG org.hibernate.SQL - 
    create table users (
        enabled boolean not null,
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        organization_id bigint,
        updated_at timestamp(6) not null,
        username varchar(50) not null unique,
        password varchar(100) not null,
        email varchar(255) not null unique,
        full_name varchar(255),
        primary key (id)
    )
2025-05-25 12:44:26.375 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       add constraint FK21l4ab5xsq7rxwb7b2efptbmt 
       foreign key (scope_id) 
       references scopes
2025-05-25 12:44:26.386 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       add constraint FK4glu0kw16kw6gu23yr5q6vjme 
       foreign key (client_id) 
       references client_applications
2025-05-25 12:44:26.389 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       add constraint FK3smj35weuy4b1fj396l5jvt6g 
       foreign key (scope_id) 
       references scopes
2025-05-25 12:44:26.391 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       add constraint FKacyhrlymxo934q9c4n441dhwf 
       foreign key (permission_id) 
       references permissions
2025-05-25 12:44:26.393 DEBUG org.hibernate.SQL - 
    alter table if exists policies 
       add constraint FKs49d98df3xexcyui98cwpek9p 
       foreign key (resource_id) 
       references resources
2025-05-25 12:44:26.396 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       add constraint FKegdk29eiy7mdtefy5c7eirr6e 
       foreign key (permission_id) 
       references permissions
2025-05-25 12:44:26.398 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       add constraint FKn5fotdgk8d1xvo8nav9uv3muc 
       foreign key (role_id) 
       references roles
2025-05-25 12:44:26.401 DEBUG org.hibernate.SQL - 
    alter table if exists tokens 
       add constraint FK2dylsfo39lgjyqml2tbe0b0ss 
       foreign key (user_id) 
       references users
2025-05-25 12:44:26.403 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       add constraint FKh8ciramu9cc9q3qcqiv4ue8a6 
       foreign key (role_id) 
       references roles
2025-05-25 12:44:26.406 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       add constraint FKhfh9dx7w3ubf1co1vdev94g3f 
       foreign key (user_id) 
       references users
2025-05-25 12:44:26.407 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       add constraint FK4gc7xv8r1p0j6ykgn5h4nx934 
       foreign key (scope_id) 
       references scopes
2025-05-25 12:44:26.410 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       add constraint FKspv2c7f3cxhd1242nkabx95s5 
       foreign key (user_id) 
       references users
2025-05-25 12:44:26.413 DEBUG org.hibernate.SQL - 
    alter table if exists users 
       add constraint FKqpugllwvyv37klq7ft9m8aqxk 
       foreign key (organization_id) 
       references organizations
2025-05-25 12:44:26.975 DEBUG c.e.i.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-05-25 12:44:27.045 INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name customUserDetailsService
2025-05-25 12:44:27.504 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.name,
        r1_0.updated_at 
    from
        roles r1_0 
    where
        r1_0.name=?
2025-05-25 12:44:27.619 DEBUG org.hibernate.SQL - 
    insert 
    into
        roles
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:44:27.657 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0
2025-05-25 12:44:27.668 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.name,
        p1_0.role_id,
        p1_1.id,
        p1_1.created_at,
        p1_1.description,
        p1_1.name,
        p1_1.updated_at,
        r1_0.updated_at 
    from
        roles r1_0 
    left join
        role_permissions p1_0 
            on r1_0.id=p1_0.role_id 
    left join
        permissions p1_1 
            on p1_1.id=p1_0.permission_id 
    where
        r1_0.id=?
2025-05-25 12:44:27.675 DEBUG org.hibernate.SQL - 
    select
        u1_0.role_id,
        u1_1.id,
        u1_1.created_at,
        u1_1.email,
        u1_1.enabled,
        u1_1.full_name,
        u1_1.organization_id,
        u1_1.password,
        u1_1.updated_at,
        u1_1.username 
    from
        user_roles u1_0 
    join
        users u1_1 
            on u1_1.id=u1_0.user_id 
    where
        u1_0.role_id=?
2025-05-25 12:44:27.687 DEBUG org.hibernate.SQL - 
    update
        roles 
    set
        description=?,
        name=?,
        updated_at=? 
    where
        id=?
2025-05-25 12:44:27.692 INFO  c.e.i.s.AdminInitializationService - Updated admin role with 0 permissions
2025-05-25 12:44:27.694 DEBUG org.hibernate.SQL - 
    select
        u1_0.id,
        u1_0.created_at,
        u1_0.email,
        u1_0.enabled,
        u1_0.full_name,
        u1_0.organization_id,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.username=?
2025-05-25 12:44:27.836 DEBUG org.hibernate.SQL - 
    insert 
    into
        users
        (created_at, email, enabled, full_name, organization_id, password, updated_at, username) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?)
2025-05-25 12:44:27.839 DEBUG org.hibernate.SQL - 
    insert 
    into
        user_roles
        (user_id, role_id) 
    values
        (?, ?)
2025-05-25 12:44:27.841 INFO  c.e.i.s.AdminInitializationService - Created admin user with username: admin
2025-05-25 12:44:27.982 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-05-25 12:44:28.120 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:44:28.123 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:44:28.125 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: RESOURCE_UPDATE
2025-05-25 12:44:28.127 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:44:28.129 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:44:28.131 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: USER_READ
2025-05-25 12:44:28.133 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:44:28.136 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:44:28.138 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: USER_DELETE
2025-05-25 12:44:28.139 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:44:28.141 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:44:28.142 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: POLICY_CREATE
2025-05-25 12:44:28.143 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:44:28.147 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:44:28.149 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: SCOPE_UPDATE
2025-05-25 12:44:28.151 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:44:28.152 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:44:28.153 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ORGANIZATION_CREATE
2025-05-25 12:44:28.155 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:44:28.157 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:44:28.159 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: SCOPE_READ
2025-05-25 12:44:28.161 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:44:28.163 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:44:28.165 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ROLE_UPDATE
2025-05-25 12:44:28.166 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:44:28.168 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:44:28.169 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ROLE_CREATE
2025-05-25 12:44:28.171 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:44:28.172 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:44:28.174 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: POLICY_READ
2025-05-25 12:44:28.175 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:44:28.177 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:44:28.179 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ORGANIZATION_READ
2025-05-25 12:44:28.182 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:44:28.184 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:44:28.186 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:44:28.189 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ROLE_READ
2025-05-25 12:44:28.190 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:44:28.193 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:44:28.194 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: CLIENT_CREATE
2025-05-25 12:44:28.196 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:44:28.199 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:44:28.201 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: RESOURCE_READ
2025-05-25 12:44:28.202 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:44:28.204 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:44:28.206 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:44:28.207 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: RESOURCE_DELETE
2025-05-25 12:44:28.208 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:44:28.210 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:44:28.213 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ORGANIZATION_UPDATE
2025-05-25 12:44:28.215 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:44:28.217 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:44:28.219 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: SCOPE_DELETE
2025-05-25 12:44:28.221 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:44:28.224 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:44:28.226 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:44:28.228 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: POLICY_UPDATE
2025-05-25 12:44:28.230 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:44:28.233 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:44:28.235 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ROLE_DELETE
2025-05-25 12:44:28.236 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:44:28.238 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:44:28.239 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: USER_UPDATE
2025-05-25 12:44:28.241 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:44:28.243 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:44:28.245 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: RESOURCE_CREATE
2025-05-25 12:44:28.248 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:44:28.251 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:44:28.253 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:44:28.255 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:44:28.256 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ORGANIZATION_DELETE
2025-05-25 12:44:28.258 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:44:28.260 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:44:28.262 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:44:28.264 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: POLICY_DELETE
2025-05-25 12:44:28.266 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:44:28.268 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:44:28.270 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: SCOPE_CREATE
2025-05-25 12:44:28.585 DEBUG o.s.s.web.DefaultSecurityFilterChain - Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, LogoutFilter, JwtAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, SessionManagementFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-05-25 12:44:28.901 INFO  o.s.b.a.h.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:testdb'
2025-05-25 12:44:29.214 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 42327 (http) with context path '/'
2025-05-25 12:44:29.225 INFO  c.e.iam.integration.AuthAndRoleTest - Started AuthAndRoleTest in 7.804 seconds (process running for 9.096)
2025-05-25 12:44:29.740 DEBUG org.hibernate.SQL - 
    select
        u1_0.id,
        u1_0.created_at,
        u1_0.email,
        u1_0.enabled,
        u1_0.full_name,
        u1_0.organization_id,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0
2025-05-25 12:44:29.748 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.name,
        r1_0.updated_at 
    from
        roles r1_0
2025-05-25 12:44:29.749 DEBUG org.hibernate.SQL - 
    select
        p1_0.role_id,
        p1_1.id,
        p1_1.created_at,
        p1_1.description,
        p1_1.name,
        p1_1.updated_at 
    from
        role_permissions p1_0 
    join
        permissions p1_1 
            on p1_1.id=p1_0.permission_id 
    where
        p1_0.role_id=?
2025-05-25 12:44:29.750 DEBUG org.hibernate.SQL - 
    select
        u1_0.role_id,
        u1_1.id,
        u1_1.created_at,
        u1_1.email,
        u1_1.enabled,
        u1_1.full_name,
        u1_1.organization_id,
        u1_1.password,
        u1_1.updated_at,
        u1_1.username 
    from
        user_roles u1_0 
    join
        users u1_1 
            on u1_1.id=u1_0.user_id 
    where
        u1_0.role_id=?
2025-05-25 12:44:29.753 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0
2025-05-25 12:44:29.759 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:44:29.762 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:44:29.764 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:44:29.764 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:44:29.765 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:44:29.766 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:44:29.766 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:44:29.767 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:44:29.768 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:44:29.768 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:44:29.768 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:44:29.769 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:44:29.769 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:44:29.770 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:44:29.770 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:44:29.770 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:44:29.771 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:44:29.772 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:44:29.772 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:44:29.772 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:44:29.773 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:44:29.774 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:44:29.774 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:44:29.775 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:44:29.775 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:44:29.776 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:44:29.776 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:44:29.777 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:44:29.778 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:44:29.779 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:44:29.780 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:44:29.781 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:44:29.781 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:44:29.782 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:44:29.783 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:44:29.783 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:44:29.783 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:44:29.784 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:44:29.784 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:44:29.785 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:44:29.785 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:44:29.786 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:44:29.786 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:44:29.786 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:44:29.787 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:44:29.787 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:44:29.788 DEBUG org.hibernate.SQL - 
    select
        r1_0.permission_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        role_permissions r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.permission_id=?
2025-05-25 12:44:29.788 DEBUG org.hibernate.SQL - 
    select
        s1_0.permission_id,
        s1_1.id,
        s1_1.created_at,
        s1_1.description,
        s1_1.name,
        s1_1.updated_at 
    from
        permission_scopes s1_0 
    join
        scopes s1_1 
            on s1_1.id=s1_0.scope_id 
    where
        s1_0.permission_id=?
2025-05-25 12:44:29.791 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.http_method,
        r1_0.name,
        r1_0.path,
        r1_0.updated_at 
    from
        resources r1_0
2025-05-25 12:44:29.794 DEBUG org.hibernate.SQL - 
    delete 
    from
        user_roles 
    where
        user_id=?
2025-05-25 12:44:29.797 DEBUG org.hibernate.SQL - 
    delete 
    from
        user_scopes 
    where
        user_id=?
2025-05-25 12:44:29.799 DEBUG org.hibernate.SQL - 
    delete 
    from
        users 
    where
        id=?
2025-05-25 12:44:29.801 DEBUG org.hibernate.SQL - 
    delete 
    from
        roles 
    where
        id=?
2025-05-25 12:44:29.802 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:44:29.802 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:44:29.803 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:44:29.803 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:44:29.804 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:44:29.804 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:44:29.804 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:44:29.805 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:44:29.805 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:44:29.806 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:44:29.806 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:44:29.807 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:44:29.807 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:44:29.808 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:44:29.808 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:44:29.808 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:44:29.809 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:44:29.809 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:44:29.810 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:44:29.811 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:44:29.811 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:44:29.812 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:44:29.813 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:44:29.813 DEBUG org.hibernate.SQL - 
    delete 
    from
        permissions 
    where
        id=?
2025-05-25 12:44:29.816 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:44:29.818 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:44:29.820 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.id=?
2025-05-25 12:44:29.824 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:44:29.827 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:44:29.830 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.id=?
2025-05-25 12:44:29.832 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:44:29.833 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:44:29.835 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.id=?
2025-05-25 12:44:29.837 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:44:29.839 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:44:29.840 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.id=?
2025-05-25 12:44:29.842 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:44:29.845 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:44:29.848 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.id=?
2025-05-25 12:44:29.850 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:44:29.852 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:44:29.853 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.id=?
2025-05-25 12:44:29.855 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:44:29.857 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:44:29.859 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.id=?
2025-05-25 12:44:29.865 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:44:29.867 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:44:29.869 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.id=?
2025-05-25 12:44:29.871 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:44:29.873 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:44:29.875 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.id=?
2025-05-25 12:44:29.878 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:44:29.880 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:44:29.882 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.id=?
2025-05-25 12:44:29.886 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:44:29.887 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:44:29.888 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.id=?
2025-05-25 12:44:29.891 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:44:29.893 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:44:29.897 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.id=?
2025-05-25 12:44:29.901 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:44:29.902 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:44:29.903 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.id=?
2025-05-25 12:44:29.905 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:44:29.906 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:44:29.907 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.id=?
2025-05-25 12:44:29.909 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:44:29.912 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:44:29.914 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.id=?
2025-05-25 12:44:29.917 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:44:29.918 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:44:29.920 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.id=?
2025-05-25 12:44:29.922 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:44:29.923 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:44:29.924 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.id=?
2025-05-25 12:44:30.288 DEBUG org.hibernate.SQL - 
    select
        count(*) 
    from
        permissions p1_0
2025-05-25 12:44:30.291 INFO  c.e.iam.integration.AuthAndRoleTest - Permissions created. Total permissions: 17
2025-05-25 12:44:30.296 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0
2025-05-25 12:44:30.305 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.name,
        r1_0.updated_at 
    from
        roles r1_0 
    where
        r1_0.name=?
2025-05-25 12:44:30.307 DEBUG org.hibernate.SQL - 
    insert 
    into
        roles
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:44:30.313 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:44:30.314 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:44:30.315 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:44:30.315 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:44:30.316 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:44:30.316 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:44:30.316 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:44:30.317 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:44:30.317 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:44:30.317 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:44:30.318 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:44:30.318 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:44:30.318 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:44:30.319 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:44:30.319 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:44:30.319 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:44:30.320 DEBUG org.hibernate.SQL - 
    insert 
    into
        role_permissions
        (role_id, permission_id) 
    values
        (?, ?)
2025-05-25 12:44:30.321 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.name,
        r1_0.updated_at 
    from
        roles r1_0 
    where
        r1_0.id=?
2025-05-25 12:44:30.323 DEBUG org.hibernate.SQL - 
    select
        p1_0.role_id,
        p1_1.id,
        p1_1.created_at,
        p1_1.description,
        p1_1.name,
        p1_1.updated_at 
    from
        role_permissions p1_0 
    join
        permissions p1_1 
            on p1_1.id=p1_0.permission_id 
    where
        p1_0.role_id=?
2025-05-25 12:44:30.331 INFO  c.e.iam.integration.AuthAndRoleTest - Admin role after save - Permissions size: 17
2025-05-25 12:44:30.332 INFO  c.e.iam.integration.AuthAndRoleTest - Admin role permissions: [ROLE_UPDATE, USER_READ, SCOPE_CREATE, SCOPE_UPDATE, RESOURCE_UPDATE, ROLE_DELETE, SCOPE_DELETE, RESOURCE_DELETE, RESOURCE_CREATE, ORGANIZATION_UPDATE, POLICY_DELETE, ORGANIZATION_DELETE, ROLE_CREATE, ORGANIZATION_READ, POLICY_READ, ORGANIZATION_CREATE, POLICY_CREATE]
2025-05-25 12:44:30.334 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.name,
        r1_0.updated_at 
    from
        roles r1_0 
    where
        r1_0.name=?
2025-05-25 12:44:30.336 DEBUG org.hibernate.SQL - 
    insert 
    into
        roles
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:44:30.460 INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-05-25 12:44:30.467 INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-05-25 12:44:30.476 DEBUG org.hibernate.SQL - 
    set client_min_messages = WARNING
2025-05-25 12:44:30.477 ERROR o.h.t.s.i.SchemaDropperImpl$DelayedDropActionImpl - HHH000478: Unsuccessful: 
    set client_min_messages = WARNING
2025-05-25 12:44:30.478 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       drop constraint if exists FK21l4ab5xsq7rxwb7b2efptbmt
2025-05-25 12:44:30.479 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       drop constraint if exists FK4glu0kw16kw6gu23yr5q6vjme
2025-05-25 12:44:30.480 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       drop constraint if exists FK3smj35weuy4b1fj396l5jvt6g
2025-05-25 12:44:30.480 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       drop constraint if exists FKacyhrlymxo934q9c4n441dhwf
2025-05-25 12:44:30.481 DEBUG org.hibernate.SQL - 
    alter table if exists policies 
       drop constraint if exists FKs49d98df3xexcyui98cwpek9p
2025-05-25 12:44:30.482 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       drop constraint if exists FKegdk29eiy7mdtefy5c7eirr6e
2025-05-25 12:44:30.483 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       drop constraint if exists FKn5fotdgk8d1xvo8nav9uv3muc
2025-05-25 12:44:30.485 DEBUG org.hibernate.SQL - 
    alter table if exists tokens 
       drop constraint if exists FK2dylsfo39lgjyqml2tbe0b0ss
2025-05-25 12:44:30.486 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       drop constraint if exists FKh8ciramu9cc9q3qcqiv4ue8a6
2025-05-25 12:44:30.487 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       drop constraint if exists FKhfh9dx7w3ubf1co1vdev94g3f
2025-05-25 12:44:30.488 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       drop constraint if exists FK4gc7xv8r1p0j6ykgn5h4nx934
2025-05-25 12:44:30.489 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       drop constraint if exists FKspv2c7f3cxhd1242nkabx95s5
2025-05-25 12:44:30.490 DEBUG org.hibernate.SQL - 
    alter table if exists users 
       drop constraint if exists FKqpugllwvyv37klq7ft9m8aqxk
2025-05-25 12:44:30.490 DEBUG org.hibernate.SQL - 
    drop table if exists client_applications cascade
2025-05-25 12:44:30.493 DEBUG org.hibernate.SQL - 
    drop table if exists client_scopes cascade
2025-05-25 12:44:30.495 DEBUG org.hibernate.SQL - 
    drop table if exists organizations cascade
2025-05-25 12:44:30.497 DEBUG org.hibernate.SQL - 
    drop table if exists permission_scopes cascade
2025-05-25 12:44:30.498 DEBUG org.hibernate.SQL - 
    drop table if exists permissions cascade
2025-05-25 12:44:30.499 DEBUG org.hibernate.SQL - 
    drop table if exists policies cascade
2025-05-25 12:44:30.501 DEBUG org.hibernate.SQL - 
    drop table if exists resources cascade
2025-05-25 12:44:30.502 DEBUG org.hibernate.SQL - 
    drop table if exists role_permissions cascade
2025-05-25 12:44:30.503 DEBUG org.hibernate.SQL - 
    drop table if exists roles cascade
2025-05-25 12:44:30.504 DEBUG org.hibernate.SQL - 
    drop table if exists scopes cascade
2025-05-25 12:44:30.505 DEBUG org.hibernate.SQL - 
    drop table if exists tokens cascade
2025-05-25 12:44:30.506 DEBUG org.hibernate.SQL - 
    drop table if exists user_roles cascade
2025-05-25 12:44:30.507 DEBUG org.hibernate.SQL - 
    drop table if exists user_scopes cascade
2025-05-25 12:44:30.508 DEBUG org.hibernate.SQL - 
    drop table if exists users cascade
2025-05-25 12:44:30.512 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-25 12:44:30.515 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-25 12:56:09.653 INFO  c.e.iam.integration.AuthAndRoleTest - Starting AuthAndRoleTest using Java 21.0.7 with PID 40773 (started by descent in /home/descent/Documents/VDT/vdt5-iam-system/iam-service)
2025-05-25 12:56:09.654 DEBUG c.e.iam.integration.AuthAndRoleTest - Running with Spring Boot v3.4.5, Spring v6.2.6
2025-05-25 12:56:09.655 INFO  c.e.iam.integration.AuthAndRoleTest - The following 1 profile is active: "test"
2025-05-25 12:56:10.869 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-05-25 12:56:10.982 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 101 ms. Found 9 JPA repository interfaces.
2025-05-25 12:56:12.116 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 0 (http)
2025-05-25 12:56:12.130 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-25 12:56:12.131 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.40]
2025-05-25 12:56:12.184 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-25 12:56:12.186 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2513 ms
2025-05-25 12:56:12.923 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-25 12:56:13.184 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:testdb user=SA
2025-05-25 12:56:13.186 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-25 12:56:14.451 DEBUG org.hibernate.SQL - 
    set client_min_messages = WARNING
2025-05-25 12:56:14.456 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       drop constraint if exists FK21l4ab5xsq7rxwb7b2efptbmt
2025-05-25 12:56:14.457 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       drop constraint if exists FK4glu0kw16kw6gu23yr5q6vjme
2025-05-25 12:56:14.457 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       drop constraint if exists FK3smj35weuy4b1fj396l5jvt6g
2025-05-25 12:56:14.458 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       drop constraint if exists FKacyhrlymxo934q9c4n441dhwf
2025-05-25 12:56:14.458 DEBUG org.hibernate.SQL - 
    alter table if exists policies 
       drop constraint if exists FKs49d98df3xexcyui98cwpek9p
2025-05-25 12:56:14.459 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       drop constraint if exists FKegdk29eiy7mdtefy5c7eirr6e
2025-05-25 12:56:14.459 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       drop constraint if exists FKn5fotdgk8d1xvo8nav9uv3muc
2025-05-25 12:56:14.459 DEBUG org.hibernate.SQL - 
    alter table if exists tokens 
       drop constraint if exists FK2dylsfo39lgjyqml2tbe0b0ss
2025-05-25 12:56:14.460 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       drop constraint if exists FKh8ciramu9cc9q3qcqiv4ue8a6
2025-05-25 12:56:14.460 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       drop constraint if exists FKhfh9dx7w3ubf1co1vdev94g3f
2025-05-25 12:56:14.460 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       drop constraint if exists FK4gc7xv8r1p0j6ykgn5h4nx934
2025-05-25 12:56:14.461 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       drop constraint if exists FKspv2c7f3cxhd1242nkabx95s5
2025-05-25 12:56:14.461 DEBUG org.hibernate.SQL - 
    alter table if exists users 
       drop constraint if exists FKqpugllwvyv37klq7ft9m8aqxk
2025-05-25 12:56:14.461 DEBUG org.hibernate.SQL - 
    drop table if exists client_applications cascade
2025-05-25 12:56:14.462 DEBUG org.hibernate.SQL - 
    drop table if exists client_scopes cascade
2025-05-25 12:56:14.462 DEBUG org.hibernate.SQL - 
    drop table if exists organizations cascade
2025-05-25 12:56:14.463 DEBUG org.hibernate.SQL - 
    drop table if exists permission_scopes cascade
2025-05-25 12:56:14.463 DEBUG org.hibernate.SQL - 
    drop table if exists permissions cascade
2025-05-25 12:56:14.463 DEBUG org.hibernate.SQL - 
    drop table if exists policies cascade
2025-05-25 12:56:14.464 DEBUG org.hibernate.SQL - 
    drop table if exists resources cascade
2025-05-25 12:56:14.464 DEBUG org.hibernate.SQL - 
    drop table if exists role_permissions cascade
2025-05-25 12:56:14.464 DEBUG org.hibernate.SQL - 
    drop table if exists roles cascade
2025-05-25 12:56:14.464 DEBUG org.hibernate.SQL - 
    drop table if exists scopes cascade
2025-05-25 12:56:14.465 DEBUG org.hibernate.SQL - 
    drop table if exists tokens cascade
2025-05-25 12:56:14.465 DEBUG org.hibernate.SQL - 
    drop table if exists user_roles cascade
2025-05-25 12:56:14.465 DEBUG org.hibernate.SQL - 
    drop table if exists user_scopes cascade
2025-05-25 12:56:14.465 DEBUG org.hibernate.SQL - 
    drop table if exists users cascade
2025-05-25 12:56:14.471 DEBUG org.hibernate.SQL - 
    create table client_applications (
        is_active boolean,
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        client_id varchar(100) not null unique,
        name varchar(100) not null,
        client_secret varchar(255) not null,
        description TEXT,
        redirect_uri varchar(255),
        primary key (id)
    )
2025-05-25 12:56:14.483 DEBUG org.hibernate.SQL - 
    create table client_scopes (
        client_id bigint not null,
        scope_id bigint not null,
        primary key (client_id, scope_id)
    )
2025-05-25 12:56:14.484 DEBUG org.hibernate.SQL - 
    create table organizations (
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        description varchar(1000),
        name varchar(255) not null unique,
        primary key (id)
    )
2025-05-25 12:56:14.486 DEBUG org.hibernate.SQL - 
    create table permission_scopes (
        permission_id bigint not null,
        scope_id bigint not null,
        primary key (permission_id, scope_id)
    )
2025-05-25 12:56:14.487 DEBUG org.hibernate.SQL - 
    create table permissions (
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        name varchar(100) not null unique,
        description TEXT,
        primary key (id)
    )
2025-05-25 12:56:14.489 DEBUG org.hibernate.SQL - 
    create table policies (
        subject_type smallint not null check (subject_type between 0 and 3),
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        resource_id bigint not null,
        subject_id bigint not null,
        updated_at timestamp(6) not null,
        action varchar(255) not null,
        condition_json TEXT,
        effect varchar(255) not null check (effect in ('ALLOW','DENY')),
        primary key (id)
    )
2025-05-25 12:56:14.497 DEBUG org.hibernate.SQL - 
    create table resources (
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        name varchar(100) not null,
        description TEXT,
        http_method varchar(255) not null check (http_method in ('GET','POST','PUT','DELETE','PATCH','HEAD','OPTIONS')),
        path varchar(255) not null,
        primary key (id)
    )
2025-05-25 12:56:14.500 DEBUG org.hibernate.SQL - 
    create table role_permissions (
        permission_id bigint not null,
        role_id bigint not null,
        primary key (permission_id, role_id)
    )
2025-05-25 12:56:14.501 DEBUG org.hibernate.SQL - 
    create table roles (
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        name varchar(50) not null unique,
        description TEXT,
        primary key (id)
    )
2025-05-25 12:56:14.505 DEBUG org.hibernate.SQL - 
    create table scopes (
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        name varchar(100) not null unique,
        description TEXT,
        primary key (id)
    )
2025-05-25 12:56:14.508 DEBUG org.hibernate.SQL - 
    create table tokens (
        expired boolean not null,
        revoked boolean not null,
        created_at timestamp(6) not null,
        expires_at timestamp(6) not null,
        token_id bigint generated by default as identity,
        user_id bigint,
        client_id varchar(255),
        token TEXT not null,
        token_type varchar(255) not null check (token_type in ('ACCESS','REFRESH')),
        primary key (token_id)
    )
2025-05-25 12:56:14.511 DEBUG org.hibernate.SQL - 
    create table user_roles (
        role_id bigint not null,
        user_id bigint not null,
        primary key (role_id, user_id)
    )
2025-05-25 12:56:14.512 DEBUG org.hibernate.SQL - 
    create table user_scopes (
        scope_id bigint not null,
        user_id bigint not null,
        primary key (scope_id, user_id)
    )
2025-05-25 12:56:14.514 DEBUG org.hibernate.SQL - 
    create table users (
        enabled boolean not null,
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        organization_id bigint,
        updated_at timestamp(6) not null,
        username varchar(50) not null unique,
        password varchar(100) not null,
        email varchar(255) not null unique,
        full_name varchar(255),
        primary key (id)
    )
2025-05-25 12:56:14.516 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       add constraint FK21l4ab5xsq7rxwb7b2efptbmt 
       foreign key (scope_id) 
       references scopes
2025-05-25 12:56:14.542 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       add constraint FK4glu0kw16kw6gu23yr5q6vjme 
       foreign key (client_id) 
       references client_applications
2025-05-25 12:56:14.543 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       add constraint FK3smj35weuy4b1fj396l5jvt6g 
       foreign key (scope_id) 
       references scopes
2025-05-25 12:56:14.545 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       add constraint FKacyhrlymxo934q9c4n441dhwf 
       foreign key (permission_id) 
       references permissions
2025-05-25 12:56:14.546 DEBUG org.hibernate.SQL - 
    alter table if exists policies 
       add constraint FKs49d98df3xexcyui98cwpek9p 
       foreign key (resource_id) 
       references resources
2025-05-25 12:56:14.548 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       add constraint FKegdk29eiy7mdtefy5c7eirr6e 
       foreign key (permission_id) 
       references permissions
2025-05-25 12:56:14.550 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       add constraint FKn5fotdgk8d1xvo8nav9uv3muc 
       foreign key (role_id) 
       references roles
2025-05-25 12:56:14.552 DEBUG org.hibernate.SQL - 
    alter table if exists tokens 
       add constraint FK2dylsfo39lgjyqml2tbe0b0ss 
       foreign key (user_id) 
       references users
2025-05-25 12:56:14.554 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       add constraint FKh8ciramu9cc9q3qcqiv4ue8a6 
       foreign key (role_id) 
       references roles
2025-05-25 12:56:14.555 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       add constraint FKhfh9dx7w3ubf1co1vdev94g3f 
       foreign key (user_id) 
       references users
2025-05-25 12:56:14.557 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       add constraint FK4gc7xv8r1p0j6ykgn5h4nx934 
       foreign key (scope_id) 
       references scopes
2025-05-25 12:56:14.558 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       add constraint FKspv2c7f3cxhd1242nkabx95s5 
       foreign key (user_id) 
       references users
2025-05-25 12:56:14.560 DEBUG org.hibernate.SQL - 
    alter table if exists users 
       add constraint FKqpugllwvyv37klq7ft9m8aqxk 
       foreign key (organization_id) 
       references organizations
2025-05-25 12:56:15.012 DEBUG c.e.i.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-05-25 12:56:15.075 INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name customUserDetailsService
2025-05-25 12:56:15.462 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.name,
        r1_0.updated_at 
    from
        roles r1_0 
    where
        r1_0.name=?
2025-05-25 12:56:15.595 DEBUG org.hibernate.SQL - 
    insert 
    into
        roles
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:56:15.627 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0
2025-05-25 12:56:15.637 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.name,
        p1_0.role_id,
        p1_1.id,
        p1_1.created_at,
        p1_1.description,
        p1_1.name,
        p1_1.updated_at,
        r1_0.updated_at 
    from
        roles r1_0 
    left join
        role_permissions p1_0 
            on r1_0.id=p1_0.role_id 
    left join
        permissions p1_1 
            on p1_1.id=p1_0.permission_id 
    where
        r1_0.id=?
2025-05-25 12:56:15.644 DEBUG org.hibernate.SQL - 
    select
        u1_0.role_id,
        u1_1.id,
        u1_1.created_at,
        u1_1.email,
        u1_1.enabled,
        u1_1.full_name,
        u1_1.organization_id,
        u1_1.password,
        u1_1.updated_at,
        u1_1.username 
    from
        user_roles u1_0 
    join
        users u1_1 
            on u1_1.id=u1_0.user_id 
    where
        u1_0.role_id=?
2025-05-25 12:56:15.656 DEBUG org.hibernate.SQL - 
    update
        roles 
    set
        description=?,
        name=?,
        updated_at=? 
    where
        id=?
2025-05-25 12:56:15.661 INFO  c.e.i.s.AdminInitializationService - Updated admin role with 0 permissions
2025-05-25 12:56:15.663 DEBUG org.hibernate.SQL - 
    select
        u1_0.id,
        u1_0.created_at,
        u1_0.email,
        u1_0.enabled,
        u1_0.full_name,
        u1_0.organization_id,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.username=?
2025-05-25 12:56:15.801 DEBUG org.hibernate.SQL - 
    insert 
    into
        users
        (created_at, email, enabled, full_name, organization_id, password, updated_at, username) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?)
2025-05-25 12:56:15.804 DEBUG org.hibernate.SQL - 
    insert 
    into
        user_roles
        (user_id, role_id) 
    values
        (?, ?)
2025-05-25 12:56:15.806 INFO  c.e.i.s.AdminInitializationService - Created admin user with username: admin
2025-05-25 12:56:15.930 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-05-25 12:56:16.065 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:56:16.069 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:56:16.071 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: POLICY_READ
2025-05-25 12:56:16.073 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:56:16.075 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:56:16.077 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ORGANIZATION_READ
2025-05-25 12:56:16.078 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:56:16.081 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:56:16.083 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: SCOPE_DELETE
2025-05-25 12:56:16.084 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:56:16.087 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:56:16.089 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ROLE_READ
2025-05-25 12:56:16.091 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:56:16.093 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:56:16.096 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: RESOURCE_CREATE
2025-05-25 12:56:16.098 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:56:16.100 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:56:16.102 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: RESOURCE_DELETE
2025-05-25 12:56:16.104 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:56:16.108 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:56:16.110 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ORGANIZATION_UPDATE
2025-05-25 12:56:16.112 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:56:16.114 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:56:16.116 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ROLE_DELETE
2025-05-25 12:56:16.117 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:56:16.119 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:56:16.121 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: POLICY_UPDATE
2025-05-25 12:56:16.123 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:56:16.125 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:56:16.129 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: RESOURCE_READ
2025-05-25 12:56:16.130 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:56:16.133 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:56:16.134 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: SCOPE_READ
2025-05-25 12:56:16.136 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:56:16.141 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:56:16.143 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:56:16.145 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: USER_UPDATE
2025-05-25 12:56:16.147 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:56:16.149 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:56:16.151 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: USER_READ
2025-05-25 12:56:16.152 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:56:16.155 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:56:16.157 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ORGANIZATION_DELETE
2025-05-25 12:56:16.158 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:56:16.161 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:56:16.162 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:56:16.164 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: POLICY_DELETE
2025-05-25 12:56:16.166 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:56:16.167 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:56:16.169 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ROLE_CREATE
2025-05-25 12:56:16.170 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:56:16.172 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:56:16.174 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: SCOPE_CREATE
2025-05-25 12:56:16.176 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:56:16.178 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:56:16.179 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:56:16.181 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: USER_DELETE
2025-05-25 12:56:16.183 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:56:16.187 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:56:16.189 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:56:16.191 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: RESOURCE_UPDATE
2025-05-25 12:56:16.192 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:56:16.195 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:56:16.197 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: POLICY_CREATE
2025-05-25 12:56:16.198 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:56:16.200 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:56:16.202 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: SCOPE_UPDATE
2025-05-25 12:56:16.203 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:56:16.205 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:56:16.208 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ORGANIZATION_CREATE
2025-05-25 12:56:16.210 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:56:16.212 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:56:16.214 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ROLE_UPDATE
2025-05-25 12:56:16.215 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:56:16.217 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:56:16.219 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:56:16.221 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: CLIENT_CREATE
2025-05-25 12:56:16.224 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:56:16.520 DEBUG o.s.s.web.DefaultSecurityFilterChain - Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, LogoutFilter, JwtAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, SessionManagementFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-05-25 12:56:16.819 INFO  o.s.b.a.h.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:testdb'
2025-05-25 12:56:17.103 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 40963 (http) with context path '/'
2025-05-25 12:56:17.118 INFO  c.e.iam.integration.AuthAndRoleTest - Started AuthAndRoleTest in 7.973 seconds (process running for 9.273)
2025-05-25 12:56:17.779 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-05-25 12:56:17.780 INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-05-25 12:56:17.784 INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-05-25 12:56:17.800 DEBUG o.s.security.web.FilterChainProxy - Securing POST /auth/login
2025-05-25 12:56:17.806 DEBUG o.s.s.w.a.AnonymousAuthenticationFilter - Set SecurityContextHolder to anonymous SecurityContext
2025-05-25 12:56:17.807 DEBUG o.s.security.web.FilterChainProxy - Secured POST /auth/login
2025-05-25 12:56:17.946 DEBUG org.hibernate.SQL - 
    select
        u1_0.id,
        u1_0.created_at,
        u1_0.email,
        u1_0.enabled,
        u1_0.full_name,
        u1_0.organization_id,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.username=?
2025-05-25 12:56:17.950 DEBUG org.hibernate.SQL - 
    select
        r1_0.user_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        user_roles r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.user_id=?
2025-05-25 12:56:17.951 DEBUG org.hibernate.SQL - 
    select
        p1_0.role_id,
        p1_1.id,
        p1_1.created_at,
        p1_1.description,
        p1_1.name,
        p1_1.updated_at 
    from
        role_permissions p1_0 
    join
        permissions p1_1 
            on p1_1.id=p1_0.permission_id 
    where
        p1_0.role_id=?
2025-05-25 12:56:18.052 DEBUG o.s.s.a.d.DaoAuthenticationProvider - Authenticated user
2025-05-25 12:56:18.083 DEBUG org.hibernate.SQL - 
    insert 
    into
        tokens
        (client_id, created_at, expired, expires_at, revoked, token, token_type, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?)
2025-05-25 12:56:18.088 DEBUG org.hibernate.SQL - 
    insert 
    into
        tokens
        (client_id, created_at, expired, expires_at, revoked, token, token_type, user_id) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?)
2025-05-25 12:56:18.130 INFO  c.e.iam.integration.AuthAndRoleTest - Testing /users endpoint with admin token: eyJhbGciOiJIUzI1NiJ9.eyJ0eXBlIjoidXNlciIsInVzZXJuYW1lIjoiYWRtaW4iLCJzdWIiOiJhZG1pbiIsImlhdCI6MTc0ODE2Njk3OCwiZXhwIjoxNzQ4MTcwNTc4fQ.jCQUDeiY6OQj_VJPz8iAigmluFhK79aJYDVrT4js42w
2025-05-25 12:56:18.133 DEBUG o.s.security.web.FilterChainProxy - Securing GET /users
2025-05-25 12:56:18.137 DEBUG org.hibernate.SQL - 
    select
        t1_0.token_id,
        t1_0.client_id,
        t1_0.created_at,
        t1_0.expired,
        t1_0.expires_at,
        t1_0.revoked,
        t1_0.token,
        t1_0.token_type,
        t1_0.user_id 
    from
        tokens t1_0 
    where
        t1_0.token=?
2025-05-25 12:56:18.164 DEBUG org.hibernate.SQL - 
    select
        u1_0.id,
        u1_0.created_at,
        u1_0.email,
        u1_0.enabled,
        u1_0.full_name,
        u1_0.organization_id,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.username=?
2025-05-25 12:56:18.166 DEBUG org.hibernate.SQL - 
    select
        r1_0.user_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        user_roles r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.user_id=?
2025-05-25 12:56:18.166 DEBUG org.hibernate.SQL - 
    select
        p1_0.role_id,
        p1_1.id,
        p1_1.created_at,
        p1_1.description,
        p1_1.name,
        p1_1.updated_at 
    from
        role_permissions p1_0 
    join
        permissions p1_1 
            on p1_1.id=p1_0.permission_id 
    where
        p1_0.role_id=?
2025-05-25 12:56:18.168 DEBUG o.s.security.web.FilterChainProxy - Secured GET /users
2025-05-25 12:56:18.177 ERROR c.e.i.e.GlobalExceptionHandler - Access denied: User does not have required permission: USER_READ
2025-05-25 12:56:18.182 INFO  c.e.iam.integration.AuthAndRoleTest - Raw response from /users: Status=403 FORBIDDEN, Body={"status":403,"error":"Access denied","message":"User does not have required permission: USER_READ"}
2025-05-25 12:56:18.187 DEBUG o.s.security.web.FilterChainProxy - Securing GET /users
2025-05-25 12:56:18.190 DEBUG org.hibernate.SQL - 
    select
        t1_0.token_id,
        t1_0.client_id,
        t1_0.created_at,
        t1_0.expired,
        t1_0.expires_at,
        t1_0.revoked,
        t1_0.token,
        t1_0.token_type,
        t1_0.user_id 
    from
        tokens t1_0 
    where
        t1_0.token=?
2025-05-25 12:56:18.197 DEBUG org.hibernate.SQL - 
    select
        u1_0.id,
        u1_0.created_at,
        u1_0.email,
        u1_0.enabled,
        u1_0.full_name,
        u1_0.organization_id,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.username=?
2025-05-25 12:56:18.198 DEBUG org.hibernate.SQL - 
    select
        r1_0.user_id,
        r1_1.id,
        r1_1.created_at,
        r1_1.description,
        r1_1.name,
        r1_1.updated_at 
    from
        user_roles r1_0 
    join
        roles r1_1 
            on r1_1.id=r1_0.role_id 
    where
        r1_0.user_id=?
2025-05-25 12:56:18.199 DEBUG org.hibernate.SQL - 
    select
        p1_0.role_id,
        p1_1.id,
        p1_1.created_at,
        p1_1.description,
        p1_1.name,
        p1_1.updated_at 
    from
        role_permissions p1_0 
    join
        permissions p1_1 
            on p1_1.id=p1_0.permission_id 
    where
        p1_0.role_id=?
2025-05-25 12:56:18.200 DEBUG o.s.security.web.FilterChainProxy - Secured GET /users
2025-05-25 12:56:18.202 ERROR c.e.i.e.GlobalExceptionHandler - Access denied: User does not have required permission: USER_READ
2025-05-25 12:56:18.204 INFO  c.e.iam.integration.AuthAndRoleTest - Parsed response: Status=403 FORBIDDEN, Body={status=403, error=Access denied, message=User does not have required permission: USER_READ}
2025-05-25 12:56:18.309 INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-05-25 12:56:18.315 INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-05-25 12:56:18.326 DEBUG org.hibernate.SQL - 
    set client_min_messages = WARNING
2025-05-25 12:56:18.327 ERROR o.h.t.s.i.SchemaDropperImpl$DelayedDropActionImpl - HHH000478: Unsuccessful: 
    set client_min_messages = WARNING
2025-05-25 12:56:18.327 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       drop constraint if exists FK21l4ab5xsq7rxwb7b2efptbmt
2025-05-25 12:56:18.329 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       drop constraint if exists FK4glu0kw16kw6gu23yr5q6vjme
2025-05-25 12:56:18.330 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       drop constraint if exists FK3smj35weuy4b1fj396l5jvt6g
2025-05-25 12:56:18.330 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       drop constraint if exists FKacyhrlymxo934q9c4n441dhwf
2025-05-25 12:56:18.331 DEBUG org.hibernate.SQL - 
    alter table if exists policies 
       drop constraint if exists FKs49d98df3xexcyui98cwpek9p
2025-05-25 12:56:18.332 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       drop constraint if exists FKegdk29eiy7mdtefy5c7eirr6e
2025-05-25 12:56:18.332 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       drop constraint if exists FKn5fotdgk8d1xvo8nav9uv3muc
2025-05-25 12:56:18.333 DEBUG org.hibernate.SQL - 
    alter table if exists tokens 
       drop constraint if exists FK2dylsfo39lgjyqml2tbe0b0ss
2025-05-25 12:56:18.334 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       drop constraint if exists FKh8ciramu9cc9q3qcqiv4ue8a6
2025-05-25 12:56:18.334 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       drop constraint if exists FKhfh9dx7w3ubf1co1vdev94g3f
2025-05-25 12:56:18.335 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       drop constraint if exists FK4gc7xv8r1p0j6ykgn5h4nx934
2025-05-25 12:56:18.335 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       drop constraint if exists FKspv2c7f3cxhd1242nkabx95s5
2025-05-25 12:56:18.336 DEBUG org.hibernate.SQL - 
    alter table if exists users 
       drop constraint if exists FKqpugllwvyv37klq7ft9m8aqxk
2025-05-25 12:56:18.337 DEBUG org.hibernate.SQL - 
    drop table if exists client_applications cascade
2025-05-25 12:56:18.340 DEBUG org.hibernate.SQL - 
    drop table if exists client_scopes cascade
2025-05-25 12:56:18.342 DEBUG org.hibernate.SQL - 
    drop table if exists organizations cascade
2025-05-25 12:56:18.343 DEBUG org.hibernate.SQL - 
    drop table if exists permission_scopes cascade
2025-05-25 12:56:18.344 DEBUG org.hibernate.SQL - 
    drop table if exists permissions cascade
2025-05-25 12:56:18.345 DEBUG org.hibernate.SQL - 
    drop table if exists policies cascade
2025-05-25 12:56:18.346 DEBUG org.hibernate.SQL - 
    drop table if exists resources cascade
2025-05-25 12:56:18.347 DEBUG org.hibernate.SQL - 
    drop table if exists role_permissions cascade
2025-05-25 12:56:18.348 DEBUG org.hibernate.SQL - 
    drop table if exists roles cascade
2025-05-25 12:56:18.349 DEBUG org.hibernate.SQL - 
    drop table if exists scopes cascade
2025-05-25 12:56:18.350 DEBUG org.hibernate.SQL - 
    drop table if exists tokens cascade
2025-05-25 12:56:18.351 DEBUG org.hibernate.SQL - 
    drop table if exists user_roles cascade
2025-05-25 12:56:18.352 DEBUG org.hibernate.SQL - 
    drop table if exists user_scopes cascade
2025-05-25 12:56:18.353 DEBUG org.hibernate.SQL - 
    drop table if exists users cascade
2025-05-25 12:56:18.357 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-25 12:56:18.359 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-25 12:59:03.060 INFO  c.e.iam.integration.AuthAndRoleTest - Starting AuthAndRoleTest using Java 21.0.7 with PID 42897 (started by descent in /home/descent/Documents/VDT/vdt5-iam-system/iam-service)
2025-05-25 12:59:03.061 DEBUG c.e.iam.integration.AuthAndRoleTest - Running with Spring Boot v3.4.5, Spring v6.2.6
2025-05-25 12:59:03.062 INFO  c.e.iam.integration.AuthAndRoleTest - The following 1 profile is active: "test"
2025-05-25 12:59:04.015 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-05-25 12:59:04.098 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 73 ms. Found 9 JPA repository interfaces.
2025-05-25 12:59:04.935 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 0 (http)
2025-05-25 12:59:04.950 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-25 12:59:04.951 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.40]
2025-05-25 12:59:04.997 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-25 12:59:04.997 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1913 ms
2025-05-25 12:59:05.543 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-25 12:59:05.729 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:testdb user=SA
2025-05-25 12:59:05.731 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-25 12:59:07.065 DEBUG org.hibernate.SQL - 
    set client_min_messages = WARNING
2025-05-25 12:59:07.074 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       drop constraint if exists FK21l4ab5xsq7rxwb7b2efptbmt
2025-05-25 12:59:07.075 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       drop constraint if exists FK4glu0kw16kw6gu23yr5q6vjme
2025-05-25 12:59:07.076 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       drop constraint if exists FK3smj35weuy4b1fj396l5jvt6g
2025-05-25 12:59:07.076 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       drop constraint if exists FKacyhrlymxo934q9c4n441dhwf
2025-05-25 12:59:07.077 DEBUG org.hibernate.SQL - 
    alter table if exists policies 
       drop constraint if exists FKs49d98df3xexcyui98cwpek9p
2025-05-25 12:59:07.077 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       drop constraint if exists FKegdk29eiy7mdtefy5c7eirr6e
2025-05-25 12:59:07.078 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       drop constraint if exists FKn5fotdgk8d1xvo8nav9uv3muc
2025-05-25 12:59:07.079 DEBUG org.hibernate.SQL - 
    alter table if exists tokens 
       drop constraint if exists FK2dylsfo39lgjyqml2tbe0b0ss
2025-05-25 12:59:07.079 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       drop constraint if exists FKh8ciramu9cc9q3qcqiv4ue8a6
2025-05-25 12:59:07.080 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       drop constraint if exists FKhfh9dx7w3ubf1co1vdev94g3f
2025-05-25 12:59:07.081 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       drop constraint if exists FK4gc7xv8r1p0j6ykgn5h4nx934
2025-05-25 12:59:07.081 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       drop constraint if exists FKspv2c7f3cxhd1242nkabx95s5
2025-05-25 12:59:07.082 DEBUG org.hibernate.SQL - 
    alter table if exists users 
       drop constraint if exists FKqpugllwvyv37klq7ft9m8aqxk
2025-05-25 12:59:07.082 DEBUG org.hibernate.SQL - 
    drop table if exists client_applications cascade
2025-05-25 12:59:07.083 DEBUG org.hibernate.SQL - 
    drop table if exists client_scopes cascade
2025-05-25 12:59:07.084 DEBUG org.hibernate.SQL - 
    drop table if exists organizations cascade
2025-05-25 12:59:07.085 DEBUG org.hibernate.SQL - 
    drop table if exists permission_scopes cascade
2025-05-25 12:59:07.086 DEBUG org.hibernate.SQL - 
    drop table if exists permissions cascade
2025-05-25 12:59:07.086 DEBUG org.hibernate.SQL - 
    drop table if exists policies cascade
2025-05-25 12:59:07.087 DEBUG org.hibernate.SQL - 
    drop table if exists resources cascade
2025-05-25 12:59:07.087 DEBUG org.hibernate.SQL - 
    drop table if exists role_permissions cascade
2025-05-25 12:59:07.088 DEBUG org.hibernate.SQL - 
    drop table if exists roles cascade
2025-05-25 12:59:07.088 DEBUG org.hibernate.SQL - 
    drop table if exists scopes cascade
2025-05-25 12:59:07.089 DEBUG org.hibernate.SQL - 
    drop table if exists tokens cascade
2025-05-25 12:59:07.089 DEBUG org.hibernate.SQL - 
    drop table if exists user_roles cascade
2025-05-25 12:59:07.090 DEBUG org.hibernate.SQL - 
    drop table if exists user_scopes cascade
2025-05-25 12:59:07.090 DEBUG org.hibernate.SQL - 
    drop table if exists users cascade
2025-05-25 12:59:07.096 DEBUG org.hibernate.SQL - 
    create table client_applications (
        is_active boolean,
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        client_id varchar(100) not null unique,
        name varchar(100) not null,
        client_secret varchar(255) not null,
        description TEXT,
        redirect_uri varchar(255),
        primary key (id)
    )
2025-05-25 12:59:07.111 DEBUG org.hibernate.SQL - 
    create table client_scopes (
        client_id bigint not null,
        scope_id bigint not null,
        primary key (client_id, scope_id)
    )
2025-05-25 12:59:07.113 DEBUG org.hibernate.SQL - 
    create table organizations (
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        description varchar(1000),
        name varchar(255) not null unique,
        primary key (id)
    )
2025-05-25 12:59:07.116 DEBUG org.hibernate.SQL - 
    create table permission_scopes (
        permission_id bigint not null,
        scope_id bigint not null,
        primary key (permission_id, scope_id)
    )
2025-05-25 12:59:07.119 DEBUG org.hibernate.SQL - 
    create table permissions (
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        name varchar(100) not null unique,
        description TEXT,
        primary key (id)
    )
2025-05-25 12:59:07.122 DEBUG org.hibernate.SQL - 
    create table policies (
        subject_type smallint not null check (subject_type between 0 and 3),
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        resource_id bigint not null,
        subject_id bigint not null,
        updated_at timestamp(6) not null,
        action varchar(255) not null,
        condition_json TEXT,
        effect varchar(255) not null check (effect in ('ALLOW','DENY')),
        primary key (id)
    )
2025-05-25 12:59:07.129 DEBUG org.hibernate.SQL - 
    create table resources (
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        name varchar(100) not null,
        description TEXT,
        http_method varchar(255) not null check (http_method in ('GET','POST','PUT','DELETE','PATCH','HEAD','OPTIONS')),
        path varchar(255) not null,
        primary key (id)
    )
2025-05-25 12:59:07.131 DEBUG org.hibernate.SQL - 
    create table role_permissions (
        permission_id bigint not null,
        role_id bigint not null,
        primary key (permission_id, role_id)
    )
2025-05-25 12:59:07.132 DEBUG org.hibernate.SQL - 
    create table roles (
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        name varchar(50) not null unique,
        description TEXT,
        primary key (id)
    )
2025-05-25 12:59:07.139 DEBUG org.hibernate.SQL - 
    create table scopes (
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        updated_at timestamp(6) not null,
        name varchar(100) not null unique,
        description TEXT,
        primary key (id)
    )
2025-05-25 12:59:07.143 DEBUG org.hibernate.SQL - 
    create table tokens (
        expired boolean not null,
        revoked boolean not null,
        created_at timestamp(6) not null,
        expires_at timestamp(6) not null,
        token_id bigint generated by default as identity,
        user_id bigint,
        client_id varchar(255),
        token TEXT not null,
        token_type varchar(255) not null check (token_type in ('ACCESS','REFRESH')),
        primary key (token_id)
    )
2025-05-25 12:59:07.146 DEBUG org.hibernate.SQL - 
    create table user_roles (
        role_id bigint not null,
        user_id bigint not null,
        primary key (role_id, user_id)
    )
2025-05-25 12:59:07.148 DEBUG org.hibernate.SQL - 
    create table user_scopes (
        scope_id bigint not null,
        user_id bigint not null,
        primary key (scope_id, user_id)
    )
2025-05-25 12:59:07.151 DEBUG org.hibernate.SQL - 
    create table users (
        enabled boolean not null,
        created_at timestamp(6) not null,
        id bigint generated by default as identity,
        organization_id bigint,
        updated_at timestamp(6) not null,
        username varchar(50) not null unique,
        password varchar(100) not null,
        email varchar(255) not null unique,
        full_name varchar(255),
        primary key (id)
    )
2025-05-25 12:59:07.156 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       add constraint FK21l4ab5xsq7rxwb7b2efptbmt 
       foreign key (scope_id) 
       references scopes
2025-05-25 12:59:07.181 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       add constraint FK4glu0kw16kw6gu23yr5q6vjme 
       foreign key (client_id) 
       references client_applications
2025-05-25 12:59:07.183 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       add constraint FK3smj35weuy4b1fj396l5jvt6g 
       foreign key (scope_id) 
       references scopes
2025-05-25 12:59:07.186 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       add constraint FKacyhrlymxo934q9c4n441dhwf 
       foreign key (permission_id) 
       references permissions
2025-05-25 12:59:07.189 DEBUG org.hibernate.SQL - 
    alter table if exists policies 
       add constraint FKs49d98df3xexcyui98cwpek9p 
       foreign key (resource_id) 
       references resources
2025-05-25 12:59:07.191 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       add constraint FKegdk29eiy7mdtefy5c7eirr6e 
       foreign key (permission_id) 
       references permissions
2025-05-25 12:59:07.193 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       add constraint FKn5fotdgk8d1xvo8nav9uv3muc 
       foreign key (role_id) 
       references roles
2025-05-25 12:59:07.195 DEBUG org.hibernate.SQL - 
    alter table if exists tokens 
       add constraint FK2dylsfo39lgjyqml2tbe0b0ss 
       foreign key (user_id) 
       references users
2025-05-25 12:59:07.198 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       add constraint FKh8ciramu9cc9q3qcqiv4ue8a6 
       foreign key (role_id) 
       references roles
2025-05-25 12:59:07.201 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       add constraint FKhfh9dx7w3ubf1co1vdev94g3f 
       foreign key (user_id) 
       references users
2025-05-25 12:59:07.203 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       add constraint FK4gc7xv8r1p0j6ykgn5h4nx934 
       foreign key (scope_id) 
       references scopes
2025-05-25 12:59:07.205 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       add constraint FKspv2c7f3cxhd1242nkabx95s5 
       foreign key (user_id) 
       references users
2025-05-25 12:59:07.208 DEBUG org.hibernate.SQL - 
    alter table if exists users 
       add constraint FKqpugllwvyv37klq7ft9m8aqxk 
       foreign key (organization_id) 
       references organizations
2025-05-25 12:59:07.720 DEBUG c.e.i.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-05-25 12:59:07.782 INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name customUserDetailsService
2025-05-25 12:59:08.297 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.name,
        r1_0.updated_at 
    from
        roles r1_0 
    where
        r1_0.name=?
2025-05-25 12:59:08.419 DEBUG org.hibernate.SQL - 
    insert 
    into
        roles
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:59:08.455 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0
2025-05-25 12:59:08.465 DEBUG org.hibernate.SQL - 
    select
        r1_0.id,
        r1_0.created_at,
        r1_0.description,
        r1_0.name,
        p1_0.role_id,
        p1_1.id,
        p1_1.created_at,
        p1_1.description,
        p1_1.name,
        p1_1.updated_at,
        r1_0.updated_at 
    from
        roles r1_0 
    left join
        role_permissions p1_0 
            on r1_0.id=p1_0.role_id 
    left join
        permissions p1_1 
            on p1_1.id=p1_0.permission_id 
    where
        r1_0.id=?
2025-05-25 12:59:08.473 DEBUG org.hibernate.SQL - 
    select
        u1_0.role_id,
        u1_1.id,
        u1_1.created_at,
        u1_1.email,
        u1_1.enabled,
        u1_1.full_name,
        u1_1.organization_id,
        u1_1.password,
        u1_1.updated_at,
        u1_1.username 
    from
        user_roles u1_0 
    join
        users u1_1 
            on u1_1.id=u1_0.user_id 
    where
        u1_0.role_id=?
2025-05-25 12:59:08.486 DEBUG org.hibernate.SQL - 
    update
        roles 
    set
        description=?,
        name=?,
        updated_at=? 
    where
        id=?
2025-05-25 12:59:08.491 INFO  c.e.i.s.AdminInitializationService - Updated admin role with 0 permissions
2025-05-25 12:59:08.493 DEBUG org.hibernate.SQL - 
    select
        u1_0.id,
        u1_0.created_at,
        u1_0.email,
        u1_0.enabled,
        u1_0.full_name,
        u1_0.organization_id,
        u1_0.password,
        u1_0.updated_at,
        u1_0.username 
    from
        users u1_0 
    where
        u1_0.username=?
2025-05-25 12:59:08.648 DEBUG org.hibernate.SQL - 
    insert 
    into
        users
        (created_at, email, enabled, full_name, organization_id, password, updated_at, username) 
    values
        (?, ?, ?, ?, ?, ?, ?, ?)
2025-05-25 12:59:08.653 DEBUG org.hibernate.SQL - 
    insert 
    into
        user_roles
        (user_id, role_id) 
    values
        (?, ?)
2025-05-25 12:59:08.656 INFO  c.e.i.s.AdminInitializationService - Created admin user with username: admin
2025-05-25 12:59:08.841 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-05-25 12:59:09.014 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:59:09.019 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:59:09.022 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ORGANIZATION_READ
2025-05-25 12:59:09.024 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:59:09.026 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:59:09.028 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: USER_UPDATE
2025-05-25 12:59:09.030 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:59:09.033 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:59:09.036 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: USER_READ
2025-05-25 12:59:09.038 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:59:09.040 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:59:09.042 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: SCOPE_READ
2025-05-25 12:59:09.044 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:59:09.046 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:59:09.048 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: RESOURCE_DELETE
2025-05-25 12:59:09.050 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:59:09.053 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:59:09.055 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: SCOPE_DELETE
2025-05-25 12:59:09.057 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:59:09.059 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:59:09.061 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: SCOPE_CREATE
2025-05-25 12:59:09.063 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:59:09.066 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:59:09.068 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ROLE_DELETE
2025-05-25 12:59:09.071 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:59:09.073 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:59:09.074 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: POLICY_READ
2025-05-25 12:59:09.076 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:59:09.079 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:59:09.080 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:59:09.082 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: POLICY_CREATE
2025-05-25 12:59:09.084 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:59:09.088 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:59:09.090 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:59:09.092 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ORGANIZATION_CREATE
2025-05-25 12:59:09.093 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:59:09.096 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:59:09.097 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ROLE_READ
2025-05-25 12:59:09.099 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:59:09.102 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:59:09.105 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: CLIENT_CREATE
2025-05-25 12:59:09.106 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:59:09.109 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:59:09.111 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: RESOURCE_UPDATE
2025-05-25 12:59:09.113 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:59:09.116 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:59:09.119 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ROLE_CREATE
2025-05-25 12:59:09.122 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:59:09.125 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:59:09.128 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: SCOPE_UPDATE
2025-05-25 12:59:09.130 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:59:09.132 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:59:09.134 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ROLE_UPDATE
2025-05-25 12:59:09.136 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:59:09.138 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:59:09.139 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: RESOURCE_READ
2025-05-25 12:59:09.141 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:59:09.143 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:59:09.144 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:59:09.146 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ORGANIZATION_DELETE
2025-05-25 12:59:09.147 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:59:09.149 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:59:09.152 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:59:09.154 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: POLICY_DELETE
2025-05-25 12:59:09.156 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:59:09.158 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:59:09.160 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: USER_DELETE
2025-05-25 12:59:09.162 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:59:09.171 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:59:09.179 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:59:09.186 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: ORGANIZATION_UPDATE
2025-05-25 12:59:09.188 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:59:09.191 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:59:09.193 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:59:09.195 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: POLICY_UPDATE
2025-05-25 12:59:09.197 DEBUG org.hibernate.SQL - 
    select
        p1_0.id,
        p1_0.created_at,
        p1_0.description,
        p1_0.name,
        p1_0.updated_at 
    from
        permissions p1_0 
    where
        p1_0.name=?
2025-05-25 12:59:09.199 DEBUG org.hibernate.SQL - 
    insert 
    into
        permissions
        (created_at, description, name, updated_at) 
    values
        (?, ?, ?, ?)
2025-05-25 12:59:09.202 INFO  c.e.i.s.PermissionRegistrationService - Created new permission: RESOURCE_CREATE
2025-05-25 12:59:09.505 DEBUG o.s.s.web.DefaultSecurityFilterChain - Will secure any request with filters: DisableEncodeUrlFilter, WebAsyncManagerIntegrationFilter, SecurityContextHolderFilter, HeaderWriterFilter, LogoutFilter, JwtAuthenticationFilter, RequestCacheAwareFilter, SecurityContextHolderAwareRequestFilter, AnonymousAuthenticationFilter, SessionManagementFilter, ExceptionTranslationFilter, AuthorizationFilter
2025-05-25 12:59:09.772 INFO  o.s.b.a.h.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:testdb'
2025-05-25 12:59:10.067 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 36609 (http) with context path '/'
2025-05-25 12:59:10.079 INFO  c.e.iam.integration.AuthAndRoleTest - Started AuthAndRoleTest in 7.563 seconds (process running for 8.695)
2025-05-25 12:59:10.743 INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-05-25 12:59:10.748 INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-05-25 12:59:10.757 DEBUG org.hibernate.SQL - 
    set client_min_messages = WARNING
2025-05-25 12:59:10.758 ERROR o.h.t.s.i.SchemaDropperImpl$DelayedDropActionImpl - HHH000478: Unsuccessful: 
    set client_min_messages = WARNING
2025-05-25 12:59:10.759 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       drop constraint if exists FK21l4ab5xsq7rxwb7b2efptbmt
2025-05-25 12:59:10.760 DEBUG org.hibernate.SQL - 
    alter table if exists client_scopes 
       drop constraint if exists FK4glu0kw16kw6gu23yr5q6vjme
2025-05-25 12:59:10.761 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       drop constraint if exists FK3smj35weuy4b1fj396l5jvt6g
2025-05-25 12:59:10.762 DEBUG org.hibernate.SQL - 
    alter table if exists permission_scopes 
       drop constraint if exists FKacyhrlymxo934q9c4n441dhwf
2025-05-25 12:59:10.763 DEBUG org.hibernate.SQL - 
    alter table if exists policies 
       drop constraint if exists FKs49d98df3xexcyui98cwpek9p
2025-05-25 12:59:10.764 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       drop constraint if exists FKegdk29eiy7mdtefy5c7eirr6e
2025-05-25 12:59:10.764 DEBUG org.hibernate.SQL - 
    alter table if exists role_permissions 
       drop constraint if exists FKn5fotdgk8d1xvo8nav9uv3muc
2025-05-25 12:59:10.765 DEBUG org.hibernate.SQL - 
    alter table if exists tokens 
       drop constraint if exists FK2dylsfo39lgjyqml2tbe0b0ss
2025-05-25 12:59:10.766 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       drop constraint if exists FKh8ciramu9cc9q3qcqiv4ue8a6
2025-05-25 12:59:10.767 DEBUG org.hibernate.SQL - 
    alter table if exists user_roles 
       drop constraint if exists FKhfh9dx7w3ubf1co1vdev94g3f
2025-05-25 12:59:10.768 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       drop constraint if exists FK4gc7xv8r1p0j6ykgn5h4nx934
2025-05-25 12:59:10.768 DEBUG org.hibernate.SQL - 
    alter table if exists user_scopes 
       drop constraint if exists FKspv2c7f3cxhd1242nkabx95s5
2025-05-25 12:59:10.769 DEBUG org.hibernate.SQL - 
    alter table if exists users 
       drop constraint if exists FKqpugllwvyv37klq7ft9m8aqxk
2025-05-25 12:59:10.770 DEBUG org.hibernate.SQL - 
    drop table if exists client_applications cascade
2025-05-25 12:59:10.772 DEBUG org.hibernate.SQL - 
    drop table if exists client_scopes cascade
2025-05-25 12:59:10.773 DEBUG org.hibernate.SQL - 
    drop table if exists organizations cascade
2025-05-25 12:59:10.774 DEBUG org.hibernate.SQL - 
    drop table if exists permission_scopes cascade
2025-05-25 12:59:10.775 DEBUG org.hibernate.SQL - 
    drop table if exists permissions cascade
2025-05-25 12:59:10.776 DEBUG org.hibernate.SQL - 
    drop table if exists policies cascade
2025-05-25 12:59:10.777 DEBUG org.hibernate.SQL - 
    drop table if exists resources cascade
2025-05-25 12:59:10.778 DEBUG org.hibernate.SQL - 
    drop table if exists role_permissions cascade
2025-05-25 12:59:10.779 DEBUG org.hibernate.SQL - 
    drop table if exists roles cascade
2025-05-25 12:59:10.780 DEBUG org.hibernate.SQL - 
    drop table if exists scopes cascade
2025-05-25 12:59:10.782 DEBUG org.hibernate.SQL - 
    drop table if exists tokens cascade
2025-05-25 12:59:10.783 DEBUG org.hibernate.SQL - 
    drop table if exists user_roles cascade
2025-05-25 12:59:10.784 DEBUG org.hibernate.SQL - 
    drop table if exists user_scopes cascade
2025-05-25 12:59:10.786 DEBUG org.hibernate.SQL - 
    drop table if exists users cascade
2025-05-25 12:59:10.790 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-25 12:59:10.793 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-25 13:00:49.668 INFO  c.e.iam.integration.AuthAndRoleTest - Starting AuthAndRoleTest using Java 21.0.7 with PID 44243 (started by descent in /home/descent/Documents/VDT/vdt5-iam-system/iam-service)
2025-05-25 13:00:49.669 DEBUG c.e.iam.integration.AuthAndRoleTest - Running with Spring Boot v3.4.5, Spring v6.2.6
2025-05-25 13:00:49.670 INFO  c.e.iam.integration.AuthAndRoleTest - The following 1 profile is active: "test-real"
2025-05-25 13:00:50.667 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-05-25 13:00:50.762 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 86 ms. Found 9 JPA repository interfaces.
2025-05-25 13:00:51.600 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 0 (http)
2025-05-25 13:00:51.613 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-25 13:00:51.613 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.40]
2025-05-25 13:00:51.657 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-25 13:00:51.657 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1965 ms
2025-05-25 13:00:52.188 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-25 13:00:52.580 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@4f0c1409
2025-05-25 13:00:52.582 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-25 13:00:54.933 DEBUG c.e.i.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-05-25 13:00:54.977 INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name customUserDetailsService
2025-05-25 13:00:55.570 INFO  c.e.i.s.AdminInitializationService - Updated admin role with 30 permissions
2025-05-25 13:00:55.717 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-05-25 13:00:56.678 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 42391 (http) with context path '/'
2025-05-25 13:00:56.689 INFO  c.e.iam.integration.AuthAndRoleTest - Started AuthAndRoleTest in 7.685 seconds (process running for 8.747)
2025-05-25 13:00:57.328 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-05-25 13:00:57.328 INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-05-25 13:00:57.330 INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-05-25 13:00:57.710 INFO  c.e.iam.integration.AuthAndRoleTest - Testing /users endpoint with admin token: eyJhbGciOiJIUzI1NiJ9.eyJ0eXBlIjoidXNlciIsInVzZXJuYW1lIjoiYWRtaW4iLCJzdWIiOiJhZG1pbiIsImlhdCI6MTc0ODE2NzI1NywiZXhwIjoxNzQ4MTcwODU3fQ.gRFQTxGzBfy_Iqnn_oe7_GbSVBv9QQnA2OCyyrVV5wA
2025-05-25 13:00:57.784 INFO  c.e.iam.integration.AuthAndRoleTest - Raw response from /users: Status=200 OK, Body=[{"id":1,"organization_id":null,"username":"admin","email":"admin@example.com","fullName":"Admin User","role_ids":[1],"scope_ids":[]}]
2025-05-25 13:00:57.818 INFO  c.e.iam.integration.AuthAndRoleTest - Parsed response: Status=200 OK, Body=[{id=1, organization_id=null, username=admin, email=admin@example.com, fullName=Admin User, role_ids=[1], scope_ids=[]}]
2025-05-25 13:00:57.890 INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-05-25 13:00:57.893 INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-05-25 13:00:57.904 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-25 13:00:57.915 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-25 13:12:14.178 INFO  c.e.iam.IamServiceApplicationTests - Starting IamServiceApplicationTests using Java 21.0.7 with PID 52756 (started by descent in /home/descent/Documents/VDT/vdt5-iam-system/iam-service)
2025-05-25 13:12:14.180 DEBUG c.e.iam.IamServiceApplicationTests - Running with Spring Boot v3.4.5, Spring v6.2.6
2025-05-25 13:12:14.181 INFO  c.e.iam.IamServiceApplicationTests - No active profile set, falling back to 1 default profile: "default"
2025-05-25 13:12:15.268 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-05-25 13:12:15.403 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 117 ms. Found 9 JPA repository interfaces.
2025-05-25 13:12:16.464 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-25 13:12:16.934 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@415419a4
2025-05-25 13:12:16.936 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-25 13:12:19.408 INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name customUserDetailsService
2025-05-25 13:12:19.772 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-05-25 13:12:20.271 WARN  o.s.w.c.s.GenericWebApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'roleInitializationService': Invocation of init method failed
2025-05-25 13:12:20.275 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-25 13:12:20.283 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-25 13:12:20.299 INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-05-25 13:12:20.315 ERROR o.s.boot.SpringApplication - Application run failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'roleInitializationService': Invocation of init method failed
	at org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor.postProcessBeforeInitialization(InitDestroyAnnotationBeanPostProcessor.java:222)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyBeanPostProcessorsBeforeInitialization(AbstractAutowireCapableBeanFactory.java:429)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1810)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:607)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:371)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:202)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.instantiateSingleton(DefaultListableBeanFactory.java:1221)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingleton(DefaultListableBeanFactory.java:1187)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:1122)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:987)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:627)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:753)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:439)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:318)
	at org.springframework.boot.test.context.SpringBootContextLoader.lambda$loadContext$3(SpringBootContextLoader.java:144)
	at org.springframework.util.function.ThrowingSupplier.get(ThrowingSupplier.java:58)
	at org.springframework.util.function.ThrowingSupplier.get(ThrowingSupplier.java:46)
	at org.springframework.boot.SpringApplication.withHook(SpringApplication.java:1462)
	at org.springframework.boot.test.context.SpringBootContextLoader$ContextLoaderHook.run(SpringBootContextLoader.java:563)
	at org.springframework.boot.test.context.SpringBootContextLoader.loadContext(SpringBootContextLoader.java:144)
	at org.springframework.boot.test.context.SpringBootContextLoader.loadContext(SpringBootContextLoader.java:110)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContextInternal(DefaultCacheAwareContextLoaderDelegate.java:225)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:152)
	at org.springframework.test.context.support.DefaultTestContext.getApplicationContext(DefaultTestContext.java:130)
	at org.springframework.test.context.web.ServletTestExecutionListener.setUpRequestContextIfNecessary(ServletTestExecutionListener.java:200)
	at org.springframework.test.context.web.ServletTestExecutionListener.prepareTestInstance(ServletTestExecutionListener.java:139)
	at org.springframework.test.context.TestContextManager.prepareTestInstance(TestContextManager.java:260)
	at org.springframework.test.context.junit.jupiter.SpringExtension.postProcessTestInstance(SpringExtension.java:159)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$invokeTestInstancePostProcessors$11(ClassBasedTestDescriptor.java:378)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.executeAndMaskThrowable(ClassBasedTestDescriptor.java:383)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$invokeTestInstancePostProcessors$12(ClassBasedTestDescriptor.java:378)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:184)
	at java.base/java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:197)
	at java.base/java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:179)
	at java.base/java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:197)
	at java.base/java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1708)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:509)
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:499)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:596)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.invokeTestInstancePostProcessors(ClassBasedTestDescriptor.java:377)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$instantiateAndPostProcessTestInstance$7(ClassBasedTestDescriptor.java:290)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.instantiateAndPostProcessTestInstance(ClassBasedTestDescriptor.java:289)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$testInstancesProvider$5(ClassBasedTestDescriptor.java:279)
	at java.base/java.util.Optional.orElseGet(Optional.java:364)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$testInstancesProvider$6(ClassBasedTestDescriptor.java:278)
	at org.junit.jupiter.engine.execution.TestInstancesProvider.getTestInstances(TestInstancesProvider.java:31)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$prepare$1(TestMethodTestDescriptor.java:105)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.prepare(TestMethodTestDescriptor.java:104)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.prepare(TestMethodTestDescriptor.java:68)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$prepare$2(NodeTestTask.java:128)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.prepare(NodeTestTask.java:128)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1596)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1596)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:198)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:169)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:93)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:58)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:141)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:57)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:103)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:85)
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:47)
	at org.apache.maven.surefire.junitplatform.LazyLauncher.execute(LazyLauncher.java:56)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:194)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:150)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:385)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:507)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:495)
Caused by: org.springframework.dao.InvalidDataAccessApiUsageException: detached entity passed to persist: com.example.iam.entity.Permission
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:314)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy195.save(Unknown Source)
	at com.example.iam.service.RoleInitializationService.lambda$createRoleIfNotExists$1(RoleInitializationService.java:68)
	at java.base/java.util.Optional.orElseGet(Optional.java:364)
	at com.example.iam.service.RoleInitializationService.createRoleIfNotExists(RoleInitializationService.java:62)
	at com.example.iam.service.RoleInitializationService.initializeRoles(RoleInitializationService.java:43)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor$LifecycleMethod.invoke(InitDestroyAnnotationBeanPostProcessor.java:457)
	at org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor$LifecycleMetadata.invokeInitMethods(InitDestroyAnnotationBeanPostProcessor.java:401)
	at org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor.postProcessBeforeInitialization(InitDestroyAnnotationBeanPostProcessor.java:219)
	... 100 common frames omitted
Caused by: org.hibernate.PersistentObjectException: detached entity passed to persist: com.example.iam.entity.Permission
	at org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:90)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:79)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:138)
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:803)
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:751)
	at org.hibernate.engine.spi.CascadingActions$7.cascade(CascadingActions.java:295)
	at org.hibernate.engine.spi.CascadingActions$7.cascade(CascadingActions.java:285)
	at org.hibernate.engine.internal.Cascade.cascadeToOne(Cascade.java:570)
	at org.hibernate.engine.internal.Cascade.cascadeAssociation(Cascade.java:492)
	at org.hibernate.engine.internal.Cascade.cascadeProperty(Cascade.java:253)
	at org.hibernate.engine.internal.Cascade.cascadeCollectionElements(Cascade.java:604)
	at org.hibernate.engine.internal.Cascade.cascadeCollection(Cascade.java:534)
	at org.hibernate.engine.internal.Cascade.cascadeAssociation(Cascade.java:495)
	at org.hibernate.engine.internal.Cascade.cascadeProperty(Cascade.java:253)
	at org.hibernate.engine.internal.Cascade.cascade(Cascade.java:192)
	at org.hibernate.event.internal.AbstractSaveEventListener.cascadeAfterSave(AbstractSaveEventListener.java:520)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:319)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:223)
	at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:136)
	at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:177)
	at org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:95)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:79)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:55)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:761)
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:745)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:320)
	at jdk.proxy2/jdk.proxy2.$Proxy179.persist(Unknown Source)
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:636)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:277)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:515)
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:284)
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:731)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:174)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 114 common frames omitted
2025-05-25 13:12:20.323 WARN  o.s.test.context.TestContextManager - Caught exception while allowing TestExecutionListener [org.springframework.test.context.web.ServletTestExecutionListener] to prepare test instance [com.example.iam.IamServiceApplicationTests@1a30ec16]
java.lang.IllegalStateException: Failed to load ApplicationContext for [WebMergedContextConfiguration@3096a890 testClass = com.example.iam.IamServiceApplicationTests, locations = [], classes = [com.example.iam.IamServiceApplication], contextInitializerClasses = [], activeProfiles = [], propertySourceDescriptors = [], propertySourceProperties = ["org.springframework.boot.test.context.SpringBootTestContextBootstrapper=true"], contextCustomizers = [org.springframework.boot.test.context.filter.ExcludeFilterContextCustomizer@6f1a80fb, org.springframework.boot.test.json.DuplicateJsonObjectContextCustomizerFactory$DuplicateJsonObjectContextCustomizer@4f6b687e, org.springframework.boot.test.mock.mockito.MockitoContextCustomizer@0, org.springframework.boot.test.web.client.TestRestTemplateContextCustomizer@1e86a5a7, org.springframework.boot.test.web.reactor.netty.DisableReactorResourceFactoryGlobalResourcesContextCustomizerFactory$DisableReactorResourceFactoryGlobalResourcesContextCustomizerCustomizer@2e179f3e, org.springframework.boot.test.autoconfigure.OnFailureConditionReportContextCustomizerFactory$OnFailureConditionReportContextCustomizer@3bddc676, org.springframework.boot.test.autoconfigure.actuate.observability.ObservabilityContextCustomizerFactory$DisableObservabilityContextCustomizer@1f, org.springframework.boot.test.autoconfigure.properties.PropertyMappingContextCustomizer@0, org.springframework.boot.test.autoconfigure.web.servlet.WebDriverContextCustomizer@68d651f2, org.springframework.test.context.support.DynamicPropertiesContextCustomizer@0, org.springframework.boot.test.context.SpringBootTestAnnotation@e6f8bd63], resourceBasePath = "src/main/webapp", contextLoader = org.springframework.boot.test.context.SpringBootContextLoader, parent = null]
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:180)
	at org.springframework.test.context.support.DefaultTestContext.getApplicationContext(DefaultTestContext.java:130)
	at org.springframework.test.context.web.ServletTestExecutionListener.setUpRequestContextIfNecessary(ServletTestExecutionListener.java:200)
	at org.springframework.test.context.web.ServletTestExecutionListener.prepareTestInstance(ServletTestExecutionListener.java:139)
	at org.springframework.test.context.TestContextManager.prepareTestInstance(TestContextManager.java:260)
	at org.springframework.test.context.junit.jupiter.SpringExtension.postProcessTestInstance(SpringExtension.java:159)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$invokeTestInstancePostProcessors$11(ClassBasedTestDescriptor.java:378)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.executeAndMaskThrowable(ClassBasedTestDescriptor.java:383)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$invokeTestInstancePostProcessors$12(ClassBasedTestDescriptor.java:378)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:184)
	at java.base/java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:197)
	at java.base/java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:179)
	at java.base/java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:197)
	at java.base/java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1708)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:509)
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:499)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:596)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.invokeTestInstancePostProcessors(ClassBasedTestDescriptor.java:377)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$instantiateAndPostProcessTestInstance$7(ClassBasedTestDescriptor.java:290)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.instantiateAndPostProcessTestInstance(ClassBasedTestDescriptor.java:289)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$testInstancesProvider$5(ClassBasedTestDescriptor.java:279)
	at java.base/java.util.Optional.orElseGet(Optional.java:364)
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$testInstancesProvider$6(ClassBasedTestDescriptor.java:278)
	at org.junit.jupiter.engine.execution.TestInstancesProvider.getTestInstances(TestInstancesProvider.java:31)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$prepare$1(TestMethodTestDescriptor.java:105)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.prepare(TestMethodTestDescriptor.java:104)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.prepare(TestMethodTestDescriptor.java:68)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$prepare$2(NodeTestTask.java:128)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.prepare(NodeTestTask.java:128)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1596)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1596)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:198)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:169)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:93)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:58)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:141)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:57)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:103)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:85)
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:47)
	at org.apache.maven.surefire.junitplatform.LazyLauncher.execute(LazyLauncher.java:56)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:194)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:150)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:385)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:507)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:495)
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'roleInitializationService': Invocation of init method failed
	at org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor.postProcessBeforeInitialization(InitDestroyAnnotationBeanPostProcessor.java:222)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyBeanPostProcessorsBeforeInitialization(AbstractAutowireCapableBeanFactory.java:429)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1810)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:607)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:371)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:202)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.instantiateSingleton(DefaultListableBeanFactory.java:1221)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingleton(DefaultListableBeanFactory.java:1187)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:1122)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:987)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:627)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:753)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:439)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:318)
	at org.springframework.boot.test.context.SpringBootContextLoader.lambda$loadContext$3(SpringBootContextLoader.java:144)
	at org.springframework.util.function.ThrowingSupplier.get(ThrowingSupplier.java:58)
	at org.springframework.util.function.ThrowingSupplier.get(ThrowingSupplier.java:46)
	at org.springframework.boot.SpringApplication.withHook(SpringApplication.java:1462)
	at org.springframework.boot.test.context.SpringBootContextLoader$ContextLoaderHook.run(SpringBootContextLoader.java:563)
	at org.springframework.boot.test.context.SpringBootContextLoader.loadContext(SpringBootContextLoader.java:144)
	at org.springframework.boot.test.context.SpringBootContextLoader.loadContext(SpringBootContextLoader.java:110)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContextInternal(DefaultCacheAwareContextLoaderDelegate.java:225)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:152)
	... 75 common frames omitted
Caused by: org.springframework.dao.InvalidDataAccessApiUsageException: detached entity passed to persist: com.example.iam.entity.Permission
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:314)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy195.save(Unknown Source)
	at com.example.iam.service.RoleInitializationService.lambda$createRoleIfNotExists$1(RoleInitializationService.java:68)
	at java.base/java.util.Optional.orElseGet(Optional.java:364)
	at com.example.iam.service.RoleInitializationService.createRoleIfNotExists(RoleInitializationService.java:62)
	at com.example.iam.service.RoleInitializationService.initializeRoles(RoleInitializationService.java:43)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor$LifecycleMethod.invoke(InitDestroyAnnotationBeanPostProcessor.java:457)
	at org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor$LifecycleMetadata.invokeInitMethods(InitDestroyAnnotationBeanPostProcessor.java:401)
	at org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor.postProcessBeforeInitialization(InitDestroyAnnotationBeanPostProcessor.java:219)
	... 100 common frames omitted
Caused by: org.hibernate.PersistentObjectException: detached entity passed to persist: com.example.iam.entity.Permission
	at org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:90)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:79)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:138)
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:803)
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:751)
	at org.hibernate.engine.spi.CascadingActions$7.cascade(CascadingActions.java:295)
	at org.hibernate.engine.spi.CascadingActions$7.cascade(CascadingActions.java:285)
	at org.hibernate.engine.internal.Cascade.cascadeToOne(Cascade.java:570)
	at org.hibernate.engine.internal.Cascade.cascadeAssociation(Cascade.java:492)
	at org.hibernate.engine.internal.Cascade.cascadeProperty(Cascade.java:253)
	at org.hibernate.engine.internal.Cascade.cascadeCollectionElements(Cascade.java:604)
	at org.hibernate.engine.internal.Cascade.cascadeCollection(Cascade.java:534)
	at org.hibernate.engine.internal.Cascade.cascadeAssociation(Cascade.java:495)
	at org.hibernate.engine.internal.Cascade.cascadeProperty(Cascade.java:253)
	at org.hibernate.engine.internal.Cascade.cascade(Cascade.java:192)
	at org.hibernate.event.internal.AbstractSaveEventListener.cascadeAfterSave(AbstractSaveEventListener.java:520)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:319)
	at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:223)
	at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:136)
	at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:177)
	at org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:95)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:79)
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:55)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127)
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:761)
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:745)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:320)
	at jdk.proxy2/jdk.proxy2.$Proxy179.persist(Unknown Source)
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:636)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:277)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:515)
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:284)
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:731)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:174)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 114 common frames omitted
2025-05-25 13:12:20.338 INFO  o.s.t.c.s.AnnotationConfigContextLoaderUtils - Could not detect default configuration classes for test class [com.example.iam.integration.AuthAndRoleTest]: AuthAndRoleTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2025-05-25 13:12:20.350 INFO  o.s.b.t.c.SpringBootTestContextBootstrapper - Found @SpringBootConfiguration com.example.iam.IamServiceApplication for test class com.example.iam.integration.AuthAndRoleTest
2025-05-25 13:12:20.362 INFO  o.s.b.d.r.RestartApplicationListener - Restart disabled due to context in which it is running
2025-05-25 13:12:20.433 INFO  c.e.iam.integration.AuthAndRoleTest - Starting AuthAndRoleTest using Java 21.0.7 with PID 52756 (started by descent in /home/descent/Documents/VDT/vdt5-iam-system/iam-service)
2025-05-25 13:12:20.437 DEBUG c.e.iam.integration.AuthAndRoleTest - Running with Spring Boot v3.4.5, Spring v6.2.6
2025-05-25 13:12:20.438 INFO  c.e.iam.integration.AuthAndRoleTest - The following 1 profile is active: "test-real"
2025-05-25 13:12:20.750 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-05-25 13:12:20.769 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 17 ms. Found 9 JPA repository interfaces.
2025-05-25 13:12:21.194 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 0 (http)
2025-05-25 13:12:21.212 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-25 13:12:21.213 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.40]
2025-05-25 13:12:21.275 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-25 13:12:21.276 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 831 ms
2025-05-25 13:12:21.399 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Starting...
2025-05-25 13:12:21.429 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-2 - Added connection org.postgresql.jdbc.PgConnection@671ba0dc
2025-05-25 13:12:21.430 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Start completed.
2025-05-25 13:12:22.670 DEBUG c.e.i.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-05-25 13:12:22.695 INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name customUserDetailsService
2025-05-25 13:12:22.822 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-05-25 13:12:22.976 WARN  o.s.b.w.s.c.AnnotationConfigServletWebServerApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'roleInitializationService': Invocation of init method failed
2025-05-25 13:12:22.978 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Shutdown initiated...
2025-05-25 13:12:22.984 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Shutdown completed.
2025-05-25 13:12:22.986 INFO  o.a.catalina.core.StandardService - Stopping service [Tomcat]
2025-05-25 13:12:22.997 INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2025-05-25 13:12:22.999 ERROR o.s.boot.SpringApplication - Application run failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'roleInitializationService': Invocation of init method failed
	at org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor.postProcessBeforeInitialization(InitDestroyAnnotationBeanPostProcessor.java:222) ~[spring-beans-6.2.6.jar:6.2.6]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyBeanPostProcessorsBeforeInitialization(AbstractAutowireCapableBeanFactory.java:429) ~[spring-beans-6.2.6.jar:6.2.6]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1810) ~[spring-beans-6.2.6.jar:6.2.6]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:607) ~[spring-beans-6.2.6.jar:6.2.6]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529) ~[spring-beans-6.2.6.jar:6.2.6]
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339) ~[spring-beans-6.2.6.jar:6.2.6]
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:371) ~[spring-beans-6.2.6.jar:6.2.6]
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337) ~[spring-beans-6.2.6.jar:6.2.6]
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:202) ~[spring-beans-6.2.6.jar:6.2.6]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.instantiateSingleton(DefaultListableBeanFactory.java:1221) ~[spring-beans-6.2.6.jar:6.2.6]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingleton(DefaultListableBeanFactory.java:1187) ~[spring-beans-6.2.6.jar:6.2.6]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:1122) ~[spring-beans-6.2.6.jar:6.2.6]
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:987) ~[spring-context-6.2.6.jar:6.2.6]
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:627) ~[spring-context-6.2.6.jar:6.2.6]
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146) ~[spring-boot-3.4.5.jar:3.4.5]
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:753) ~[spring-boot-3.4.5.jar:3.4.5]
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:439) ~[spring-boot-3.4.5.jar:3.4.5]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:318) ~[spring-boot-3.4.5.jar:3.4.5]
	at org.springframework.boot.test.context.SpringBootContextLoader.lambda$loadContext$3(SpringBootContextLoader.java:144) ~[spring-boot-test-3.4.5.jar:3.4.5]
	at org.springframework.util.function.ThrowingSupplier.get(ThrowingSupplier.java:58) ~[spring-core-6.2.6.jar:6.2.6]
	at org.springframework.util.function.ThrowingSupplier.get(ThrowingSupplier.java:46) ~[spring-core-6.2.6.jar:6.2.6]
	at org.springframework.boot.SpringApplication.withHook(SpringApplication.java:1462) ~[spring-boot-3.4.5.jar:3.4.5]
	at org.springframework.boot.test.context.SpringBootContextLoader$ContextLoaderHook.run(SpringBootContextLoader.java:563) ~[spring-boot-test-3.4.5.jar:3.4.5]
	at org.springframework.boot.test.context.SpringBootContextLoader.loadContext(SpringBootContextLoader.java:144) ~[spring-boot-test-3.4.5.jar:3.4.5]
	at org.springframework.boot.test.context.SpringBootContextLoader.loadContext(SpringBootContextLoader.java:110) ~[spring-boot-test-3.4.5.jar:3.4.5]
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContextInternal(DefaultCacheAwareContextLoaderDelegate.java:225) ~[spring-test-6.2.6.jar:6.2.6]
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:152) ~[spring-test-6.2.6.jar:6.2.6]
	at org.springframework.test.context.support.DefaultTestContext.getApplicationContext(DefaultTestContext.java:130) ~[spring-test-6.2.6.jar:6.2.6]
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.injectDependencies(DependencyInjectionTestExecutionListener.java:155) ~[spring-test-6.2.6.jar:6.2.6]
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.prepareTestInstance(DependencyInjectionTestExecutionListener.java:111) ~[spring-test-6.2.6.jar:6.2.6]
	at org.springframework.test.context.TestContextManager.prepareTestInstance(TestContextManager.java:260) ~[spring-test-6.2.6.jar:6.2.6]
	at org.springframework.test.context.junit.jupiter.SpringExtension.postProcessTestInstance(SpringExtension.java:159) ~[spring-test-6.2.6.jar:6.2.6]
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$invokeTestInstancePostProcessors$11(ClassBasedTestDescriptor.java:378) ~[junit-jupiter-engine-5.11.4.jar:5.11.4]
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.executeAndMaskThrowable(ClassBasedTestDescriptor.java:383) ~[junit-jupiter-engine-5.11.4.jar:5.11.4]
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$invokeTestInstancePostProcessors$12(ClassBasedTestDescriptor.java:378) ~[junit-jupiter-engine-5.11.4.jar:5.11.4]
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:184) ~[na:na]
	at java.base/java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:197) ~[na:na]
	at java.base/java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:179) ~[na:na]
	at java.base/java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:197) ~[na:na]
	at java.base/java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1708) ~[na:na]
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:509) ~[na:na]
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:499) ~[na:na]
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151) ~[na:na]
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174) ~[na:na]
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[na:na]
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:596) ~[na:na]
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.invokeTestInstancePostProcessors(ClassBasedTestDescriptor.java:377) ~[junit-jupiter-engine-5.11.4.jar:5.11.4]
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$instantiateAndPostProcessTestInstance$7(ClassBasedTestDescriptor.java:290) ~[junit-jupiter-engine-5.11.4.jar:5.11.4]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.instantiateAndPostProcessTestInstance(ClassBasedTestDescriptor.java:289) ~[junit-jupiter-engine-5.11.4.jar:5.11.4]
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$testInstancesProvider$5(ClassBasedTestDescriptor.java:279) ~[junit-jupiter-engine-5.11.4.jar:5.11.4]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$testInstancesProvider$6(ClassBasedTestDescriptor.java:278) ~[junit-jupiter-engine-5.11.4.jar:5.11.4]
	at org.junit.jupiter.engine.execution.TestInstancesProvider.getTestInstances(TestInstancesProvider.java:31) ~[junit-jupiter-engine-5.11.4.jar:5.11.4]
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$prepare$1(TestMethodTestDescriptor.java:105) ~[junit-jupiter-engine-5.11.4.jar:5.11.4]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.prepare(TestMethodTestDescriptor.java:104) ~[junit-jupiter-engine-5.11.4.jar:5.11.4]
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.prepare(TestMethodTestDescriptor.java:68) ~[junit-jupiter-engine-5.11.4.jar:5.11.4]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$prepare$2(NodeTestTask.java:128) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.prepare(NodeTestTask.java:128) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1596) ~[na:na]
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1596) ~[na:na]
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:198) ~[junit-platform-launcher-1.11.4.jar:1.11.4]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:169) ~[junit-platform-launcher-1.11.4.jar:1.11.4]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:93) ~[junit-platform-launcher-1.11.4.jar:1.11.4]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:58) ~[junit-platform-launcher-1.11.4.jar:1.11.4]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:141) ~[junit-platform-launcher-1.11.4.jar:1.11.4]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:57) ~[junit-platform-launcher-1.11.4.jar:1.11.4]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:103) ~[junit-platform-launcher-1.11.4.jar:1.11.4]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:85) ~[junit-platform-launcher-1.11.4.jar:1.11.4]
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:47) ~[junit-platform-launcher-1.11.4.jar:1.11.4]
	at org.apache.maven.surefire.junitplatform.LazyLauncher.execute(LazyLauncher.java:56) ~[surefire-junit-platform-3.5.3.jar:3.5.3]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:194) ~[surefire-junit-platform-3.5.3.jar:3.5.3]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:150) ~[surefire-junit-platform-3.5.3.jar:3.5.3]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124) ~[surefire-junit-platform-3.5.3.jar:3.5.3]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:385) ~[surefire-booter-3.5.3.jar:3.5.3]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162) ~[surefire-booter-3.5.3.jar:3.5.3]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:507) ~[surefire-booter-3.5.3.jar:3.5.3]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:495) ~[surefire-booter-3.5.3.jar:3.5.3]
Caused by: org.springframework.dao.InvalidDataAccessApiUsageException: detached entity passed to persist: com.example.iam.entity.Permission
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:314) ~[spring-orm-6.2.6.jar:6.2.6]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256) ~[spring-orm-6.2.6.jar:6.2.6]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244) ~[spring-orm-6.2.6.jar:6.2.6]
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560) ~[spring-orm-6.2.6.jar:6.2.6]
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61) ~[spring-tx-6.2.6.jar:6.2.6]
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343) ~[spring-tx-6.2.6.jar:6.2.6]
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160) ~[spring-tx-6.2.6.jar:6.2.6]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165) ~[spring-data-jpa-3.4.5.jar:3.4.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
	at jdk.proxy2/jdk.proxy2.$Proxy195.save(Unknown Source) ~[na:na]
	at com.example.iam.service.RoleInitializationService.lambda$createRoleIfNotExists$1(RoleInitializationService.java:68) ~[classes/:na]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.example.iam.service.RoleInitializationService.createRoleIfNotExists(RoleInitializationService.java:62) ~[classes/:na]
	at com.example.iam.service.RoleInitializationService.initializeRoles(RoleInitializationService.java:43) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor$LifecycleMethod.invoke(InitDestroyAnnotationBeanPostProcessor.java:457) ~[spring-beans-6.2.6.jar:6.2.6]
	at org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor$LifecycleMetadata.invokeInitMethods(InitDestroyAnnotationBeanPostProcessor.java:401) ~[spring-beans-6.2.6.jar:6.2.6]
	at org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor.postProcessBeforeInitialization(InitDestroyAnnotationBeanPostProcessor.java:219) ~[spring-beans-6.2.6.jar:6.2.6]
	... 101 common frames omitted
Caused by: org.hibernate.PersistentObjectException: detached entity passed to persist: com.example.iam.entity.Permission
	at org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:90) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:79) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:138) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:803) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:751) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.engine.spi.CascadingActions$7.cascade(CascadingActions.java:295) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.engine.spi.CascadingActions$7.cascade(CascadingActions.java:285) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.engine.internal.Cascade.cascadeToOne(Cascade.java:570) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.engine.internal.Cascade.cascadeAssociation(Cascade.java:492) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.engine.internal.Cascade.cascadeProperty(Cascade.java:253) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.engine.internal.Cascade.cascadeCollectionElements(Cascade.java:604) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.engine.internal.Cascade.cascadeCollection(Cascade.java:534) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.engine.internal.Cascade.cascadeAssociation(Cascade.java:495) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.engine.internal.Cascade.cascadeProperty(Cascade.java:253) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.engine.internal.Cascade.cascade(Cascade.java:192) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.event.internal.AbstractSaveEventListener.cascadeAfterSave(AbstractSaveEventListener.java:520) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:319) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:223) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:136) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:177) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:95) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:79) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:55) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:761) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:745) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:320) ~[spring-orm-6.2.6.jar:6.2.6]
	at jdk.proxy2/jdk.proxy2.$Proxy179.persist(Unknown Source) ~[na:na]
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:636) ~[spring-data-jpa-3.4.5.jar:3.4.5]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:277) ~[spring-data-commons-3.4.5.jar:3.4.5]
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:515) ~[spring-data-commons-3.4.5.jar:3.4.5]
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:284) ~[spring-data-commons-3.4.5.jar:3.4.5]
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:731) ~[spring-data-commons-3.4.5.jar:3.4.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:174) ~[spring-data-commons-3.4.5.jar:3.4.5]
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380) ~[spring-tx-6.2.6.jar:6.2.6]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-6.2.6.jar:6.2.6]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
	... 115 common frames omitted
2025-05-25 13:12:23.004 WARN  o.s.test.context.TestContextManager - Caught exception while allowing TestExecutionListener [org.springframework.test.context.support.DependencyInjectionTestExecutionListener] to prepare test instance [com.example.iam.integration.AuthAndRoleTest@3220ea38]
java.lang.IllegalStateException: Failed to load ApplicationContext for [WebMergedContextConfiguration@146eda1b testClass = com.example.iam.integration.AuthAndRoleTest, locations = [], classes = [com.example.iam.IamServiceApplication], contextInitializerClasses = [], activeProfiles = ["test-real"], propertySourceDescriptors = [], propertySourceProperties = ["org.springframework.boot.test.context.SpringBootTestContextBootstrapper=true", "server.port=0"], contextCustomizers = [org.springframework.boot.test.context.filter.ExcludeFilterContextCustomizer@6f1a80fb, org.springframework.boot.test.json.DuplicateJsonObjectContextCustomizerFactory$DuplicateJsonObjectContextCustomizer@4f6b687e, org.springframework.boot.test.mock.mockito.MockitoContextCustomizer@0, org.springframework.boot.test.web.client.TestRestTemplateContextCustomizer@1e86a5a7, org.springframework.boot.test.web.reactor.netty.DisableReactorResourceFactoryGlobalResourcesContextCustomizerFactory$DisableReactorResourceFactoryGlobalResourcesContextCustomizerCustomizer@2e179f3e, org.springframework.boot.test.autoconfigure.OnFailureConditionReportContextCustomizerFactory$OnFailureConditionReportContextCustomizer@3bddc676, org.springframework.boot.test.autoconfigure.actuate.observability.ObservabilityContextCustomizerFactory$DisableObservabilityContextCustomizer@1f, org.springframework.boot.test.autoconfigure.properties.PropertyMappingContextCustomizer@0, org.springframework.boot.test.autoconfigure.web.servlet.WebDriverContextCustomizer@68d651f2, org.springframework.test.context.support.DynamicPropertiesContextCustomizer@0, org.springframework.boot.test.context.SpringBootTestAnnotation@8b57d2d4], resourceBasePath = "src/main/webapp", contextLoader = org.springframework.boot.test.context.SpringBootContextLoader, parent = null]
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:180) ~[spring-test-6.2.6.jar:6.2.6]
	at org.springframework.test.context.support.DefaultTestContext.getApplicationContext(DefaultTestContext.java:130) ~[spring-test-6.2.6.jar:6.2.6]
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.injectDependencies(DependencyInjectionTestExecutionListener.java:155) ~[spring-test-6.2.6.jar:6.2.6]
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.prepareTestInstance(DependencyInjectionTestExecutionListener.java:111) ~[spring-test-6.2.6.jar:6.2.6]
	at org.springframework.test.context.TestContextManager.prepareTestInstance(TestContextManager.java:260) ~[spring-test-6.2.6.jar:6.2.6]
	at org.springframework.test.context.junit.jupiter.SpringExtension.postProcessTestInstance(SpringExtension.java:159) ~[spring-test-6.2.6.jar:6.2.6]
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$invokeTestInstancePostProcessors$11(ClassBasedTestDescriptor.java:378) ~[junit-jupiter-engine-5.11.4.jar:5.11.4]
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.executeAndMaskThrowable(ClassBasedTestDescriptor.java:383) ~[junit-jupiter-engine-5.11.4.jar:5.11.4]
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$invokeTestInstancePostProcessors$12(ClassBasedTestDescriptor.java:378) ~[junit-jupiter-engine-5.11.4.jar:5.11.4]
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:184) ~[na:na]
	at java.base/java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:197) ~[na:na]
	at java.base/java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:179) ~[na:na]
	at java.base/java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:197) ~[na:na]
	at java.base/java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1708) ~[na:na]
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:509) ~[na:na]
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:499) ~[na:na]
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151) ~[na:na]
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174) ~[na:na]
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[na:na]
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:596) ~[na:na]
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.invokeTestInstancePostProcessors(ClassBasedTestDescriptor.java:377) ~[junit-jupiter-engine-5.11.4.jar:5.11.4]
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$instantiateAndPostProcessTestInstance$7(ClassBasedTestDescriptor.java:290) ~[junit-jupiter-engine-5.11.4.jar:5.11.4]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.instantiateAndPostProcessTestInstance(ClassBasedTestDescriptor.java:289) ~[junit-jupiter-engine-5.11.4.jar:5.11.4]
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$testInstancesProvider$5(ClassBasedTestDescriptor.java:279) ~[junit-jupiter-engine-5.11.4.jar:5.11.4]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$testInstancesProvider$6(ClassBasedTestDescriptor.java:278) ~[junit-jupiter-engine-5.11.4.jar:5.11.4]
	at org.junit.jupiter.engine.execution.TestInstancesProvider.getTestInstances(TestInstancesProvider.java:31) ~[junit-jupiter-engine-5.11.4.jar:5.11.4]
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$prepare$1(TestMethodTestDescriptor.java:105) ~[junit-jupiter-engine-5.11.4.jar:5.11.4]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.prepare(TestMethodTestDescriptor.java:104) ~[junit-jupiter-engine-5.11.4.jar:5.11.4]
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.prepare(TestMethodTestDescriptor.java:68) ~[junit-jupiter-engine-5.11.4.jar:5.11.4]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$prepare$2(NodeTestTask.java:128) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.prepare(NodeTestTask.java:128) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1596) ~[na:na]
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1596) ~[na:na]
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:198) ~[junit-platform-launcher-1.11.4.jar:1.11.4]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:169) ~[junit-platform-launcher-1.11.4.jar:1.11.4]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:93) ~[junit-platform-launcher-1.11.4.jar:1.11.4]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:58) ~[junit-platform-launcher-1.11.4.jar:1.11.4]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:141) ~[junit-platform-launcher-1.11.4.jar:1.11.4]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:57) ~[junit-platform-launcher-1.11.4.jar:1.11.4]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:103) ~[junit-platform-launcher-1.11.4.jar:1.11.4]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:85) ~[junit-platform-launcher-1.11.4.jar:1.11.4]
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:47) ~[junit-platform-launcher-1.11.4.jar:1.11.4]
	at org.apache.maven.surefire.junitplatform.LazyLauncher.execute(LazyLauncher.java:56) ~[surefire-junit-platform-3.5.3.jar:3.5.3]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:194) ~[surefire-junit-platform-3.5.3.jar:3.5.3]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:150) ~[surefire-junit-platform-3.5.3.jar:3.5.3]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124) ~[surefire-junit-platform-3.5.3.jar:3.5.3]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:385) ~[surefire-booter-3.5.3.jar:3.5.3]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162) ~[surefire-booter-3.5.3.jar:3.5.3]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:507) ~[surefire-booter-3.5.3.jar:3.5.3]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:495) ~[surefire-booter-3.5.3.jar:3.5.3]
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'roleInitializationService': Invocation of init method failed
	at org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor.postProcessBeforeInitialization(InitDestroyAnnotationBeanPostProcessor.java:222) ~[spring-beans-6.2.6.jar:6.2.6]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyBeanPostProcessorsBeforeInitialization(AbstractAutowireCapableBeanFactory.java:429) ~[spring-beans-6.2.6.jar:6.2.6]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1810) ~[spring-beans-6.2.6.jar:6.2.6]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:607) ~[spring-beans-6.2.6.jar:6.2.6]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:529) ~[spring-beans-6.2.6.jar:6.2.6]
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:339) ~[spring-beans-6.2.6.jar:6.2.6]
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:371) ~[spring-beans-6.2.6.jar:6.2.6]
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:337) ~[spring-beans-6.2.6.jar:6.2.6]
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:202) ~[spring-beans-6.2.6.jar:6.2.6]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.instantiateSingleton(DefaultListableBeanFactory.java:1221) ~[spring-beans-6.2.6.jar:6.2.6]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingleton(DefaultListableBeanFactory.java:1187) ~[spring-beans-6.2.6.jar:6.2.6]
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:1122) ~[spring-beans-6.2.6.jar:6.2.6]
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:987) ~[spring-context-6.2.6.jar:6.2.6]
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:627) ~[spring-context-6.2.6.jar:6.2.6]
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146) ~[spring-boot-3.4.5.jar:3.4.5]
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:753) ~[spring-boot-3.4.5.jar:3.4.5]
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:439) ~[spring-boot-3.4.5.jar:3.4.5]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:318) ~[spring-boot-3.4.5.jar:3.4.5]
	at org.springframework.boot.test.context.SpringBootContextLoader.lambda$loadContext$3(SpringBootContextLoader.java:144) ~[spring-boot-test-3.4.5.jar:3.4.5]
	at org.springframework.util.function.ThrowingSupplier.get(ThrowingSupplier.java:58) ~[spring-core-6.2.6.jar:6.2.6]
	at org.springframework.util.function.ThrowingSupplier.get(ThrowingSupplier.java:46) ~[spring-core-6.2.6.jar:6.2.6]
	at org.springframework.boot.SpringApplication.withHook(SpringApplication.java:1462) ~[spring-boot-3.4.5.jar:3.4.5]
	at org.springframework.boot.test.context.SpringBootContextLoader$ContextLoaderHook.run(SpringBootContextLoader.java:563) ~[spring-boot-test-3.4.5.jar:3.4.5]
	at org.springframework.boot.test.context.SpringBootContextLoader.loadContext(SpringBootContextLoader.java:144) ~[spring-boot-test-3.4.5.jar:3.4.5]
	at org.springframework.boot.test.context.SpringBootContextLoader.loadContext(SpringBootContextLoader.java:110) ~[spring-boot-test-3.4.5.jar:3.4.5]
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContextInternal(DefaultCacheAwareContextLoaderDelegate.java:225) ~[spring-test-6.2.6.jar:6.2.6]
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:152) ~[spring-test-6.2.6.jar:6.2.6]
	... 75 common frames omitted
Caused by: org.springframework.dao.InvalidDataAccessApiUsageException: detached entity passed to persist: com.example.iam.entity.Permission
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:314) ~[spring-orm-6.2.6.jar:6.2.6]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256) ~[spring-orm-6.2.6.jar:6.2.6]
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244) ~[spring-orm-6.2.6.jar:6.2.6]
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560) ~[spring-orm-6.2.6.jar:6.2.6]
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61) ~[spring-tx-6.2.6.jar:6.2.6]
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343) ~[spring-tx-6.2.6.jar:6.2.6]
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160) ~[spring-tx-6.2.6.jar:6.2.6]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:165) ~[spring-data-jpa-3.4.5.jar:3.4.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
	at jdk.proxy2/jdk.proxy2.$Proxy195.save(Unknown Source) ~[na:na]
	at com.example.iam.service.RoleInitializationService.lambda$createRoleIfNotExists$1(RoleInitializationService.java:68) ~[classes/:na]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.example.iam.service.RoleInitializationService.createRoleIfNotExists(RoleInitializationService.java:62) ~[classes/:na]
	at com.example.iam.service.RoleInitializationService.initializeRoles(RoleInitializationService.java:43) ~[classes/:na]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor$LifecycleMethod.invoke(InitDestroyAnnotationBeanPostProcessor.java:457) ~[spring-beans-6.2.6.jar:6.2.6]
	at org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor$LifecycleMetadata.invokeInitMethods(InitDestroyAnnotationBeanPostProcessor.java:401) ~[spring-beans-6.2.6.jar:6.2.6]
	at org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor.postProcessBeforeInitialization(InitDestroyAnnotationBeanPostProcessor.java:219) ~[spring-beans-6.2.6.jar:6.2.6]
	... 101 common frames omitted
Caused by: org.hibernate.PersistentObjectException: detached entity passed to persist: com.example.iam.entity.Permission
	at org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:90) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:79) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:138) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:803) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:751) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.engine.spi.CascadingActions$7.cascade(CascadingActions.java:295) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.engine.spi.CascadingActions$7.cascade(CascadingActions.java:285) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.engine.internal.Cascade.cascadeToOne(Cascade.java:570) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.engine.internal.Cascade.cascadeAssociation(Cascade.java:492) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.engine.internal.Cascade.cascadeProperty(Cascade.java:253) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.engine.internal.Cascade.cascadeCollectionElements(Cascade.java:604) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.engine.internal.Cascade.cascadeCollection(Cascade.java:534) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.engine.internal.Cascade.cascadeAssociation(Cascade.java:495) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.engine.internal.Cascade.cascadeProperty(Cascade.java:253) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.engine.internal.Cascade.cascade(Cascade.java:192) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.event.internal.AbstractSaveEventListener.cascadeAfterSave(AbstractSaveEventListener.java:520) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:319) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:223) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:136) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:177) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.event.internal.DefaultPersistEventListener.persist(DefaultPersistEventListener.java:95) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:79) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:55) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:127) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:761) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:745) ~[hibernate-core-6.6.13.Final.jar:6.6.13.Final]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:320) ~[spring-orm-6.2.6.jar:6.2.6]
	at jdk.proxy2/jdk.proxy2.$Proxy179.persist(Unknown Source) ~[na:na]
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:636) ~[spring-data-jpa-3.4.5.jar:3.4.5]
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker$RepositoryFragmentMethodInvoker.lambda$new$0(RepositoryMethodInvoker.java:277) ~[spring-data-commons-3.4.5.jar:3.4.5]
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:515) ~[spring-data-commons-3.4.5.jar:3.4.5]
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:284) ~[spring-data-commons-3.4.5.jar:3.4.5]
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:731) ~[spring-data-commons-3.4.5.jar:3.4.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:174) ~[spring-data-commons-3.4.5.jar:3.4.5]
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380) ~[spring-tx-6.2.6.jar:6.2.6]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119) ~[spring-tx-6.2.6.jar:6.2.6]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
	... 115 common frames omitted
2025-05-25 13:12:23.012 WARN  o.s.test.context.TestContextManager - Caught exception while allowing TestExecutionListener [org.springframework.test.context.support.DependencyInjectionTestExecutionListener] to prepare test instance [com.example.iam.integration.AuthAndRoleTest@589b0021]
java.lang.IllegalStateException: ApplicationContext failure threshold (1) exceeded: skipping repeated attempt to load context for [WebMergedContextConfiguration@146eda1b testClass = com.example.iam.integration.AuthAndRoleTest, locations = [], classes = [com.example.iam.IamServiceApplication], contextInitializerClasses = [], activeProfiles = ["test-real"], propertySourceDescriptors = [], propertySourceProperties = ["org.springframework.boot.test.context.SpringBootTestContextBootstrapper=true", "server.port=0"], contextCustomizers = [org.springframework.boot.test.context.filter.ExcludeFilterContextCustomizer@6f1a80fb, org.springframework.boot.test.json.DuplicateJsonObjectContextCustomizerFactory$DuplicateJsonObjectContextCustomizer@4f6b687e, org.springframework.boot.test.mock.mockito.MockitoContextCustomizer@0, org.springframework.boot.test.web.client.TestRestTemplateContextCustomizer@1e86a5a7, org.springframework.boot.test.web.reactor.netty.DisableReactorResourceFactoryGlobalResourcesContextCustomizerFactory$DisableReactorResourceFactoryGlobalResourcesContextCustomizerCustomizer@2e179f3e, org.springframework.boot.test.autoconfigure.OnFailureConditionReportContextCustomizerFactory$OnFailureConditionReportContextCustomizer@3bddc676, org.springframework.boot.test.autoconfigure.actuate.observability.ObservabilityContextCustomizerFactory$DisableObservabilityContextCustomizer@1f, org.springframework.boot.test.autoconfigure.properties.PropertyMappingContextCustomizer@0, org.springframework.boot.test.autoconfigure.web.servlet.WebDriverContextCustomizer@68d651f2, org.springframework.test.context.support.DynamicPropertiesContextCustomizer@0, org.springframework.boot.test.context.SpringBootTestAnnotation@8b57d2d4], resourceBasePath = "src/main/webapp", contextLoader = org.springframework.boot.test.context.SpringBootContextLoader, parent = null]
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:145) ~[spring-test-6.2.6.jar:6.2.6]
	at org.springframework.test.context.support.DefaultTestContext.getApplicationContext(DefaultTestContext.java:130) ~[spring-test-6.2.6.jar:6.2.6]
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.injectDependencies(DependencyInjectionTestExecutionListener.java:155) ~[spring-test-6.2.6.jar:6.2.6]
	at org.springframework.test.context.support.DependencyInjectionTestExecutionListener.prepareTestInstance(DependencyInjectionTestExecutionListener.java:111) ~[spring-test-6.2.6.jar:6.2.6]
	at org.springframework.test.context.TestContextManager.prepareTestInstance(TestContextManager.java:260) ~[spring-test-6.2.6.jar:6.2.6]
	at org.springframework.test.context.junit.jupiter.SpringExtension.postProcessTestInstance(SpringExtension.java:159) ~[spring-test-6.2.6.jar:6.2.6]
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$invokeTestInstancePostProcessors$11(ClassBasedTestDescriptor.java:378) ~[junit-jupiter-engine-5.11.4.jar:5.11.4]
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.executeAndMaskThrowable(ClassBasedTestDescriptor.java:383) ~[junit-jupiter-engine-5.11.4.jar:5.11.4]
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$invokeTestInstancePostProcessors$12(ClassBasedTestDescriptor.java:378) ~[junit-jupiter-engine-5.11.4.jar:5.11.4]
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:184) ~[na:na]
	at java.base/java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:197) ~[na:na]
	at java.base/java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:179) ~[na:na]
	at java.base/java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:197) ~[na:na]
	at java.base/java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1708) ~[na:na]
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:509) ~[na:na]
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:499) ~[na:na]
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151) ~[na:na]
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174) ~[na:na]
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[na:na]
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:596) ~[na:na]
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.invokeTestInstancePostProcessors(ClassBasedTestDescriptor.java:377) ~[junit-jupiter-engine-5.11.4.jar:5.11.4]
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$instantiateAndPostProcessTestInstance$7(ClassBasedTestDescriptor.java:290) ~[junit-jupiter-engine-5.11.4.jar:5.11.4]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.instantiateAndPostProcessTestInstance(ClassBasedTestDescriptor.java:289) ~[junit-jupiter-engine-5.11.4.jar:5.11.4]
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$testInstancesProvider$5(ClassBasedTestDescriptor.java:279) ~[junit-jupiter-engine-5.11.4.jar:5.11.4]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at org.junit.jupiter.engine.descriptor.ClassBasedTestDescriptor.lambda$testInstancesProvider$6(ClassBasedTestDescriptor.java:278) ~[junit-jupiter-engine-5.11.4.jar:5.11.4]
	at org.junit.jupiter.engine.execution.TestInstancesProvider.getTestInstances(TestInstancesProvider.java:31) ~[junit-jupiter-engine-5.11.4.jar:5.11.4]
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$prepare$1(TestMethodTestDescriptor.java:105) ~[junit-jupiter-engine-5.11.4.jar:5.11.4]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.prepare(TestMethodTestDescriptor.java:104) ~[junit-jupiter-engine-5.11.4.jar:5.11.4]
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.prepare(TestMethodTestDescriptor.java:68) ~[junit-jupiter-engine-5.11.4.jar:5.11.4]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$prepare$2(NodeTestTask.java:128) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.prepare(NodeTestTask.java:128) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1596) ~[na:na]
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1596) ~[na:na]
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54) ~[junit-platform-engine-1.11.4.jar:1.11.4]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:198) ~[junit-platform-launcher-1.11.4.jar:1.11.4]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:169) ~[junit-platform-launcher-1.11.4.jar:1.11.4]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:93) ~[junit-platform-launcher-1.11.4.jar:1.11.4]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:58) ~[junit-platform-launcher-1.11.4.jar:1.11.4]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:141) ~[junit-platform-launcher-1.11.4.jar:1.11.4]
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:57) ~[junit-platform-launcher-1.11.4.jar:1.11.4]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:103) ~[junit-platform-launcher-1.11.4.jar:1.11.4]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:85) ~[junit-platform-launcher-1.11.4.jar:1.11.4]
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:47) ~[junit-platform-launcher-1.11.4.jar:1.11.4]
	at org.apache.maven.surefire.junitplatform.LazyLauncher.execute(LazyLauncher.java:56) ~[surefire-junit-platform-3.5.3.jar:3.5.3]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:194) ~[surefire-junit-platform-3.5.3.jar:3.5.3]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:150) ~[surefire-junit-platform-3.5.3.jar:3.5.3]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124) ~[surefire-junit-platform-3.5.3.jar:3.5.3]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:385) ~[surefire-booter-3.5.3.jar:3.5.3]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162) ~[surefire-booter-3.5.3.jar:3.5.3]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:507) ~[surefire-booter-3.5.3.jar:3.5.3]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:495) ~[surefire-booter-3.5.3.jar:3.5.3]
2025-05-25 13:27:24.648 INFO  c.e.iam.integration.AuthAndRoleTest - Starting AuthAndRoleTest using Java 21.0.7 with PID 65095 (started by descent in /home/descent/Documents/VDT/vdt5-iam-system/iam-service)
2025-05-25 13:27:24.649 DEBUG c.e.iam.integration.AuthAndRoleTest - Running with Spring Boot v3.4.5, Spring v6.2.6
2025-05-25 13:27:24.650 INFO  c.e.iam.integration.AuthAndRoleTest - The following 1 profile is active: "test-real"
2025-05-25 13:27:25.609 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-05-25 13:27:25.707 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 89 ms. Found 9 JPA repository interfaces.
2025-05-25 13:27:26.575 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 0 (http)
2025-05-25 13:27:26.589 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-25 13:27:26.589 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.40]
2025-05-25 13:27:26.635 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-25 13:27:26.635 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1966 ms
2025-05-25 13:27:27.198 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-25 13:27:27.607 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@96dfcbb
2025-05-25 13:27:27.610 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-25 13:27:30.521 DEBUG c.e.i.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-05-25 13:27:30.595 INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name customUserDetailsService
2025-05-25 13:27:31.056 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-05-25 13:27:32.501 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 39101 (http) with context path '/'
2025-05-25 13:27:32.521 INFO  c.e.iam.integration.AuthAndRoleTest - Started AuthAndRoleTest in 8.45 seconds (process running for 9.529)
2025-05-25 13:27:33.343 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-05-25 13:27:33.344 INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-05-25 13:27:33.346 INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-05-25 13:27:33.773 ERROR c.e.i.e.GlobalExceptionHandler - Access denied: User does not have required permission: USER_READ
2025-05-25 13:27:33.937 ERROR c.e.i.s.JwtAuthenticationFilter - Token validation error
org.springframework.dao.IncorrectResultSizeDataAccessException: Query did not return a unique result: 2 results were returned
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:305)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy162.findByToken(Unknown Source)
	at com.example.iam.service.TokenService.isTokenValid(TokenService.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.iam.service.TokenService$$SpringCGLIB$$0.isTokenValid(<generated>)
	at com.example.iam.security.JwtTokenProvider.validateToken(JwtTokenProvider.java:142)
	at com.example.iam.security.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:33)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:243)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:238)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.NonUniqueResultException: Query did not return a unique result: 2 results were returned
	at org.hibernate.query.spi.AbstractSelectionQuery.uniqueElement(AbstractSelectionQuery.java:298)
	at org.hibernate.query.spi.AbstractSelectionQuery.getSingleResult(AbstractSelectionQuery.java:281)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:419)
	at jdk.proxy2/jdk.proxy2.$Proxy190.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:224)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:93)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:152)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:140)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 70 common frames omitted
2025-05-25 13:27:33.959 ERROR c.e.i.s.JwtAuthenticationFilter - Token validation error
org.springframework.dao.IncorrectResultSizeDataAccessException: Query did not return a unique result: 2 results were returned
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:305)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy162.findByToken(Unknown Source)
	at com.example.iam.service.TokenService.isTokenValid(TokenService.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.iam.service.TokenService$$SpringCGLIB$$0.isTokenValid(<generated>)
	at com.example.iam.security.JwtTokenProvider.validateToken(JwtTokenProvider.java:142)
	at com.example.iam.security.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:33)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:243)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:238)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.NonUniqueResultException: Query did not return a unique result: 2 results were returned
	at org.hibernate.query.spi.AbstractSelectionQuery.uniqueElement(AbstractSelectionQuery.java:298)
	at org.hibernate.query.spi.AbstractSelectionQuery.getSingleResult(AbstractSelectionQuery.java:281)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:419)
	at jdk.proxy2/jdk.proxy2.$Proxy190.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:224)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:93)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:152)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:140)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 70 common frames omitted
2025-05-25 13:27:34.030 INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-05-25 13:27:34.035 INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-05-25 13:27:34.045 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-25 13:27:34.055 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-25 13:28:46.917 INFO  c.e.iam.integration.AuthAndRoleTest - Starting AuthAndRoleTest using Java 21.0.7 with PID 66245 (started by descent in /home/descent/Documents/VDT/vdt5-iam-system/iam-service)
2025-05-25 13:28:46.919 DEBUG c.e.iam.integration.AuthAndRoleTest - Running with Spring Boot v3.4.5, Spring v6.2.6
2025-05-25 13:28:46.920 INFO  c.e.iam.integration.AuthAndRoleTest - The following 1 profile is active: "test-real"
2025-05-25 13:28:47.870 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-05-25 13:28:47.970 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 87 ms. Found 9 JPA repository interfaces.
2025-05-25 13:28:48.786 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 0 (http)
2025-05-25 13:28:48.799 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-25 13:28:48.800 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.40]
2025-05-25 13:28:48.856 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-25 13:28:48.856 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1917 ms
2025-05-25 13:28:49.417 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-25 13:28:49.775 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@17034458
2025-05-25 13:28:49.776 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-25 13:28:52.144 DEBUG c.e.i.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-05-25 13:28:52.195 INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name customUserDetailsService
2025-05-25 13:28:52.578 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-05-25 13:28:53.707 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 46337 (http) with context path '/'
2025-05-25 13:28:53.718 INFO  c.e.iam.integration.AuthAndRoleTest - Started AuthAndRoleTest in 7.392 seconds (process running for 8.428)
2025-05-25 13:28:54.374 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-05-25 13:28:54.375 INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-05-25 13:28:54.377 INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-05-25 13:28:54.994 ERROR c.e.i.e.GlobalExceptionHandler - Access denied: User does not have required permission: USER_READ
2025-05-25 13:28:55.460 INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-05-25 13:28:55.463 INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-05-25 13:28:55.470 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-25 13:28:55.482 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-25 13:29:38.218 INFO  c.e.iam.integration.AuthAndRoleTest - Starting AuthAndRoleTest using Java 21.0.7 with PID 67016 (started by descent in /home/descent/Documents/VDT/vdt5-iam-system/iam-service)
2025-05-25 13:29:38.219 DEBUG c.e.iam.integration.AuthAndRoleTest - Running with Spring Boot v3.4.5, Spring v6.2.6
2025-05-25 13:29:38.220 INFO  c.e.iam.integration.AuthAndRoleTest - The following 1 profile is active: "test-real"
2025-05-25 13:29:39.369 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-05-25 13:29:39.481 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 99 ms. Found 9 JPA repository interfaces.
2025-05-25 13:29:40.410 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 0 (http)
2025-05-25 13:29:40.428 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-25 13:29:40.428 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.40]
2025-05-25 13:29:40.499 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-25 13:29:40.500 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2264 ms
2025-05-25 13:29:41.084 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-25 13:29:41.515 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@2699b656
2025-05-25 13:29:41.516 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-25 13:29:44.223 DEBUG c.e.i.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-05-25 13:29:44.279 INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name customUserDetailsService
2025-05-25 13:29:44.677 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-05-25 13:29:45.952 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 42391 (http) with context path '/'
2025-05-25 13:29:45.965 INFO  c.e.iam.integration.AuthAndRoleTest - Started AuthAndRoleTest in 8.302 seconds (process running for 9.52)
2025-05-25 13:29:46.691 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-05-25 13:29:46.691 INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-05-25 13:29:46.693 INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-05-25 13:29:48.084 ERROR c.e.i.s.JwtAuthenticationFilter - Token validation error
org.springframework.dao.IncorrectResultSizeDataAccessException: Query did not return a unique result: 3 results were returned
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:305)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy162.findByToken(Unknown Source)
	at com.example.iam.service.TokenService.isTokenValid(TokenService.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.iam.service.TokenService$$SpringCGLIB$$0.isTokenValid(<generated>)
	at com.example.iam.security.JwtTokenProvider.validateToken(JwtTokenProvider.java:142)
	at com.example.iam.security.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:33)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:243)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:238)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.NonUniqueResultException: Query did not return a unique result: 3 results were returned
	at org.hibernate.query.spi.AbstractSelectionQuery.uniqueElement(AbstractSelectionQuery.java:298)
	at org.hibernate.query.spi.AbstractSelectionQuery.getSingleResult(AbstractSelectionQuery.java:281)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:419)
	at jdk.proxy2/jdk.proxy2.$Proxy190.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:224)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:93)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:152)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:140)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 70 common frames omitted
2025-05-25 13:29:48.454 ERROR c.e.i.s.JwtAuthenticationFilter - Token validation error
org.springframework.dao.IncorrectResultSizeDataAccessException: Query did not return a unique result: 2 results were returned
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:305)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy162.findByToken(Unknown Source)
	at com.example.iam.service.TokenService.isTokenValid(TokenService.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.iam.service.TokenService$$SpringCGLIB$$0.isTokenValid(<generated>)
	at com.example.iam.security.JwtTokenProvider.validateToken(JwtTokenProvider.java:142)
	at com.example.iam.security.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:33)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:243)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:238)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.NonUniqueResultException: Query did not return a unique result: 2 results were returned
	at org.hibernate.query.spi.AbstractSelectionQuery.uniqueElement(AbstractSelectionQuery.java:298)
	at org.hibernate.query.spi.AbstractSelectionQuery.getSingleResult(AbstractSelectionQuery.java:281)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:419)
	at jdk.proxy2/jdk.proxy2.$Proxy190.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:224)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:93)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:152)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:140)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 70 common frames omitted
2025-05-25 13:29:48.786 ERROR c.e.i.s.JwtAuthenticationFilter - Token validation error
org.springframework.dao.IncorrectResultSizeDataAccessException: Query did not return a unique result: 2 results were returned
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:305)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy162.findByToken(Unknown Source)
	at com.example.iam.service.TokenService.isTokenValid(TokenService.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.iam.service.TokenService$$SpringCGLIB$$0.isTokenValid(<generated>)
	at com.example.iam.security.JwtTokenProvider.validateToken(JwtTokenProvider.java:142)
	at com.example.iam.security.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:33)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:243)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:238)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.NonUniqueResultException: Query did not return a unique result: 2 results were returned
	at org.hibernate.query.spi.AbstractSelectionQuery.uniqueElement(AbstractSelectionQuery.java:298)
	at org.hibernate.query.spi.AbstractSelectionQuery.getSingleResult(AbstractSelectionQuery.java:281)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:419)
	at jdk.proxy2/jdk.proxy2.$Proxy190.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:224)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:93)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:152)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:140)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 70 common frames omitted
2025-05-25 13:29:49.496 ERROR c.e.i.s.JwtAuthenticationFilter - Token validation error
org.springframework.dao.IncorrectResultSizeDataAccessException: Query did not return a unique result: 2 results were returned
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:305)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy162.findByToken(Unknown Source)
	at com.example.iam.service.TokenService.isTokenValid(TokenService.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.iam.service.TokenService$$SpringCGLIB$$0.isTokenValid(<generated>)
	at com.example.iam.security.JwtTokenProvider.validateToken(JwtTokenProvider.java:142)
	at com.example.iam.security.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:33)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:243)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:238)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.NonUniqueResultException: Query did not return a unique result: 2 results were returned
	at org.hibernate.query.spi.AbstractSelectionQuery.uniqueElement(AbstractSelectionQuery.java:298)
	at org.hibernate.query.spi.AbstractSelectionQuery.getSingleResult(AbstractSelectionQuery.java:281)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:419)
	at jdk.proxy2/jdk.proxy2.$Proxy190.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:224)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:93)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:152)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:140)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 70 common frames omitted
2025-05-25 13:29:49.877 ERROR c.e.i.s.JwtAuthenticationFilter - Token validation error
org.springframework.dao.IncorrectResultSizeDataAccessException: Query did not return a unique result: 3 results were returned
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:305)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy162.findByToken(Unknown Source)
	at com.example.iam.service.TokenService.isTokenValid(TokenService.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.iam.service.TokenService$$SpringCGLIB$$0.isTokenValid(<generated>)
	at com.example.iam.security.JwtTokenProvider.validateToken(JwtTokenProvider.java:142)
	at com.example.iam.security.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:33)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:243)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:238)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.NonUniqueResultException: Query did not return a unique result: 3 results were returned
	at org.hibernate.query.spi.AbstractSelectionQuery.uniqueElement(AbstractSelectionQuery.java:298)
	at org.hibernate.query.spi.AbstractSelectionQuery.getSingleResult(AbstractSelectionQuery.java:281)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:419)
	at jdk.proxy2/jdk.proxy2.$Proxy190.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:224)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:93)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:152)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:140)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 70 common frames omitted
2025-05-25 13:29:50.279 ERROR c.e.i.e.GlobalExceptionHandler - Access denied: User does not have required permission: ORGANIZATION_READ
2025-05-25 13:29:50.642 ERROR c.e.i.s.JwtAuthenticationFilter - Token validation error
org.springframework.dao.IncorrectResultSizeDataAccessException: Query did not return a unique result: 2 results were returned
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:305)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy162.findByToken(Unknown Source)
	at com.example.iam.service.TokenService.isTokenValid(TokenService.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.iam.service.TokenService$$SpringCGLIB$$0.isTokenValid(<generated>)
	at com.example.iam.security.JwtTokenProvider.validateToken(JwtTokenProvider.java:142)
	at com.example.iam.security.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:33)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:243)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:238)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.NonUniqueResultException: Query did not return a unique result: 2 results were returned
	at org.hibernate.query.spi.AbstractSelectionQuery.uniqueElement(AbstractSelectionQuery.java:298)
	at org.hibernate.query.spi.AbstractSelectionQuery.getSingleResult(AbstractSelectionQuery.java:281)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:419)
	at jdk.proxy2/jdk.proxy2.$Proxy190.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:224)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:93)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:152)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:140)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 70 common frames omitted
2025-05-25 13:29:50.979 ERROR c.e.i.s.JwtAuthenticationFilter - Token validation error
org.springframework.dao.IncorrectResultSizeDataAccessException: Query did not return a unique result: 3 results were returned
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:305)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy162.findByToken(Unknown Source)
	at com.example.iam.service.TokenService.isTokenValid(TokenService.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.iam.service.TokenService$$SpringCGLIB$$0.isTokenValid(<generated>)
	at com.example.iam.security.JwtTokenProvider.validateToken(JwtTokenProvider.java:142)
	at com.example.iam.security.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:33)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:243)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:238)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.NonUniqueResultException: Query did not return a unique result: 3 results were returned
	at org.hibernate.query.spi.AbstractSelectionQuery.uniqueElement(AbstractSelectionQuery.java:298)
	at org.hibernate.query.spi.AbstractSelectionQuery.getSingleResult(AbstractSelectionQuery.java:281)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:419)
	at jdk.proxy2/jdk.proxy2.$Proxy190.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:224)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:93)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:152)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:140)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 70 common frames omitted
2025-05-25 13:29:51.675 ERROR c.e.i.s.JwtAuthenticationFilter - Token validation error
org.springframework.dao.IncorrectResultSizeDataAccessException: Query did not return a unique result: 2 results were returned
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:305)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy162.findByToken(Unknown Source)
	at com.example.iam.service.TokenService.isTokenValid(TokenService.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.iam.service.TokenService$$SpringCGLIB$$0.isTokenValid(<generated>)
	at com.example.iam.security.JwtTokenProvider.validateToken(JwtTokenProvider.java:142)
	at com.example.iam.security.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:33)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:243)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:238)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.NonUniqueResultException: Query did not return a unique result: 2 results were returned
	at org.hibernate.query.spi.AbstractSelectionQuery.uniqueElement(AbstractSelectionQuery.java:298)
	at org.hibernate.query.spi.AbstractSelectionQuery.getSingleResult(AbstractSelectionQuery.java:281)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:419)
	at jdk.proxy2/jdk.proxy2.$Proxy190.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:224)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:93)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:152)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:140)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 70 common frames omitted
2025-05-25 13:29:51.993 ERROR c.e.i.s.JwtAuthenticationFilter - Token validation error
org.springframework.dao.IncorrectResultSizeDataAccessException: Query did not return a unique result: 3 results were returned
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:305)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy162.findByToken(Unknown Source)
	at com.example.iam.service.TokenService.isTokenValid(TokenService.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.iam.service.TokenService$$SpringCGLIB$$0.isTokenValid(<generated>)
	at com.example.iam.security.JwtTokenProvider.validateToken(JwtTokenProvider.java:142)
	at com.example.iam.security.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:33)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:243)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:238)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.NonUniqueResultException: Query did not return a unique result: 3 results were returned
	at org.hibernate.query.spi.AbstractSelectionQuery.uniqueElement(AbstractSelectionQuery.java:298)
	at org.hibernate.query.spi.AbstractSelectionQuery.getSingleResult(AbstractSelectionQuery.java:281)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:419)
	at jdk.proxy2/jdk.proxy2.$Proxy190.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:224)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:93)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:152)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:140)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 70 common frames omitted
2025-05-25 13:29:52.469 INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-05-25 13:29:52.472 INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-05-25 13:29:52.483 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-25 13:29:52.493 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-25 13:32:35.045 INFO  c.e.iam.integration.AuthAndRoleTest - Starting AuthAndRoleTest using Java 21.0.7 with PID 69218 (started by descent in /home/descent/Documents/VDT/vdt5-iam-system/iam-service)
2025-05-25 13:32:35.046 DEBUG c.e.iam.integration.AuthAndRoleTest - Running with Spring Boot v3.4.5, Spring v6.2.6
2025-05-25 13:32:35.047 INFO  c.e.iam.integration.AuthAndRoleTest - The following 1 profile is active: "test-real"
2025-05-25 13:32:35.953 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-05-25 13:32:36.062 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 86 ms. Found 9 JPA repository interfaces.
2025-05-25 13:32:36.913 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 0 (http)
2025-05-25 13:32:36.927 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-25 13:32:36.927 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.40]
2025-05-25 13:32:36.988 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-25 13:32:36.988 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1915 ms
2025-05-25 13:32:37.535 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-25 13:32:37.936 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@2699b656
2025-05-25 13:32:37.937 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-25 13:32:40.226 DEBUG c.e.i.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-05-25 13:32:40.272 INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name customUserDetailsService
2025-05-25 13:32:40.597 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-05-25 13:32:41.747 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 42625 (http) with context path '/'
2025-05-25 13:32:41.765 INFO  c.e.iam.integration.AuthAndRoleTest - Started AuthAndRoleTest in 7.32 seconds (process running for 8.393)
2025-05-25 13:32:42.369 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-05-25 13:32:42.370 INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-05-25 13:32:42.371 INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-05-25 13:32:43.780 ERROR c.e.i.s.JwtAuthenticationFilter - Token validation error
org.springframework.dao.IncorrectResultSizeDataAccessException: Query did not return a unique result: 2 results were returned
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:305)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy162.findByToken(Unknown Source)
	at com.example.iam.service.TokenService.isTokenValid(TokenService.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.iam.service.TokenService$$SpringCGLIB$$0.isTokenValid(<generated>)
	at com.example.iam.security.JwtTokenProvider.validateToken(JwtTokenProvider.java:142)
	at com.example.iam.security.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:33)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:243)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:238)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.NonUniqueResultException: Query did not return a unique result: 2 results were returned
	at org.hibernate.query.spi.AbstractSelectionQuery.uniqueElement(AbstractSelectionQuery.java:298)
	at org.hibernate.query.spi.AbstractSelectionQuery.getSingleResult(AbstractSelectionQuery.java:281)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:419)
	at jdk.proxy2/jdk.proxy2.$Proxy190.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:224)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:93)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:152)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:140)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 70 common frames omitted
2025-05-25 13:32:44.480 ERROR c.e.i.s.JwtAuthenticationFilter - Token validation error
org.springframework.dao.IncorrectResultSizeDataAccessException: Query did not return a unique result: 2 results were returned
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:305)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy162.findByToken(Unknown Source)
	at com.example.iam.service.TokenService.isTokenValid(TokenService.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.iam.service.TokenService$$SpringCGLIB$$0.isTokenValid(<generated>)
	at com.example.iam.security.JwtTokenProvider.validateToken(JwtTokenProvider.java:142)
	at com.example.iam.security.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:33)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:243)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:238)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.NonUniqueResultException: Query did not return a unique result: 2 results were returned
	at org.hibernate.query.spi.AbstractSelectionQuery.uniqueElement(AbstractSelectionQuery.java:298)
	at org.hibernate.query.spi.AbstractSelectionQuery.getSingleResult(AbstractSelectionQuery.java:281)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:419)
	at jdk.proxy2/jdk.proxy2.$Proxy190.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:224)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:93)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:152)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:140)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 70 common frames omitted
2025-05-25 13:32:44.801 ERROR c.e.i.s.JwtAuthenticationFilter - Token validation error
org.springframework.dao.IncorrectResultSizeDataAccessException: Query did not return a unique result: 3 results were returned
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:305)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy162.findByToken(Unknown Source)
	at com.example.iam.service.TokenService.isTokenValid(TokenService.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.iam.service.TokenService$$SpringCGLIB$$0.isTokenValid(<generated>)
	at com.example.iam.security.JwtTokenProvider.validateToken(JwtTokenProvider.java:142)
	at com.example.iam.security.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:33)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:243)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:238)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.NonUniqueResultException: Query did not return a unique result: 3 results were returned
	at org.hibernate.query.spi.AbstractSelectionQuery.uniqueElement(AbstractSelectionQuery.java:298)
	at org.hibernate.query.spi.AbstractSelectionQuery.getSingleResult(AbstractSelectionQuery.java:281)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:419)
	at jdk.proxy2/jdk.proxy2.$Proxy190.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:224)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:93)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:152)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:140)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 70 common frames omitted
2025-05-25 13:32:45.158 ERROR c.e.i.e.GlobalExceptionHandler - Access denied: User does not have required permission: ROLE_READ
2025-05-25 13:32:45.485 ERROR c.e.i.s.JwtAuthenticationFilter - Token validation error
org.springframework.dao.IncorrectResultSizeDataAccessException: Query did not return a unique result: 2 results were returned
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:305)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy162.findByToken(Unknown Source)
	at com.example.iam.service.TokenService.isTokenValid(TokenService.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.iam.service.TokenService$$SpringCGLIB$$0.isTokenValid(<generated>)
	at com.example.iam.security.JwtTokenProvider.validateToken(JwtTokenProvider.java:142)
	at com.example.iam.security.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:33)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:243)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:238)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.NonUniqueResultException: Query did not return a unique result: 2 results were returned
	at org.hibernate.query.spi.AbstractSelectionQuery.uniqueElement(AbstractSelectionQuery.java:298)
	at org.hibernate.query.spi.AbstractSelectionQuery.getSingleResult(AbstractSelectionQuery.java:281)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:419)
	at jdk.proxy2/jdk.proxy2.$Proxy190.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:224)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:93)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:152)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:140)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 70 common frames omitted
2025-05-25 13:32:45.850 ERROR c.e.i.s.JwtAuthenticationFilter - Token validation error
org.springframework.dao.IncorrectResultSizeDataAccessException: Query did not return a unique result: 3 results were returned
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:305)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy162.findByToken(Unknown Source)
	at com.example.iam.service.TokenService.isTokenValid(TokenService.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.iam.service.TokenService$$SpringCGLIB$$0.isTokenValid(<generated>)
	at com.example.iam.security.JwtTokenProvider.validateToken(JwtTokenProvider.java:142)
	at com.example.iam.security.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:33)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:243)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:238)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.NonUniqueResultException: Query did not return a unique result: 3 results were returned
	at org.hibernate.query.spi.AbstractSelectionQuery.uniqueElement(AbstractSelectionQuery.java:298)
	at org.hibernate.query.spi.AbstractSelectionQuery.getSingleResult(AbstractSelectionQuery.java:281)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:419)
	at jdk.proxy2/jdk.proxy2.$Proxy190.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:224)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:93)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:152)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:140)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 70 common frames omitted
2025-05-25 13:32:46.894 ERROR c.e.i.s.JwtAuthenticationFilter - Token validation error
org.springframework.dao.IncorrectResultSizeDataAccessException: Query did not return a unique result: 2 results were returned
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:305)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy162.findByToken(Unknown Source)
	at com.example.iam.service.TokenService.isTokenValid(TokenService.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.iam.service.TokenService$$SpringCGLIB$$0.isTokenValid(<generated>)
	at com.example.iam.security.JwtTokenProvider.validateToken(JwtTokenProvider.java:142)
	at com.example.iam.security.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:33)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:243)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:238)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.NonUniqueResultException: Query did not return a unique result: 2 results were returned
	at org.hibernate.query.spi.AbstractSelectionQuery.uniqueElement(AbstractSelectionQuery.java:298)
	at org.hibernate.query.spi.AbstractSelectionQuery.getSingleResult(AbstractSelectionQuery.java:281)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:419)
	at jdk.proxy2/jdk.proxy2.$Proxy190.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:224)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:93)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:152)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:140)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 70 common frames omitted
2025-05-25 13:32:46.900 ERROR c.e.i.s.JwtAuthenticationFilter - Token validation error
org.springframework.dao.IncorrectResultSizeDataAccessException: Query did not return a unique result: 2 results were returned
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:305)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy162.findByToken(Unknown Source)
	at com.example.iam.service.TokenService.isTokenValid(TokenService.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.iam.service.TokenService$$SpringCGLIB$$0.isTokenValid(<generated>)
	at com.example.iam.security.JwtTokenProvider.validateToken(JwtTokenProvider.java:142)
	at com.example.iam.security.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:33)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:243)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:238)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.NonUniqueResultException: Query did not return a unique result: 2 results were returned
	at org.hibernate.query.spi.AbstractSelectionQuery.uniqueElement(AbstractSelectionQuery.java:298)
	at org.hibernate.query.spi.AbstractSelectionQuery.getSingleResult(AbstractSelectionQuery.java:281)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:419)
	at jdk.proxy2/jdk.proxy2.$Proxy190.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:224)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:93)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:152)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:140)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 70 common frames omitted
2025-05-25 13:32:47.239 ERROR c.e.i.e.GlobalExceptionHandler - Access denied: User does not have required permission: POLICY_READ
2025-05-25 13:32:47.565 ERROR c.e.i.s.JwtAuthenticationFilter - Token validation error
org.springframework.dao.IncorrectResultSizeDataAccessException: Query did not return a unique result: 2 results were returned
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:305)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy162.findByToken(Unknown Source)
	at com.example.iam.service.TokenService.isTokenValid(TokenService.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.iam.service.TokenService$$SpringCGLIB$$0.isTokenValid(<generated>)
	at com.example.iam.security.JwtTokenProvider.validateToken(JwtTokenProvider.java:142)
	at com.example.iam.security.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:33)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:243)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:238)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.NonUniqueResultException: Query did not return a unique result: 2 results were returned
	at org.hibernate.query.spi.AbstractSelectionQuery.uniqueElement(AbstractSelectionQuery.java:298)
	at org.hibernate.query.spi.AbstractSelectionQuery.getSingleResult(AbstractSelectionQuery.java:281)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:419)
	at jdk.proxy2/jdk.proxy2.$Proxy190.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:224)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:93)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:152)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:140)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 70 common frames omitted
2025-05-25 13:32:47.887 ERROR c.e.i.s.JwtAuthenticationFilter - Token validation error
org.springframework.dao.IncorrectResultSizeDataAccessException: Query did not return a unique result: 3 results were returned
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:305)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy162.findByToken(Unknown Source)
	at com.example.iam.service.TokenService.isTokenValid(TokenService.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.iam.service.TokenService$$SpringCGLIB$$0.isTokenValid(<generated>)
	at com.example.iam.security.JwtTokenProvider.validateToken(JwtTokenProvider.java:142)
	at com.example.iam.security.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:33)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:243)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:238)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.NonUniqueResultException: Query did not return a unique result: 3 results were returned
	at org.hibernate.query.spi.AbstractSelectionQuery.uniqueElement(AbstractSelectionQuery.java:298)
	at org.hibernate.query.spi.AbstractSelectionQuery.getSingleResult(AbstractSelectionQuery.java:281)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:419)
	at jdk.proxy2/jdk.proxy2.$Proxy190.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:224)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:93)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:152)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:140)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 70 common frames omitted
2025-05-25 13:32:47.975 INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-05-25 13:32:47.980 INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-05-25 13:32:47.991 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-25 13:32:47.997 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-25 13:33:36.125 INFO  c.e.iam.integration.AuthAndRoleTest - Starting AuthAndRoleTest using Java 21.0.7 with PID 70136 (started by descent in /home/descent/Documents/VDT/vdt5-iam-system/iam-service)
2025-05-25 13:33:36.126 DEBUG c.e.iam.integration.AuthAndRoleTest - Running with Spring Boot v3.4.5, Spring v6.2.6
2025-05-25 13:33:36.127 INFO  c.e.iam.integration.AuthAndRoleTest - The following 1 profile is active: "test-real"
2025-05-25 13:33:37.068 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-05-25 13:33:37.160 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 82 ms. Found 9 JPA repository interfaces.
2025-05-25 13:33:37.979 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 0 (http)
2025-05-25 13:33:37.995 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-25 13:33:37.996 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.40]
2025-05-25 13:33:38.058 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-25 13:33:38.059 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1906 ms
2025-05-25 13:33:38.709 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-25 13:33:39.194 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@7e63374b
2025-05-25 13:33:39.196 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-25 13:33:41.892 DEBUG c.e.i.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-05-25 13:33:41.942 INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name customUserDetailsService
2025-05-25 13:33:42.307 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-05-25 13:33:43.853 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 33583 (http) with context path '/'
2025-05-25 13:33:43.863 INFO  c.e.iam.integration.AuthAndRoleTest - Started AuthAndRoleTest in 8.305 seconds (process running for 9.341)
2025-05-25 13:33:44.603 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-05-25 13:33:44.603 INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-05-25 13:33:44.606 INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 3 ms
2025-05-25 13:33:45.213 ERROR c.e.i.e.GlobalExceptionHandler - Access denied: User does not have required permission: USER_READ
2025-05-25 13:33:45.592 ERROR c.e.i.s.JwtAuthenticationFilter - Token validation error
org.springframework.dao.IncorrectResultSizeDataAccessException: Query did not return a unique result: 2 results were returned
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:305)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy162.findByToken(Unknown Source)
	at com.example.iam.service.TokenService.isTokenValid(TokenService.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.iam.service.TokenService$$SpringCGLIB$$0.isTokenValid(<generated>)
	at com.example.iam.security.JwtTokenProvider.validateToken(JwtTokenProvider.java:142)
	at com.example.iam.security.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:33)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:243)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:238)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.NonUniqueResultException: Query did not return a unique result: 2 results were returned
	at org.hibernate.query.spi.AbstractSelectionQuery.uniqueElement(AbstractSelectionQuery.java:298)
	at org.hibernate.query.spi.AbstractSelectionQuery.getSingleResult(AbstractSelectionQuery.java:281)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:419)
	at jdk.proxy2/jdk.proxy2.$Proxy190.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:224)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:93)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:152)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:140)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 70 common frames omitted
2025-05-25 13:33:45.957 ERROR c.e.i.s.JwtAuthenticationFilter - Token validation error
org.springframework.dao.IncorrectResultSizeDataAccessException: Query did not return a unique result: 3 results were returned
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:305)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy162.findByToken(Unknown Source)
	at com.example.iam.service.TokenService.isTokenValid(TokenService.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.iam.service.TokenService$$SpringCGLIB$$0.isTokenValid(<generated>)
	at com.example.iam.security.JwtTokenProvider.validateToken(JwtTokenProvider.java:142)
	at com.example.iam.security.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:33)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:243)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:238)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.NonUniqueResultException: Query did not return a unique result: 3 results were returned
	at org.hibernate.query.spi.AbstractSelectionQuery.uniqueElement(AbstractSelectionQuery.java:298)
	at org.hibernate.query.spi.AbstractSelectionQuery.getSingleResult(AbstractSelectionQuery.java:281)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:419)
	at jdk.proxy2/jdk.proxy2.$Proxy190.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:224)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:93)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:152)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:140)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 70 common frames omitted
2025-05-25 13:33:46.703 ERROR c.e.i.s.JwtAuthenticationFilter - Token validation error
org.springframework.dao.IncorrectResultSizeDataAccessException: Query did not return a unique result: 2 results were returned
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:305)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy162.findByToken(Unknown Source)
	at com.example.iam.service.TokenService.isTokenValid(TokenService.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.iam.service.TokenService$$SpringCGLIB$$0.isTokenValid(<generated>)
	at com.example.iam.security.JwtTokenProvider.validateToken(JwtTokenProvider.java:142)
	at com.example.iam.security.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:33)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:243)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:238)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.NonUniqueResultException: Query did not return a unique result: 2 results were returned
	at org.hibernate.query.spi.AbstractSelectionQuery.uniqueElement(AbstractSelectionQuery.java:298)
	at org.hibernate.query.spi.AbstractSelectionQuery.getSingleResult(AbstractSelectionQuery.java:281)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:419)
	at jdk.proxy2/jdk.proxy2.$Proxy190.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:224)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:93)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:152)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:140)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 70 common frames omitted
2025-05-25 13:33:47.049 ERROR c.e.i.s.JwtAuthenticationFilter - Token validation error
org.springframework.dao.IncorrectResultSizeDataAccessException: Query did not return a unique result: 3 results were returned
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:305)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy162.findByToken(Unknown Source)
	at com.example.iam.service.TokenService.isTokenValid(TokenService.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.iam.service.TokenService$$SpringCGLIB$$0.isTokenValid(<generated>)
	at com.example.iam.security.JwtTokenProvider.validateToken(JwtTokenProvider.java:142)
	at com.example.iam.security.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:33)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:243)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:238)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.NonUniqueResultException: Query did not return a unique result: 3 results were returned
	at org.hibernate.query.spi.AbstractSelectionQuery.uniqueElement(AbstractSelectionQuery.java:298)
	at org.hibernate.query.spi.AbstractSelectionQuery.getSingleResult(AbstractSelectionQuery.java:281)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:419)
	at jdk.proxy2/jdk.proxy2.$Proxy190.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:224)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:93)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:152)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:140)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 70 common frames omitted
2025-05-25 13:33:47.062 ERROR c.e.i.s.JwtAuthenticationFilter - Token validation error
org.springframework.dao.IncorrectResultSizeDataAccessException: Query did not return a unique result: 3 results were returned
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:305)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy162.findByToken(Unknown Source)
	at com.example.iam.service.TokenService.isTokenValid(TokenService.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.iam.service.TokenService$$SpringCGLIB$$0.isTokenValid(<generated>)
	at com.example.iam.security.JwtTokenProvider.validateToken(JwtTokenProvider.java:142)
	at com.example.iam.security.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:33)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:243)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:238)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.NonUniqueResultException: Query did not return a unique result: 3 results were returned
	at org.hibernate.query.spi.AbstractSelectionQuery.uniqueElement(AbstractSelectionQuery.java:298)
	at org.hibernate.query.spi.AbstractSelectionQuery.getSingleResult(AbstractSelectionQuery.java:281)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:419)
	at jdk.proxy2/jdk.proxy2.$Proxy190.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:224)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:93)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:152)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:140)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 70 common frames omitted
2025-05-25 13:33:47.126 INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-05-25 13:33:47.129 INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-05-25 13:33:47.138 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-25 13:33:47.145 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-25 13:34:12.766 INFO  c.e.iam.integration.AuthAndRoleTest - Starting AuthAndRoleTest using Java 21.0.7 with PID 70768 (started by descent in /home/descent/Documents/VDT/vdt5-iam-system/iam-service)
2025-05-25 13:34:12.767 DEBUG c.e.iam.integration.AuthAndRoleTest - Running with Spring Boot v3.4.5, Spring v6.2.6
2025-05-25 13:34:12.768 INFO  c.e.iam.integration.AuthAndRoleTest - The following 1 profile is active: "test-real"
2025-05-25 13:34:13.812 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-05-25 13:34:13.916 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 89 ms. Found 9 JPA repository interfaces.
2025-05-25 13:34:14.761 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 0 (http)
2025-05-25 13:34:14.774 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-25 13:34:14.775 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.40]
2025-05-25 13:34:14.832 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-25 13:34:14.832 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2038 ms
2025-05-25 13:34:15.338 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-25 13:34:15.670 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@571c2ed8
2025-05-25 13:34:15.671 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-25 13:34:18.071 DEBUG c.e.i.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-05-25 13:34:18.124 INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name customUserDetailsService
2025-05-25 13:34:18.494 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-05-25 13:34:19.714 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 40383 (http) with context path '/'
2025-05-25 13:34:19.726 INFO  c.e.iam.integration.AuthAndRoleTest - Started AuthAndRoleTest in 7.534 seconds (process running for 8.632)
2025-05-25 13:34:20.501 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-05-25 13:34:20.502 INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-05-25 13:34:20.503 INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-05-25 13:34:21.321 ERROR c.e.i.e.GlobalExceptionHandler - Access denied: User does not have required permission: USER_READ
2025-05-25 13:34:21.774 ERROR c.e.i.s.JwtAuthenticationFilter - Token validation error
org.springframework.dao.IncorrectResultSizeDataAccessException: Query did not return a unique result: 2 results were returned
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:305)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy162.findByToken(Unknown Source)
	at com.example.iam.service.TokenService.isTokenValid(TokenService.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.iam.service.TokenService$$SpringCGLIB$$0.isTokenValid(<generated>)
	at com.example.iam.security.JwtTokenProvider.validateToken(JwtTokenProvider.java:142)
	at com.example.iam.security.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:33)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:243)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:238)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.NonUniqueResultException: Query did not return a unique result: 2 results were returned
	at org.hibernate.query.spi.AbstractSelectionQuery.uniqueElement(AbstractSelectionQuery.java:298)
	at org.hibernate.query.spi.AbstractSelectionQuery.getSingleResult(AbstractSelectionQuery.java:281)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:419)
	at jdk.proxy2/jdk.proxy2.$Proxy190.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:224)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:93)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:152)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:140)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 70 common frames omitted
2025-05-25 13:34:22.148 ERROR c.e.i.s.JwtAuthenticationFilter - Token validation error
org.springframework.dao.IncorrectResultSizeDataAccessException: Query did not return a unique result: 2 results were returned
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:305)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy162.findByToken(Unknown Source)
	at com.example.iam.service.TokenService.isTokenValid(TokenService.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.iam.service.TokenService$$SpringCGLIB$$0.isTokenValid(<generated>)
	at com.example.iam.security.JwtTokenProvider.validateToken(JwtTokenProvider.java:142)
	at com.example.iam.security.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:33)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:243)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:238)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.NonUniqueResultException: Query did not return a unique result: 2 results were returned
	at org.hibernate.query.spi.AbstractSelectionQuery.uniqueElement(AbstractSelectionQuery.java:298)
	at org.hibernate.query.spi.AbstractSelectionQuery.getSingleResult(AbstractSelectionQuery.java:281)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:419)
	at jdk.proxy2/jdk.proxy2.$Proxy190.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:224)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:93)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:152)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:140)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 70 common frames omitted
2025-05-25 13:34:22.157 ERROR c.e.i.s.JwtAuthenticationFilter - Token validation error
org.springframework.dao.IncorrectResultSizeDataAccessException: Query did not return a unique result: 2 results were returned
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:305)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy162.findByToken(Unknown Source)
	at com.example.iam.service.TokenService.isTokenValid(TokenService.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.iam.service.TokenService$$SpringCGLIB$$0.isTokenValid(<generated>)
	at com.example.iam.security.JwtTokenProvider.validateToken(JwtTokenProvider.java:142)
	at com.example.iam.security.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:33)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:243)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:238)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.NonUniqueResultException: Query did not return a unique result: 2 results were returned
	at org.hibernate.query.spi.AbstractSelectionQuery.uniqueElement(AbstractSelectionQuery.java:298)
	at org.hibernate.query.spi.AbstractSelectionQuery.getSingleResult(AbstractSelectionQuery.java:281)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:419)
	at jdk.proxy2/jdk.proxy2.$Proxy190.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:224)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:93)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:152)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:140)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 70 common frames omitted
2025-05-25 13:34:22.220 INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-05-25 13:34:22.223 INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-05-25 13:34:22.233 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-25 13:34:22.241 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-25 13:34:37.863 INFO  c.e.iam.integration.AuthAndRoleTest - Starting AuthAndRoleTest using Java 21.0.7 with PID 71262 (started by descent in /home/descent/Documents/VDT/vdt5-iam-system/iam-service)
2025-05-25 13:34:37.865 DEBUG c.e.iam.integration.AuthAndRoleTest - Running with Spring Boot v3.4.5, Spring v6.2.6
2025-05-25 13:34:37.866 INFO  c.e.iam.integration.AuthAndRoleTest - The following 1 profile is active: "test-real"
2025-05-25 13:34:38.780 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-05-25 13:34:38.898 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 110 ms. Found 9 JPA repository interfaces.
2025-05-25 13:34:39.778 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 0 (http)
2025-05-25 13:34:39.792 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-25 13:34:39.792 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.40]
2025-05-25 13:34:39.843 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-25 13:34:39.843 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1957 ms
2025-05-25 13:34:40.359 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-25 13:34:40.702 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@51c6e775
2025-05-25 13:34:40.704 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-25 13:34:43.015 DEBUG c.e.i.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-05-25 13:34:43.077 INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name customUserDetailsService
2025-05-25 13:34:43.430 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-05-25 13:34:44.604 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 41867 (http) with context path '/'
2025-05-25 13:34:44.615 INFO  c.e.iam.integration.AuthAndRoleTest - Started AuthAndRoleTest in 7.351 seconds (process running for 8.501)
2025-05-25 13:34:45.254 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-05-25 13:34:45.255 INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-05-25 13:34:45.256 INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-05-25 13:34:46.024 INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-05-25 13:34:46.027 INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-05-25 13:34:46.038 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-25 13:34:46.062 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-25 13:34:56.951 INFO  c.e.iam.integration.AuthAndRoleTest - Starting AuthAndRoleTest using Java 21.0.7 with PID 71699 (started by descent in /home/descent/Documents/VDT/vdt5-iam-system/iam-service)
2025-05-25 13:34:56.953 DEBUG c.e.iam.integration.AuthAndRoleTest - Running with Spring Boot v3.4.5, Spring v6.2.6
2025-05-25 13:34:56.954 INFO  c.e.iam.integration.AuthAndRoleTest - The following 1 profile is active: "test-real"
2025-05-25 13:34:57.876 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-05-25 13:34:57.958 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 73 ms. Found 9 JPA repository interfaces.
2025-05-25 13:34:58.766 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 0 (http)
2025-05-25 13:34:58.779 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-25 13:34:58.779 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.40]
2025-05-25 13:34:58.836 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-25 13:34:58.836 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1861 ms
2025-05-25 13:34:59.378 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-25 13:34:59.750 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@4b9ed99d
2025-05-25 13:34:59.752 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-25 13:35:02.118 DEBUG c.e.i.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-05-25 13:35:02.169 INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name customUserDetailsService
2025-05-25 13:35:02.524 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-05-25 13:35:03.732 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 33685 (http) with context path '/'
2025-05-25 13:35:03.745 INFO  c.e.iam.integration.AuthAndRoleTest - Started AuthAndRoleTest in 7.348 seconds (process running for 8.551)
2025-05-25 13:35:04.430 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-05-25 13:35:04.431 INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-05-25 13:35:04.433 INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-05-25 13:35:05.120 ERROR c.e.i.e.GlobalExceptionHandler - Access denied: User does not have required permission: USER_READ
2025-05-25 13:35:05.617 INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-05-25 13:35:05.620 INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-05-25 13:35:05.631 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-25 13:35:05.643 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-25 13:35:17.737 INFO  c.e.iam.integration.AuthAndRoleTest - Starting AuthAndRoleTest using Java 21.0.7 with PID 72148 (started by descent in /home/descent/Documents/VDT/vdt5-iam-system/iam-service)
2025-05-25 13:35:17.739 DEBUG c.e.iam.integration.AuthAndRoleTest - Running with Spring Boot v3.4.5, Spring v6.2.6
2025-05-25 13:35:17.739 INFO  c.e.iam.integration.AuthAndRoleTest - The following 1 profile is active: "test-real"
2025-05-25 13:35:18.661 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-05-25 13:35:18.746 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 75 ms. Found 9 JPA repository interfaces.
2025-05-25 13:35:19.561 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 0 (http)
2025-05-25 13:35:19.575 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-25 13:35:19.577 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.40]
2025-05-25 13:35:19.627 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-25 13:35:19.628 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1867 ms
2025-05-25 13:35:20.254 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-25 13:35:20.620 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@3ec62141
2025-05-25 13:35:20.621 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-25 13:35:23.020 DEBUG c.e.i.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-05-25 13:35:23.075 INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name customUserDetailsService
2025-05-25 13:35:23.453 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-05-25 13:35:24.608 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 46549 (http) with context path '/'
2025-05-25 13:35:24.619 INFO  c.e.iam.integration.AuthAndRoleTest - Started AuthAndRoleTest in 7.425 seconds (process running for 8.614)
2025-05-25 13:35:25.242 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-05-25 13:35:25.243 INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-05-25 13:35:25.244 INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-05-25 13:35:25.888 ERROR c.e.i.e.GlobalExceptionHandler - Access denied: User does not have required permission: USER_READ
2025-05-25 13:35:26.642 ERROR c.e.i.s.JwtAuthenticationFilter - Token validation error
org.springframework.dao.IncorrectResultSizeDataAccessException: Query did not return a unique result: 2 results were returned
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:305)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy162.findByToken(Unknown Source)
	at com.example.iam.service.TokenService.isTokenValid(TokenService.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.iam.service.TokenService$$SpringCGLIB$$0.isTokenValid(<generated>)
	at com.example.iam.security.JwtTokenProvider.validateToken(JwtTokenProvider.java:142)
	at com.example.iam.security.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:33)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:243)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:238)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.NonUniqueResultException: Query did not return a unique result: 2 results were returned
	at org.hibernate.query.spi.AbstractSelectionQuery.uniqueElement(AbstractSelectionQuery.java:298)
	at org.hibernate.query.spi.AbstractSelectionQuery.getSingleResult(AbstractSelectionQuery.java:281)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:419)
	at jdk.proxy2/jdk.proxy2.$Proxy190.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:224)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:93)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:152)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:140)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 70 common frames omitted
2025-05-25 13:35:26.653 ERROR c.e.i.s.JwtAuthenticationFilter - Token validation error
org.springframework.dao.IncorrectResultSizeDataAccessException: Query did not return a unique result: 2 results were returned
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:305)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy162.findByToken(Unknown Source)
	at com.example.iam.service.TokenService.isTokenValid(TokenService.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.iam.service.TokenService$$SpringCGLIB$$0.isTokenValid(<generated>)
	at com.example.iam.security.JwtTokenProvider.validateToken(JwtTokenProvider.java:142)
	at com.example.iam.security.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:33)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:243)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:238)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.NonUniqueResultException: Query did not return a unique result: 2 results were returned
	at org.hibernate.query.spi.AbstractSelectionQuery.uniqueElement(AbstractSelectionQuery.java:298)
	at org.hibernate.query.spi.AbstractSelectionQuery.getSingleResult(AbstractSelectionQuery.java:281)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:419)
	at jdk.proxy2/jdk.proxy2.$Proxy190.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:224)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:93)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:152)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:140)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 70 common frames omitted
2025-05-25 13:35:26.723 INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-05-25 13:35:26.726 INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-05-25 13:35:26.736 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-25 13:35:26.746 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-25 13:36:51.324 INFO  c.e.iam.integration.AuthAndRoleTest - Starting AuthAndRoleTest using Java 21.0.7 with PID 73345 (started by descent in /home/descent/Documents/VDT/vdt5-iam-system/iam-service)
2025-05-25 13:36:51.326 DEBUG c.e.iam.integration.AuthAndRoleTest - Running with Spring Boot v3.4.5, Spring v6.2.6
2025-05-25 13:36:51.327 INFO  c.e.iam.integration.AuthAndRoleTest - The following 1 profile is active: "test-real"
2025-05-25 13:36:52.333 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-05-25 13:36:52.430 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 88 ms. Found 9 JPA repository interfaces.
2025-05-25 13:36:53.248 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 0 (http)
2025-05-25 13:36:53.261 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-25 13:36:53.262 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.40]
2025-05-25 13:36:53.307 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-25 13:36:53.307 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1957 ms
2025-05-25 13:36:53.847 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-25 13:36:54.204 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@4c3fcbe7
2025-05-25 13:36:54.205 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-25 13:36:56.587 DEBUG c.e.i.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-05-25 13:36:56.650 INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name customUserDetailsService
2025-05-25 13:36:57.074 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-05-25 13:36:58.208 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 38929 (http) with context path '/'
2025-05-25 13:36:58.218 INFO  c.e.iam.integration.AuthAndRoleTest - Started AuthAndRoleTest in 7.513 seconds (process running for 8.616)
2025-05-25 13:36:59.006 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-05-25 13:36:59.006 INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-05-25 13:36:59.008 INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-05-25 13:36:59.592 ERROR c.e.i.e.GlobalExceptionHandler - Access denied: User does not have required permission: USER_READ
2025-05-25 13:36:59.961 ERROR c.e.i.s.JwtAuthenticationFilter - Token validation error
org.springframework.dao.IncorrectResultSizeDataAccessException: Query did not return a unique result: 2 results were returned
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:305)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy162.findByToken(Unknown Source)
	at com.example.iam.service.TokenService.isTokenValid(TokenService.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.iam.service.TokenService$$SpringCGLIB$$0.isTokenValid(<generated>)
	at com.example.iam.security.JwtTokenProvider.validateToken(JwtTokenProvider.java:142)
	at com.example.iam.security.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:33)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:243)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:238)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.NonUniqueResultException: Query did not return a unique result: 2 results were returned
	at org.hibernate.query.spi.AbstractSelectionQuery.uniqueElement(AbstractSelectionQuery.java:298)
	at org.hibernate.query.spi.AbstractSelectionQuery.getSingleResult(AbstractSelectionQuery.java:281)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:419)
	at jdk.proxy2/jdk.proxy2.$Proxy190.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:224)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:93)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:152)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:140)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 70 common frames omitted
2025-05-25 13:37:00.414 INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-05-25 13:37:00.421 INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-05-25 13:37:00.440 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-25 13:37:00.450 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-25 13:37:34.811 INFO  c.e.iam.integration.AuthAndRoleTest - Starting AuthAndRoleTest using Java 21.0.7 with PID 74109 (started by descent in /home/descent/Documents/VDT/vdt5-iam-system/iam-service)
2025-05-25 13:37:34.812 DEBUG c.e.iam.integration.AuthAndRoleTest - Running with Spring Boot v3.4.5, Spring v6.2.6
2025-05-25 13:37:34.813 INFO  c.e.iam.integration.AuthAndRoleTest - The following 1 profile is active: "test-real"
2025-05-25 13:37:35.687 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-05-25 13:37:35.793 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 86 ms. Found 9 JPA repository interfaces.
2025-05-25 13:37:36.629 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 0 (http)
2025-05-25 13:37:36.642 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-25 13:37:36.643 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.40]
2025-05-25 13:37:36.709 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-25 13:37:36.710 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1872 ms
2025-05-25 13:37:37.220 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-25 13:37:37.568 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@11174bf
2025-05-25 13:37:37.569 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-25 13:37:39.902 DEBUG c.e.i.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-05-25 13:37:39.958 INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name customUserDetailsService
2025-05-25 13:37:40.306 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-05-25 13:37:41.433 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 33775 (http) with context path '/'
2025-05-25 13:37:41.450 INFO  c.e.iam.integration.AuthAndRoleTest - Started AuthAndRoleTest in 7.179 seconds (process running for 8.201)
2025-05-25 13:37:42.286 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-05-25 13:37:42.286 INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-05-25 13:37:42.288 INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-05-25 13:37:42.884 ERROR c.e.i.e.GlobalExceptionHandler - Access denied: User does not have required permission: USER_READ
2025-05-25 13:37:43.338 INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-05-25 13:37:43.341 INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-05-25 13:37:43.352 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-25 13:37:43.363 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-25 13:39:17.112 INFO  c.e.iam.integration.AuthAndRoleTest - Starting AuthAndRoleTest using Java 21.0.7 with PID 75415 (started by descent in /home/descent/Documents/VDT/vdt5-iam-system/iam-service)
2025-05-25 13:39:17.114 DEBUG c.e.iam.integration.AuthAndRoleTest - Running with Spring Boot v3.4.5, Spring v6.2.6
2025-05-25 13:39:17.115 INFO  c.e.iam.integration.AuthAndRoleTest - The following 1 profile is active: "test-real"
2025-05-25 13:39:18.072 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-05-25 13:39:18.171 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 87 ms. Found 9 JPA repository interfaces.
2025-05-25 13:39:19.000 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 0 (http)
2025-05-25 13:39:19.013 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-25 13:39:19.014 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.40]
2025-05-25 13:39:19.068 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-25 13:39:19.068 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1928 ms
2025-05-25 13:39:19.583 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-25 13:39:19.933 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@4f0c1409
2025-05-25 13:39:19.935 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-25 13:39:22.382 DEBUG c.e.i.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-05-25 13:39:22.444 INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name customUserDetailsService
2025-05-25 13:39:22.807 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-05-25 13:39:23.909 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 38353 (http) with context path '/'
2025-05-25 13:39:23.921 INFO  c.e.iam.integration.AuthAndRoleTest - Started AuthAndRoleTest in 7.472 seconds (process running for 8.659)
2025-05-25 13:39:24.589 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-05-25 13:39:24.589 INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-05-25 13:39:24.590 INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-05-25 13:39:25.202 ERROR c.e.i.e.GlobalExceptionHandler - Access denied: User does not have required permission: USER_READ
2025-05-25 13:39:25.572 ERROR c.e.i.s.JwtAuthenticationFilter - Token validation error
org.springframework.dao.IncorrectResultSizeDataAccessException: Query did not return a unique result: 2 results were returned
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:305)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy162.findByToken(Unknown Source)
	at com.example.iam.service.TokenService.isTokenValid(TokenService.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.iam.service.TokenService$$SpringCGLIB$$0.isTokenValid(<generated>)
	at com.example.iam.security.JwtTokenProvider.validateToken(JwtTokenProvider.java:142)
	at com.example.iam.security.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:33)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:243)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:238)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.NonUniqueResultException: Query did not return a unique result: 2 results were returned
	at org.hibernate.query.spi.AbstractSelectionQuery.uniqueElement(AbstractSelectionQuery.java:298)
	at org.hibernate.query.spi.AbstractSelectionQuery.getSingleResult(AbstractSelectionQuery.java:281)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:419)
	at jdk.proxy2/jdk.proxy2.$Proxy190.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:224)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:93)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:152)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:140)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 70 common frames omitted
2025-05-25 13:39:25.902 ERROR c.e.i.s.JwtAuthenticationFilter - Token validation error
org.springframework.dao.IncorrectResultSizeDataAccessException: Query did not return a unique result: 2 results were returned
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:305)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy162.findByToken(Unknown Source)
	at com.example.iam.service.TokenService.isTokenValid(TokenService.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.iam.service.TokenService$$SpringCGLIB$$0.isTokenValid(<generated>)
	at com.example.iam.security.JwtTokenProvider.validateToken(JwtTokenProvider.java:142)
	at com.example.iam.security.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:33)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:243)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:238)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.NonUniqueResultException: Query did not return a unique result: 2 results were returned
	at org.hibernate.query.spi.AbstractSelectionQuery.uniqueElement(AbstractSelectionQuery.java:298)
	at org.hibernate.query.spi.AbstractSelectionQuery.getSingleResult(AbstractSelectionQuery.java:281)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:419)
	at jdk.proxy2/jdk.proxy2.$Proxy190.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:224)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:93)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:152)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:140)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 70 common frames omitted
2025-05-25 13:39:25.967 INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-05-25 13:39:25.969 INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-05-25 13:39:25.979 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-25 13:39:25.988 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-05-25 13:40:10.886 INFO  c.e.iam.integration.AuthAndRoleTest - Starting AuthAndRoleTest using Java 21.0.7 with PID 76211 (started by descent in /home/descent/Documents/VDT/vdt5-iam-system/iam-service)
2025-05-25 13:40:10.889 DEBUG c.e.iam.integration.AuthAndRoleTest - Running with Spring Boot v3.4.5, Spring v6.2.6
2025-05-25 13:40:10.890 INFO  c.e.iam.integration.AuthAndRoleTest - The following 1 profile is active: "test-real"
2025-05-25 13:40:11.828 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-05-25 13:40:11.941 INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 95 ms. Found 9 JPA repository interfaces.
2025-05-25 13:40:12.837 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 0 (http)
2025-05-25 13:40:12.851 INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-05-25 13:40:12.851 INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.40]
2025-05-25 13:40:12.903 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-05-25 13:40:12.904 INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1994 ms
2025-05-25 13:40:13.419 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-05-25 13:40:13.776 INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@3ec62141
2025-05-25 13:40:13.777 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-05-25 13:40:16.046 DEBUG c.e.i.s.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-05-25 13:40:16.127 INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name customUserDetailsService
2025-05-25 13:40:16.494 WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-05-25 13:40:17.613 INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 35499 (http) with context path '/'
2025-05-25 13:40:17.623 INFO  c.e.iam.integration.AuthAndRoleTest - Started AuthAndRoleTest in 7.338 seconds (process running for 8.367)
2025-05-25 13:40:18.219 INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-05-25 13:40:18.219 INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-05-25 13:40:18.220 INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-05-25 13:40:18.883 ERROR c.e.i.e.GlobalExceptionHandler - Access denied: User does not have required permission: USER_READ
2025-05-25 13:40:19.600 ERROR c.e.i.s.JwtAuthenticationFilter - Token validation error
org.springframework.dao.IncorrectResultSizeDataAccessException: Query did not return a unique result: 2 results were returned
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:305)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:244)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:560)
	at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:61)
	at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:343)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:160)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:136)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223)
	at jdk.proxy2/jdk.proxy2.$Proxy162.findByToken(Unknown Source)
	at com.example.iam.service.TokenService.isTokenValid(TokenService.java:64)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.example.iam.service.TokenService$$SpringCGLIB$$0.isTokenValid(<generated>)
	at com.example.iam.security.JwtTokenProvider.validateToken(JwtTokenProvider.java:142)
	at com.example.iam.security.JwtAuthenticationFilter.doFilterInternal(JwtAuthenticationFilter.java:33)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:374)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:243)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:238)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:362)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:278)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.hibernate.NonUniqueResultException: Query did not return a unique result: 2 results were returned
	at org.hibernate.query.spi.AbstractSelectionQuery.uniqueElement(AbstractSelectionQuery.java:298)
	at org.hibernate.query.spi.AbstractSelectionQuery.getSingleResult(AbstractSelectionQuery.java:281)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:419)
	at jdk.proxy2/jdk.proxy2.$Proxy190.getSingleResult(Unknown Source)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution$SingleEntityExecution.doExecute(JpaQueryExecution.java:224)
	at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:93)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:152)
	at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:140)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170)
	at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170)
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:380)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138)
	... 70 common frames omitted
2025-05-25 13:40:19.678 INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-05-25 13:40:19.681 INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-05-25 13:40:19.689 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-05-25 13:40:19.700 INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
